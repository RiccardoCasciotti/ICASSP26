BLOCKS:  {'b0': {'arch': 'CNN', 'preset': 'softkrotov-c48-k5-p2-s1-d1-b0-t1.1-lr0.08', 'operation': 'batchnorm2d', 'num': 0, 'batch_norm': False, 'pool': {'type': 'max', 'kernel_size': 4, 'stride': 2, 'padding': 1}, 'activation': {'function': 'triangle', 'param': 0.7}, 'resume': None, 'layer': {'arch': 'CNN', 'nb_train': None, 'lr': 0.08, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 1.1, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 2, 'weight_init': 'positive', 'weight_init_range': 2, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.75, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 48, 'kernel_size': 5}}, 'b1': {'arch': 'CNN', 'preset': 'softkrotov-c192-k3-p1-s1-d1-b0-t0.7-lr0.01', 'operation': 'batchnorm2d', 'num': 1, 'batch_norm': False, 'pool': {'type': 'max', 'kernel_size': 4, 'stride': 2, 'padding': 1}, 'activation': {'function': 'triangle', 'param': 0.7}, 'resume': None, 'layer': {'arch': 'CNN', 'nb_train': None, 'lr': 0.01, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 0.7, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 1, 'weight_init': 'positive', 'weight_init_range': 2, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.75, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 192, 'kernel_size': 3}}, 'b2': {'arch': 'CNN', 'preset': 'softkrotov-c768-k3-p1-s1-d1-b0-t0.5-lr0.01', 'operation': 'batchnorm2d', 'num': 2, 'batch_norm': False, 'pool': {'type': 'max', 'kernel_size': 4, 'stride': 2, 'padding': 1}, 'activation': {'function': 'triangle', 'param': 0.7}, 'resume': None, 'layer': {'arch': 'CNN', 'nb_train': None, 'lr': 0.01, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 0.5, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 1, 'weight_init': 'positive', 'weight_init_range': 2, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.75, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 768, 'kernel_size': 3}}, 'b3': {'arch': 'CNN', 'preset': 'softkrotov-c3072-k3-p1-s1-d1-b0-t0.4-lr0.01', 'operation': 'batchnorm2d', 'num': 3, 'batch_norm': False, 'pool': {'type': 'max', 'kernel_size': 4, 'stride': 2, 'padding': 1}, 'activation': {'function': 'triangle', 'param': 1.4}, 'resume': None, 'layer': {'arch': 'CNN', 'nb_train': None, 'lr': 0.01, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 0.4, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 1, 'weight_init': 'positive', 'weight_init_range': 2, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.75, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 3072, 'kernel_size': 3}}, 'b4': {'arch': 'CNN', 'preset': 'softkrotov-c12288-k3-p1-s1-d1-b0-t0.25-lr0.01', 'operation': 'batchnorm2d', 'num': 4, 'batch_norm': False, 'pool': {'type': 'avg', 'kernel_size': 2, 'stride': 2, 'padding': 0}, 'activation': {'function': 'triangle', 'param': 1.0}, 'resume': None, 'layer': {'arch': 'CNN', 'nb_train': None, 'lr': 0.01, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 0.25, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 1, 'weight_init': 'positive', 'weight_init_range': 2, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.75, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 12288, 'kernel_size': 3}}, 'b5': {'arch': 'MLP', 'preset': 'BP-c1000', 'operation': 'flatten', 'num': 5, 'att_dropout': None, 'dropout': 0.5, 'layer': {'arch': 'MLP', 'lr': 0.05, 'adaptive': True, 'lr_sup': 0.001, 'speed': 0.4, 'lr_div': 100, 'lebesgue_p': 2, 't_invert': 10, 'beta': 0.01, 'power': 4.5, 'ranking_param': 3, 'delta': 0.1, 'hebbian': False, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'lr_bias': 600, 'softness': 'soft', 'soft_activation_fn': 'exp', 'plasticity': 'SoftHebb', 'metric_mode': 'unsupervised', 'weight_init': 'positive', 'weight_init_range': 0.25, 'weight_init_offset': 0, 'weight_decay': 0, 'radius': 10, 'power_lr': 0.2, 'out_channels': 1000}, 'pool': None, 'activation': None}}
CL:  True
{'name': 'ImageNette', 'noise_std': 0, 'channels': 3, 'width': 160, 'height': 160, 'validation_split': 0.2, 'training_sample': 9469, 'testing_sample': 10000, 'out_channels': 10, 'num_workers': 0, 'seed': 0, 'shuffle': True, 'batch_size': 32, 'augmentation': True, 'zca_whitened': False, 'training_class': 'all', 'split': 'train', 'px': 160, 'nb_epoch': 200, 'print_freq': 50, 'validation': False, 'continual_learning': True}
CL:  False
{'name': 'ImageNette', 'noise_std': 0, 'channels': 3, 'width': 160, 'height': 160, 'validation_split': 0.2, 'training_sample': 9469, 'testing_sample': 10000, 'out_channels': 10, 'num_workers': 0, 'seed': 0, 'shuffle': True, 'batch_size': 32, 'augmentation': True, 'zca_whitened': False, 'training_class': 'all', 'split': 'train', 'px': 160, 'nb_epoch': 200, 'print_freq': 50, 'validation': False, 'continual_learning': False}
CL:  False
{'name': 'ImageNette', 'noise_std': 0, 'channels': 3, 'width': 160, 'height': 160, 'validation_split': 0.2, 'training_sample': 9469, 'testing_sample': 10000, 'out_channels': 10, 'num_workers': 0, 'seed': 0, 'shuffle': True, 'batch_size': 10, 'augmentation': False, 'zca_whitened': False, 'training_class': 'all', 'split': 'train', 'px': 160, 'nb_epoch': 1, 'print_freq': 10, 'validation': False, 'continual_learning': False}
SEED:  0
block 0, size : 48 80 80
range = 2.886751345948129
block 1, size : 192 40 40
range = 1.2028130608117202
block 2, size : 768 20 20
range = 0.6014065304058601
block 3, size : 3072 10 10
range = 0.30070326520293006
block 4, size : 12288 5 5
range = 0.15035163260146503
range = 0.03125
The device used will be: 
True
cuda:0

 Model ImageNette_STL10_CL not found
CONFIG: {'arch': 'CNN', 'nb_train': None, 'lr': 0.08, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 1.1, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 2, 'weight_init': 'normal', 'weight_init_range': 2.886751345948129, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.75, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 48, 'kernel_size': 5, 'in_channels': 3, 'lr_scheduler': {'lr': 0.08, 'adaptive': True, 'nb_epochs': 1, 'ratio': 0.0010560777273207309, 'speed': 7, 'div': 96, 'decay': 'linear', 'power_lr': 0.75}}
CONFIG: {'arch': 'CNN', 'nb_train': None, 'lr': 0.01, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 0.7, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 1, 'weight_init': 'normal', 'weight_init_range': 1.2028130608117202, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.75, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 192, 'kernel_size': 3, 'in_channels': 48, 'lr_scheduler': {'lr': 0.01, 'adaptive': True, 'nb_epochs': 1, 'ratio': 0.0010560777273207309, 'speed': 7, 'div': 96, 'decay': 'linear', 'power_lr': 0.75}}
CONFIG: {'arch': 'CNN', 'nb_train': None, 'lr': 0.01, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 0.5, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 1, 'weight_init': 'normal', 'weight_init_range': 0.6014065304058601, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.75, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 768, 'kernel_size': 3, 'in_channels': 192, 'lr_scheduler': {'lr': 0.01, 'adaptive': True, 'nb_epochs': 1, 'ratio': 0.0010560777273207309, 'speed': 7, 'div': 96, 'decay': 'linear', 'power_lr': 0.75}}
CONFIG: {'arch': 'CNN', 'nb_train': None, 'lr': 0.01, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 0.4, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 1, 'weight_init': 'normal', 'weight_init_range': 0.30070326520293006, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.75, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 3072, 'kernel_size': 3, 'in_channels': 768, 'lr_scheduler': {'lr': 0.01, 'adaptive': True, 'nb_epochs': 1, 'ratio': 0.0010560777273207309, 'speed': 7, 'div': 96, 'decay': 'linear', 'power_lr': 0.75}}
CONFIG: {'arch': 'CNN', 'nb_train': None, 'lr': 0.01, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 0.25, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 1, 'weight_init': 'normal', 'weight_init_range': 0.15035163260146503, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.75, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 12288, 'kernel_size': 3, 'in_channels': 3072, 'lr_scheduler': {'lr': 0.01, 'adaptive': True, 'nb_epochs': 1, 'ratio': 0.0010560777273207309, 'speed': 7, 'div': 96, 'decay': 'linear', 'power_lr': 0.75}}
CONFIG: {'arch': 'MLP', 'lr': 0.05, 'adaptive': True, 'lr_sup': 0.001, 'speed': 0.4, 'lr_div': 100, 'lebesgue_p': 2, 't_invert': 10, 'beta': 0.01, 'power': 4.5, 'ranking_param': 3, 'delta': 0.1, 'hebbian': False, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'lr_bias': 600, 'softness': 'soft', 'soft_activation_fn': 'exp', 'plasticity': 'SoftHebb', 'metric_mode': 'unsupervised', 'weight_init': 'positive', 'weight_init_range': 0.03125, 'weight_init_offset': 0, 'weight_decay': 0, 'radius': 10, 'power_lr': 0.2, 'out_channels': 10, 'in_channels': 307200, 'old_channels': 12288, 'lr_scheduler': {'decay': 'cste', 'lr': 0.1}}



 ----- Architecture Block BatchNorm2dSK3482(5, 5)1.100000023841858reflect, number 0 -----
- BatchNorm2d(3, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
- HebbSoftKrotovConv2d(3, 48, lebesgue_p=2, pruning=0, kernel_size=(5, 5), bias=False, padding_mode=reflect, t_invert=1.100000023841858, bias=False, lr_bias=0.0909, ranking_param=3, delta=2, activation=exp)
- Triangle(power=0.7)
- MaxPool2d(kernel_size=4, stride=2, padding=1, dilation=1, ceil_mode=False)

 ----- Architecture Block BatchNorm2dSK481922(3, 3)0.699999988079071reflect, number 1 -----
- BatchNorm2d(48, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
- HebbSoftKrotovConv2d(48, 192, lebesgue_p=2, pruning=0, kernel_size=(3, 3), bias=False, padding_mode=reflect, t_invert=0.699999988079071, bias=False, lr_bias=0.1429, ranking_param=3, delta=2, activation=exp)
- Triangle(power=0.7)
- MaxPool2d(kernel_size=4, stride=2, padding=1, dilation=1, ceil_mode=False)

 ----- Architecture Block BatchNorm2dSK1927682(3, 3)0.5reflect, number 2 -----
- BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
- HebbSoftKrotovConv2d(192, 768, lebesgue_p=2, pruning=0, kernel_size=(3, 3), bias=False, padding_mode=reflect, t_invert=0.5, bias=False, lr_bias=0.2, ranking_param=3, delta=2, activation=exp)
- Triangle(power=0.7)
- MaxPool2d(kernel_size=4, stride=2, padding=1, dilation=1, ceil_mode=False)

 ----- Architecture Block BatchNorm2dSK76830722(3, 3)0.4000000059604645reflect, number 3 -----
- BatchNorm2d(768, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
- HebbSoftKrotovConv2d(768, 3072, lebesgue_p=2, pruning=0, kernel_size=(3, 3), bias=False, padding_mode=reflect, t_invert=0.4000000059604645, bias=False, lr_bias=0.25, ranking_param=3, delta=2, activation=exp)
- Triangle(power=1.4)
- MaxPool2d(kernel_size=4, stride=2, padding=1, dilation=1, ceil_mode=False)

 ----- Architecture Block BatchNorm2dSK3072122882(3, 3)0.25reflect, number 4 -----
- BatchNorm2d(3072, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
- HebbSoftKrotovConv2d(3072, 12288, lebesgue_p=2, pruning=0, kernel_size=(3, 3), bias=False, padding_mode=reflect, t_invert=0.25, bias=False, lr_bias=0.4, ranking_param=3, delta=2, activation=exp)
- Triangle(power=1.0)
- AvgPool2d(kernel_size=2, stride=2, padding=0)

 ----- Architecture Block FlattenDropout(p=0.5, inplace=False)Linear(in_, number 5 -----
- Flatten(start_dim=1, end_dim=-1)
- Dropout(p=0.5, inplace=False)
- Linear(in_features=307200, out_features=10, bias=True)

 ********** Hebbian Unsupervised learning of blocks [0] **********
SEED:  0
BEFORE RESIZING
AFTER RESIZING
INDICES:  9469
IMAGE SIZE: torch.Size([10, 3, 160, 160])
SAVING FOLDER FOR UNSUP:  ImageNette_STL10_CL
INSIDE EVALUATE UNSUP
INSIDE EVALUATE UNSUP RETURNED 0,0
Epoch: [1/1]	lr: 1.10e-01	time: 00:01:51	Acc_train 0.00	Acc_test 0.00	convergence: 2.40e+01	R1: 0	Info MB:0.000e+00/SB:0.000e+00/MW:6.398e-03/SW:3.358e-01/MR:2.684e+00/SR:1.132e+00/MeD:9.586e-01/MaD:2.501e+00/MW:0.726/MAW:0.274
|       0 |      1 |       2 |       3 |          4 |        5 |       6 |       7 |         8 |      9 |        10 |      11 |      12 |      13 |      14 |      15 |         16 |      17 |      18 |         19 |      20 |      21 |       22 |      23 |      24 |         25 |      26 |       27 |        28 |      29 |
|---------+--------+---------+---------+------------+----------+---------+---------+-----------+--------+-----------+---------+---------+---------+---------+---------+------------+---------+---------+------------+---------+---------+----------+---------+---------+------------+---------+----------+-----------+---------|
|   0.094 |   0.12 |   0.162 |   0.146 |   0.000375 |   0.0684 |   0.101 |   0.189 |   0.00075 |   0.15 |   0.00036 |   0.157 |   0.137 |   0.161 |   0.134 |   0.189 |   2.53e-09 |   0.156 |   0.169 |   0.000447 |   0.159 |   0.159 |   0.0763 |   0.234 |   0.142 |   2.53e-09 |   0.165 |   0.0189 |   0.00081 |   0.165 |
|   2.24  |   2.72 |   3.55  |   3.23  |   1        |   1.81   |   2.37  |   4.15  |   1       |   3.32 |   1       |   3.45  |   3.04  |   3.54  |   2.99  |   4.14  |   1        |   3.43  |   3.71  |   1        |   3.5   |   3.5   |   1.94   |   5.18  |   3.15  |   1        |   3.63  |   1.15   |   1       |   3.62  |
|   0.66  |   0.58 |   0.52  |   0.58  |   3.12     |   1.53   |   0.83  |   0.68  |   1.5     |   0.55 |   3.21    |   0.67  |   0.7   |   0.54  |   1.2   |   0.6   |  22.53     |   0.64  |   0.73  |   3.05     |   0.73  |   0.97  |   0.66   |   0.62  |   0.61  |  29.07     |   0.67  |   0.98   |   1.05    |   0.56  |
| nan     | nan    | nan     | nan     | nan        | nan      | nan     | nan     | nan       | nan    | nan       | nan     | nan     | nan     | nan     | nan     | nan        | nan     | nan     | nan        | nan     | nan     | nan      | nan     | nan     | nan        | nan     | nan      | nan       | nan     |
| nan     | nan    | nan     | nan     | nan        | nan      | nan     | nan     | nan       | nan    | nan       | nan     | nan     | nan     | nan     | nan     | nan        | nan     | nan     | nan        | nan     | nan     | nan      | nan     | nan     | nan        | nan     | nan      | nan       | nan     |
| nan     | nan    | nan     | nan     | nan        | nan      | nan     | nan     | nan       | nan    | nan       | nan     | nan     | nan     | nan     | nan     | nan        | nan     | nan     | nan        | nan     | nan     | nan      | nan     | nan     | nan        | nan     | nan      | nan       | nan     |

STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/ImageNette_STL10_CL/models

 ********** Hebbian Unsupervised learning of blocks [1] **********
SEED:  0
BEFORE RESIZING
AFTER RESIZING
INDICES:  9469
IMAGE SIZE: torch.Size([10, 3, 160, 160])
SAVING FOLDER FOR UNSUP:  ImageNette_STL10_CL
INSIDE EVALUATE UNSUP
INSIDE EVALUATE UNSUP RETURNED 0,0
Epoch: [1/1]	lr: 1.10e-01	time: 00:03:37	Acc_train 0.00	Acc_test 0.00	convergence: 2.40e+01	R1: 0	Info MB:0.000e+00/SB:0.000e+00/MW:1.165e-02/SW:2.139e-01/MR:4.201e+00/SR:1.477e+00/MeD:1.165e+00/MaD:3.681e+00/MW:0.624/MAW:0.376
|       0 |        1 |        2 |        3 |        4 |        5 |       6 |        7 |      8 |        9 |       10 |      11 |       12 |       13 |       14 |        15 |       16 |         17 |       18 |     19 |       20 |       21 |       22 |       23 |       24 |       25 |       26 |       27 |       28 |        29 |
|---------+----------+----------+----------+----------+----------+---------+----------+--------+----------+----------+---------+----------+----------+----------+-----------+----------+------------+----------+--------+----------+----------+----------+----------+----------+----------+----------+----------+----------+-----------|
|   0.025 |   0.0191 |   0.0333 |   0.0267 |   0.0163 |   0.0234 |   0.033 |   0.0243 |   0.02 |   0.0281 |   0.0304 |   0.017 |   0.0287 |   0.0311 |   0.0206 |   0.00727 |   0.0207 |   5.06e-05 |   0.0267 |   0.02 |   0.0196 |   0.0262 |   0.0165 |   0.0235 |   0.0313 |   0.0214 |   0.0366 |   0.0187 |   0.0321 |   0.00839 |
|   4.39  |   3.36   |   5.97   |   4.7    |   2.92   |   4.11   |   5.91  |   4.26   |   3.52 |   4.96   |   5.4    |   3.03  |   5.08   |   5.55   |   3.61   |   1.65    |   3.63   |   1        |   4.7    |   3.52 |   3.45   |   4.62   |   2.95   |   4.13   |   5.58   |   3.76   |   6.64   |   3.3    |   5.74   |   1.79    |
|   0.51  |   0.34   |   0.26   |   1.45   |   0.37   |   0.5    |   0.3   |   0.44   |   0.27 |   0.29   |   0.64   |   0.35  |   0.36   |   0.43   |   0.28   |   0.39    |   0.38   |   9.55     |   0.28   |   0.28 |   0.32   |   0.19   |   0.33   |   0.33   |   0.23   |   0.26   |   0.58   |   0.23   |   0.19   |   0.32    |
| nan     | nan      | nan      | nan      | nan      | nan      | nan     | nan      | nan    | nan      | nan      | nan     | nan      | nan      | nan      | nan       | nan      | nan        | nan      | nan    | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan       |
| nan     | nan      | nan      | nan      | nan      | nan      | nan     | nan      | nan    | nan      | nan      | nan     | nan      | nan      | nan      | nan       | nan      | nan        | nan      | nan    | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan       |
| nan     | nan      | nan      | nan      | nan      | nan      | nan     | nan      | nan    | nan      | nan      | nan     | nan      | nan      | nan      | nan       | nan      | nan        | nan      | nan    | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan       |

STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/ImageNette_STL10_CL/models

 ********** Hebbian Unsupervised learning of blocks [2] **********
SEED:  0
BEFORE RESIZING
AFTER RESIZING
INDICES:  9469
IMAGE SIZE: torch.Size([10, 3, 160, 160])
SAVING FOLDER FOR UNSUP:  ImageNette_STL10_CL
INSIDE EVALUATE UNSUP
INSIDE EVALUATE UNSUP RETURNED 0,0
Epoch: [1/1]	lr: 1.08e-01	time: 00:05:16	Acc_train 0.00	Acc_test 0.00	convergence: 2.40e+01	R1: 0	Info MB:0.000e+00/SB:0.000e+00/MW:4.660e-03/SW:1.874e-01/MR:7.446e+00/SR:2.299e+00/MeD:1.786e+00/MaD:6.445e+00/MW:0.563/MAW:0.437
|        0 |        1 |        2 |       3 |        4 |        5 |       6 |        7 |        8 |        9 |       10 |       11 |       12 |       13 |       14 |       15 |       16 |       17 |      18 |       19 |       20 |     21 |       22 |       23 |       24 |       25 |       26 |       27 |       28 |       29 |
|----------+----------+----------+---------+----------+----------+---------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+---------+----------+----------+--------+----------+----------+----------+----------+----------+----------+----------+----------|
|   0.0485 |   0.0286 |   0.0531 |   0.028 |   0.0337 |   0.0464 |   0.012 |   0.0444 |   0.0425 |   0.0541 |   0.0423 |   0.0238 |   0.0401 |   0.0365 |   0.0559 |   0.0387 |   0.0601 |   0.0362 |   0.044 |   0.0393 |   0.0516 |   0.02 |   0.0468 |   0.0331 |   0.0301 |   0.0583 |   0.0406 |   0.0283 |   0.0273 |   0.0422 |
|   9.21   |   5.06   |  10.26   |   4.94  |   6.05   |   8.74   |   2.28  |   8.3    |   7.89   |  10.5    |   7.85   |   4.18   |   7.38   |   6.61   |  10.91   |   7.08   |  11.93   |   6.55   |   8.2   |   7.2    |   9.91   |   3.52 |   8.84   |   5.93   |   5.35   |  11.5    |   7.47   |   5      |   4.82   |   7.82   |
|   0.08   |   0.19   |   0.08   |   0.11  |   0.11   |   0.11   |   0.11  |   0.11   |   0.14   |   0.07   |   0.09   |   0.05   |   0.1    |   0.11   |   0.1    |   0.1    |   0.05   |   0.1    |   0.08  |   0.1    |   0.14   |   0.1  |   0.1    |   0.11   |   0.22   |   0.08   |   0.22   |   0.08   |   0.07   |   0.1    |
| nan      | nan      | nan      | nan     | nan      | nan      | nan     | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan     | nan      | nan      | nan    | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      |
| nan      | nan      | nan      | nan     | nan      | nan      | nan     | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan     | nan      | nan      | nan    | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      |
| nan      | nan      | nan      | nan     | nan      | nan      | nan     | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan     | nan      | nan      | nan    | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      |

STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/ImageNette_STL10_CL/models

 ********** Hebbian Unsupervised learning of blocks [3] **********
SEED:  0
BEFORE RESIZING
AFTER RESIZING
INDICES:  9469
IMAGE SIZE: torch.Size([10, 3, 160, 160])
SAVING FOLDER FOR UNSUP:  ImageNette_STL10_CL
INSIDE EVALUATE UNSUP
INSIDE EVALUATE UNSUP RETURNED 0,0
Epoch: [1/1]	lr: 5.67e-02	time: 00:07:08	Acc_train 0.00	Acc_test 0.00	convergence: 2.40e+01	R1: 0	Info MB:0.000e+00/SB:0.000e+00/MW:1.034e-03/SW:1.432e-01/MR:1.133e+01/SR:3.652e+00/MeD:2.806e+00/MaD:1.033e+01/MW:0.587/MAW:0.413
|      0 |        1 |        2 |        3 |        4 |        5 |        6 |        7 |        8 |        9 |       10 |       11 |       12 |      13 |       14 |       15 |       16 |       17 |       18 |       19 |       20 |      21 |       22 |       23 |       24 |      25 |       26 |       27 |       28 |       29 |
|--------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+---------+----------+----------+----------+----------+----------+----------+----------+---------+----------+----------+----------+---------+----------+----------+----------+----------|
|   0.04 |   0.0863 |   0.0545 |   0.0642 |   0.0167 |   0.0546 |   0.0673 |   0.0504 |   0.0179 |   0.0677 |   0.0672 |   0.0575 |   0.0512 |   0.036 |   0.0678 |   0.0721 |   0.0672 |   0.0665 |   0.0617 |   0.0578 |   0.0511 |   0.061 |   0.0654 |   0.0773 |   0.0705 |   0.054 |   0.0803 |   0.0565 |   0.0485 |   0.0543 |
|   7.36 |  18.71   |  10.58   |  12.94   |   2.98   |  10.62   |  13.72   |   9.64   |   3.17   |  13.81   |  13.68   |  11.3    |   9.83   |   6.53  |  13.83   |  14.92   |  13.68   |  13.51   |  12.31   |  11.38   |   9.8    |  12.14  |  13.23   |  16.28   |  14.53   |  10.46  |  17.07   |  11.05   |   9.2    |  10.54   |
|   0.04 |   0.01   |   0.03   |   0.03   |   0.05   |   0.02   |   0.02   |   0.04   |   0.03   |   0.03   |   0.02   |   0.02   |   0.02   |   0.04  |   0.03   |   0.03   |   0.03   |   0.03   |   0.02   |   0.02   |   0.03   |   0.01  |   0.02   |   0.02   |   0.01   |   0.03  |   0.03   |   0.02   |   0.02   |   0.03   |
| nan    | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan     | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan     | nan      | nan      | nan      | nan     | nan      | nan      | nan      | nan      |
| nan    | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan     | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan     | nan      | nan      | nan      | nan     | nan      | nan      | nan      | nan      |
| nan    | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan     | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan     | nan      | nan      | nan      | nan     | nan      | nan      | nan      | nan      |

STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/ImageNette_STL10_CL/models

 ********** Hebbian Unsupervised learning of blocks [4] **********
SEED:  0
BEFORE RESIZING
AFTER RESIZING
INDICES:  9469
IMAGE SIZE: torch.Size([10, 3, 160, 160])
SAVING FOLDER FOR UNSUP:  ImageNette_STL10_CL
INSIDE EVALUATE UNSUP
INSIDE EVALUATE UNSUP RETURNED 0,0
Epoch: [1/1]	lr: 3.98e-02	time: 00:10:12	Acc_train 0.00	Acc_test 0.00	convergence: 2.37e+01	R1: 12	Info MB:0.000e+00/SB:0.000e+00/MW:1.748e-04/SW:1.513e-01/MR:2.467e+01/SR:4.938e+00/MeD:3.264e+00/MaD:2.367e+01/MW:0.652/MAW:0.348
|        0 |        1 |       2 |       3 |       4 |       5 |       6 |       7 |       8 |       9 |      10 |      11 |       12 |     13 |      14 |      15 |      16 |      17 |      18 |      19 |      20 |      21 |      22 |      23 |      24 |      25 |     26 |      27 |     28 |      29 |
|----------+----------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+----------+--------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+--------+---------+--------+---------|
|   0.0916 |   0.0865 |   0.104 |   0.114 |   0.118 |   0.114 |   0.114 |   0.116 |   0.115 |   0.115 |   0.118 |   0.113 |   0.0275 |   0.11 |   0.109 |   0.116 |   0.112 |   0.113 |   0.119 |   0.128 |   0.117 |   0.102 |   0.119 |   0.107 |   0.102 |   0.115 |   0.11 |   0.102 |   0.11 |   0.108 |
|  20.16   |  18.75   |  23.7   |  26.69  |  27.73  |  26.57  |  26.75  |  27.27  |  26.82  |  27.02  |  27.72  |  26.48  |   4.85   |  25.33 |  25.11  |  27.17  |  25.94  |  26.27  |  28.29  |  31.01  |  27.64  |  23.15  |  28.31  |  24.47  |  23.24  |  26.93  |  25.35 |  23.23  |  25.38 |  24.96  |
|   0.01   |   0.01   |   0     |   0     |   0     |   0     |   0     |   0.01  |   0     |   0.01  |   0     |   0     |   0.03   |   0    |   0     |   0     |   0     |   0     |   0     |   0     |   0     |   0.01  |   0     |   0.01  |   0.01  |   0     |   0    |   0     |   0    |   0.01  |
| nan      | nan      | nan     | nan     | nan     | nan     | nan     | nan     | nan     | nan     | nan     | nan     | nan      | nan    | nan     | nan     | nan     | nan     | nan     | nan     | nan     | nan     | nan     | nan     | nan     | nan     | nan    | nan     | nan    | nan     |
| nan      | nan      | nan     | nan     | nan     | nan     | nan     | nan     | nan     | nan     | nan     | nan     | nan      | nan    | nan     | nan     | nan     | nan     | nan     | nan     | nan     | nan     | nan     | nan     | nan     | nan     | nan    | nan     | nan    | nan     |
| nan      | nan      | nan     | nan     | nan     | nan     | nan     | nan     | nan     | nan     | nan     | nan     | nan      | nan    | nan     | nan     | nan     | nan     | nan     | nan     | nan     | nan     | nan     | nan     | nan     | nan     | nan    | nan     | nan    | nan     |

STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/ImageNette_STL10_CL/models
SEED:  0
BEFORE RESIZING
AFTER RESIZING
INDICES:  9469
IMAGE SIZE: torch.Size([32, 3, 160, 160])
Accuracy of the network on the 1st dataset: 7.439 %
Test loss on the 1st dataset: 0.424
CL:  True
{'name': 'STL10', 'noise_std': 0, 'channels': 3, 'width': 96, 'height': 96, 'validation_split': 0.2, 'training_sample': 5000, 'testing_sample': 10000, 'out_channels': 10, 'num_workers': 0, 'seed': 0, 'shuffle': True, 'batch_size': 32, 'augmentation': False, 'zca_whitened': False, 'training_class': 'all', 'split': 'train', 'nb_epoch': 50, 'print_freq': 10, 'validation': False, 'continual_learning': True}
CL:  True
{'name': 'STL10', 'noise_std': 0, 'channels': 3, 'width': 96, 'height': 96, 'validation_split': 0.2, 'training_sample': 5000, 'testing_sample': 10000, 'out_channels': 10, 'num_workers': 0, 'seed': 0, 'shuffle': True, 'batch_size': 32, 'augmentation': False, 'zca_whitened': False, 'training_class': 'all', 'split': 'train', 'nb_epoch': 1, 'print_freq': 1, 'validation': False, 'continual_learning': True}
SEED:  0
block 0, size : 48 48 48
range = 2.886751345948129
block 1, size : 192 24 24
range = 1.2028130608117202
block 2, size : 768 12 12
range = 0.6014065304058601
block 3, size : 3072 6 6
range = 0.30070326520293006
block 4, size : 12288 3 3
range = 0.15035163260146503
range = 0.05208333333333333
The device used will be: 
True
cuda:0
CONFIG: {'arch': 'CNN', 'nb_train': None, 'lr': 0.08, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 1.1, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 2, 'weight_init': 'normal', 'weight_init_range': 2.886751345948129, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.75, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 48, 'kernel_size': 5, 'in_channels': 3, 'lr_scheduler': {'lr': 0.08, 'adaptive': True, 'nb_epochs': 1, 'ratio': 0.0010560777273207309, 'speed': 7, 'div': 96, 'decay': 'linear', 'power_lr': 0.75}}
CONFIG: {'arch': 'CNN', 'nb_train': None, 'lr': 0.01, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 0.7, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 1, 'weight_init': 'normal', 'weight_init_range': 1.2028130608117202, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.75, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 192, 'kernel_size': 3, 'in_channels': 48, 'lr_scheduler': {'lr': 0.01, 'adaptive': True, 'nb_epochs': 1, 'ratio': 0.0010560777273207309, 'speed': 7, 'div': 96, 'decay': 'linear', 'power_lr': 0.75}}
CONFIG: {'arch': 'CNN', 'nb_train': None, 'lr': 0.01, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 0.5, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 1, 'weight_init': 'normal', 'weight_init_range': 0.6014065304058601, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.75, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 768, 'kernel_size': 3, 'in_channels': 192, 'lr_scheduler': {'lr': 0.01, 'adaptive': True, 'nb_epochs': 1, 'ratio': 0.0010560777273207309, 'speed': 7, 'div': 96, 'decay': 'linear', 'power_lr': 0.75}}
CONFIG: {'arch': 'CNN', 'nb_train': None, 'lr': 0.01, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 0.4, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 1, 'weight_init': 'normal', 'weight_init_range': 0.30070326520293006, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.75, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 3072, 'kernel_size': 3, 'in_channels': 768, 'lr_scheduler': {'lr': 0.01, 'adaptive': True, 'nb_epochs': 1, 'ratio': 0.0010560777273207309, 'speed': 7, 'div': 96, 'decay': 'linear', 'power_lr': 0.75}}
CONFIG: {'arch': 'CNN', 'nb_train': None, 'lr': 0.01, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 0.25, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 1, 'weight_init': 'normal', 'weight_init_range': 0.15035163260146503, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.75, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 12288, 'kernel_size': 3, 'in_channels': 3072, 'lr_scheduler': {'lr': 0.01, 'adaptive': True, 'nb_epochs': 1, 'ratio': 0.0010560777273207309, 'speed': 7, 'div': 96, 'decay': 'linear', 'power_lr': 0.75}}
CONFIG: {'arch': 'MLP', 'lr': 0.05, 'adaptive': True, 'lr_sup': 0.001, 'speed': 0.4, 'lr_div': 100, 'lebesgue_p': 2, 't_invert': 10, 'beta': 0.01, 'power': 4.5, 'ranking_param': 3, 'delta': 0.1, 'hebbian': False, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'lr_bias': 600, 'softness': 'soft', 'soft_activation_fn': 'exp', 'plasticity': 'SoftHebb', 'metric_mode': 'unsupervised', 'weight_init': 'positive', 'weight_init_range': 0.03125, 'weight_init_offset': 0, 'weight_decay': 0, 'radius': 10, 'power_lr': 0.2, 'out_channels': 10, 'in_channels': 307200, 'old_channels': 12288, 'lr_scheduler': {'decay': 'cste', 'lr': 0.1}}

 Model ImageNette_STL10_CL loaded successfuly with best perf



 ----- Architecture Block BatchNorm2dSK3482(5, 5)1.100000023841858reflect, number 0 -----
- BatchNorm2d(3, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
- HebbSoftKrotovConv2d(3, 48, lebesgue_p=2, pruning=0, kernel_size=(5, 5), bias=False, padding_mode=reflect, t_invert=1.100000023841858, bias=False, lr_bias=0.0909, ranking_param=3, delta=2, activation=exp)
- Triangle(power=0.7)
- MaxPool2d(kernel_size=4, stride=2, padding=1, dilation=1, ceil_mode=False)

 ----- Architecture Block BatchNorm2dSK481922(3, 3)0.699999988079071reflect, number 1 -----
- BatchNorm2d(48, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
- HebbSoftKrotovConv2d(48, 192, lebesgue_p=2, pruning=0, kernel_size=(3, 3), bias=False, padding_mode=reflect, t_invert=0.699999988079071, bias=False, lr_bias=0.1429, ranking_param=3, delta=2, activation=exp)
- Triangle(power=0.7)
- MaxPool2d(kernel_size=4, stride=2, padding=1, dilation=1, ceil_mode=False)

 ----- Architecture Block BatchNorm2dSK1927682(3, 3)0.5reflect, number 2 -----
- BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
- HebbSoftKrotovConv2d(192, 768, lebesgue_p=2, pruning=0, kernel_size=(3, 3), bias=False, padding_mode=reflect, t_invert=0.5, bias=False, lr_bias=0.2, ranking_param=3, delta=2, activation=exp)
- Triangle(power=0.7)
- MaxPool2d(kernel_size=4, stride=2, padding=1, dilation=1, ceil_mode=False)

 ----- Architecture Block BatchNorm2dSK76830722(3, 3)0.4000000059604645reflect, number 3 -----
- BatchNorm2d(768, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
- HebbSoftKrotovConv2d(768, 3072, lebesgue_p=2, pruning=0, kernel_size=(3, 3), bias=False, padding_mode=reflect, t_invert=0.4000000059604645, bias=False, lr_bias=0.25, ranking_param=3, delta=2, activation=exp)
- Triangle(power=1.4)
- MaxPool2d(kernel_size=4, stride=2, padding=1, dilation=1, ceil_mode=False)

 ----- Architecture Block BatchNorm2dSK3072122882(3, 3)0.25reflect, number 4 -----
- BatchNorm2d(3072, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
- HebbSoftKrotovConv2d(3072, 12288, lebesgue_p=2, pruning=0, kernel_size=(3, 3), bias=False, padding_mode=reflect, t_invert=0.25, bias=False, lr_bias=0.4, ranking_param=3, delta=2, activation=exp)
- Triangle(power=1.0)
- AvgPool2d(kernel_size=2, stride=2, padding=0)

 ----- Architecture Block FlattenDropout(p=0.5, inplace=False)Linear(in_, number 5 -----
- Flatten(start_dim=1, end_dim=-1)
- Dropout(p=0.5, inplace=False)
- Linear(in_features=307200, out_features=10, bias=True)

 ********** Hebbian Unsupervised learning of blocks [0] **********
SEED:  0
BEFORE RESIZING
Files already downloaded and verified
AFTER RESIZING
Files already downloaded and verified
INDICES:  5000
IMAGE SIZE: torch.Size([32, 3, 160, 160])
SAVING FOLDER FOR UNSUP:  ImageNette_STL10_CL
INSIDE EVALUATE UNSUP
INSIDE EVALUATE UNSUP RETURNED 0,0
Epoch: [1/1]	lr: 2.20e-01	time: 00:00:46	Acc_train 0.00	Acc_test 0.00	convergence: 2.40e+01	R1: 0	Info MB:0.000e+00/SB:0.000e+00/MW:9.244e-03/SW:7.001e-01/MR:5.269e+00/SR:3.031e+00/MeD:2.599e+00/MaD:5.259e+00/MW:0.718/MAW:0.282
|       0 |       1 |       2 |       3 |          4 |       5 |       6 |       7 |         8 |       9 |       10 |     11 |      12 |      13 |      14 |     15 |        16 |      17 |      18 |        19 |      20 |     21 |      22 |      23 |      24 |       25 |      26 |     27 |        28 |      29 |
|---------+---------+---------+---------+------------+---------+---------+---------+-----------+---------+----------+--------+---------+---------+---------+--------+-----------+---------+---------+-----------+---------+--------+---------+---------+---------+----------+---------+--------+-----------+---------|
|   0.194 |   0.279 |   0.278 |   0.287 |   2.87e-05 |   0.162 |   0.219 |   0.347 |   0.00278 |   0.306 |   0.0639 |   0.3  |   0.321 |   0.317 |   0.286 |   0.43 |   0.00101 |   0.388 |   0.401 |   0.00219 |   0.332 |   0.34 |   0.146 |   0.434 |   0.319 |   0.0553 |   0.162 |   0.06 |   0.00283 |   0.168 |
|   4.27  |   6.28  |   6.27  |   6.5   |   1        |   3.56  |   4.83  |   8.07  |   1.01    |   6.98  |   1.74   |   6.83 |   7.39  |   7.26  |   6.46  |  10.42 |   1       |   9.21  |   9.56  |   1.01    |   7.68  |   7.89 |   3.23  |  10.53  |   7.34  |   1.61   |   3.56  |   1.68 |   1.01    |   3.69  |
|   0.5   |   0.55  |   0.49  |   0.53  |  28.23     |   0.59  |   0.57  |   0.52  |   1.21    |   0.59  |   1.08   |   0.59 |   0.57  |   0.48  |   0.55  |   0.52 |   4.27    |   0.55  |   0.58  |   2.68    |   0.58  |   0.51 |   0.59  |   0.58  |   0.56  |   2.07   |   0.44  |   0.45 |   1.25    |   0.51  |
| nan     | nan     | nan     | nan     | nan        | nan     | nan     | nan     | nan       | nan     | nan      | nan    | nan     | nan     | nan     | nan    | nan       | nan     | nan     | nan       | nan     | nan    | nan     | nan     | nan     | nan      | nan     | nan    | nan       | nan     |
| nan     | nan     | nan     | nan     | nan        | nan     | nan     | nan     | nan       | nan     | nan      | nan    | nan     | nan     | nan     | nan    | nan       | nan     | nan     | nan       | nan     | nan    | nan     | nan     | nan     | nan      | nan     | nan    | nan       | nan     |
| nan     | nan     | nan     | nan     | nan        | nan     | nan     | nan     | nan       | nan     | nan      | nan    | nan     | nan     | nan     | nan    | nan       | nan     | nan     | nan       | nan     | nan    | nan     | nan     | nan     | nan      | nan     | nan    | nan       | nan     |

STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/ImageNette_STL10_CL/models

 ********** Hebbian Unsupervised learning of blocks [1] **********
SEED:  0
BEFORE RESIZING
Files already downloaded and verified
AFTER RESIZING
Files already downloaded and verified
INDICES:  5000
IMAGE SIZE: torch.Size([32, 3, 160, 160])
SAVING FOLDER FOR UNSUP:  ImageNette_STL10_CL
INSIDE EVALUATE UNSUP
INSIDE EVALUATE UNSUP RETURNED 0,0
Epoch: [1/1]	lr: 2.20e-01	time: 00:01:32	Acc_train 0.00	Acc_test 0.00	convergence: 2.40e+01	R1: 0	Info MB:0.000e+00/SB:0.000e+00/MW:1.250e-02/SW:2.047e-01/MR:4.035e+00/SR:1.379e+00/MeD:1.123e+00/MaD:3.032e+00/MW:0.558/MAW:0.442
|        0 |        1 |        2 |        3 |        4 |        5 |        6 |        7 |        8 |        9 |       10 |       11 |       12 |       13 |     14 |        15 |       16 |         17 |       18 |       19 |       20 |       21 |       22 |       23 |       24 |       25 |       26 |       27 |       28 |        29 |
|----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+--------+-----------+----------+------------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+-----------|
|   0.0241 |   0.0198 |   0.0291 |   0.0305 |   0.0187 |   0.0228 |   0.0322 |   0.0257 |   0.0183 |   0.0288 |   0.0292 |   0.0178 |   0.0315 |   0.0313 |   0.02 |   0.00723 |   0.0138 |   0.000322 |   0.0266 |   0.0218 |   0.0207 |   0.0244 |   0.0189 |   0.0277 |   0.0292 |   0.0228 |   0.0307 |   0.0195 |   0.0352 |   0.00798 |
|   4.22   |   3.48   |   5.15   |   5.42   |   3.3    |   4      |   5.75   |   4.52   |   3.24   |   5.1    |   5.18   |   3.16   |   5.61   |   5.57   |   3.53 |   1.65    |   2.54   |   1.01     |   4.68   |   3.83   |   3.63   |   4.28   |   3.33   |   4.88   |   5.17   |   4      |   5.47   |   3.43   |   6.36   |   1.74    |
|   0.27   |   0.16   |   0.31   |   0.2    |   0.19   |   0.26   |   0.34   |   0.22   |   0.32   |   0.37   |   0.39   |   0.22   |   0.46   |   0.42   |   0.19 |   0.27    |   0.42   |  10.62     |   0.25   |   0.12   |   0.15   |   0.38   |   0.26   |   0.24   |   0.31   |   0.35   |   0.47   |   0.14   |   0.28   |   0.2     |
| nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan    | nan       | nan      | nan        | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan       |
| nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan    | nan       | nan      | nan        | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan       |
| nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan    | nan       | nan      | nan        | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan       |

STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/ImageNette_STL10_CL/models

 ********** Hebbian Unsupervised learning of blocks [2] **********
SEED:  0
BEFORE RESIZING
Files already downloaded and verified
AFTER RESIZING
Files already downloaded and verified
INDICES:  5000
IMAGE SIZE: torch.Size([32, 3, 160, 160])
SAVING FOLDER FOR UNSUP:  ImageNette_STL10_CL
INSIDE EVALUATE UNSUP
INSIDE EVALUATE UNSUP RETURNED 0,0
Epoch: [1/1]	lr: 1.08e-01	time: 00:02:21	Acc_train 0.00	Acc_test 0.00	convergence: 2.40e+01	R1: 0	Info MB:0.000e+00/SB:0.000e+00/MW:5.398e-03/SW:2.017e-01/MR:7.975e+00/SR:2.593e+00/MeD:2.028e+00/MaD:6.974e+00/MW:0.592/MAW:0.408
|        0 |        1 |        2 |        3 |        4 |        5 |        6 |        7 |        8 |        9 |       10 |       11 |       12 |       13 |       14 |       15 |      16 |       17 |       18 |       19 |       20 |      21 |       22 |       23 |       24 |       25 |       26 |       27 |       28 |       29 |
|----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+---------+----------+----------+----------+----------+---------+----------+----------+----------+----------+----------+----------+----------+----------|
|   0.0537 |   0.0359 |   0.0551 |   0.0271 |   0.0544 |   0.0618 |   0.0124 |   0.0432 |   0.0518 |   0.0502 |   0.0435 |   0.0277 |   0.0398 |   0.0331 |   0.0566 |   0.0347 |   0.057 |   0.0468 |   0.0258 |   0.0426 |   0.0475 |   0.016 |   0.0519 |   0.0221 |   0.0373 |   0.0586 |   0.0432 |   0.0375 |   0.0308 |   0.0532 |
|  10.39   |   6.5    |  10.72   |   4.77   |  10.58   |  12.33   |   2.33   |   8.04   |   9.95   |   9.59   |   8.09   |   4.88   |   7.3    |   5.94   |  11.09   |   6.25   |  11.19  |   8.83   |   4.54   |   7.91   |   8.99   |   2.87  |   9.99   |   3.88   |   6.79   |  11.57   |   8.03   |   6.83   |   5.47   |  10.28   |
|   0.06   |   0.02   |   0.08   |   0.08   |   0.05   |   0.07   |   0.04   |   0.11   |   0.11   |   0.09   |   0.08   |   0.06   |   0.09   |   0.11   |   0.09   |   0.06   |   0.07  |   0.03   |   0.1    |   0.09   |   0.12   |   0.08  |   0.08   |   0.08   |   0.06   |   0.1    |   0.14   |   0.02   |   0.01   |   0.04   |
| nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan     | nan      | nan      | nan      | nan      | nan     | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      |
| nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan     | nan      | nan      | nan      | nan      | nan     | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      |
| nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan     | nan      | nan      | nan      | nan      | nan     | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      |

STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/ImageNette_STL10_CL/models

 ********** Hebbian Unsupervised learning of blocks [3] **********
SEED:  0
BEFORE RESIZING
Files already downloaded and verified
AFTER RESIZING
Files already downloaded and verified
INDICES:  5000
IMAGE SIZE: torch.Size([32, 3, 160, 160])
SAVING FOLDER FOR UNSUP:  ImageNette_STL10_CL
INSIDE EVALUATE UNSUP
INSIDE EVALUATE UNSUP RETURNED 0,0
Epoch: [1/1]	lr: 5.55e-02	time: 00:03:14	Acc_train 0.00	Acc_test 0.00	convergence: 2.40e+01	R1: 0	Info MB:0.000e+00/SB:0.000e+00/MW:1.029e-03/SW:1.403e-01/MR:1.107e+01/SR:3.666e+00/MeD:2.819e+00/MaD:1.007e+01/MW:0.591/MAW:0.409
|        0 |        1 |        2 |        3 |        4 |        5 |        6 |        7 |        8 |        9 |       10 |       11 |       12 |       13 |       14 |       15 |       16 |       17 |       18 |       19 |       20 |       21 |       22 |       23 |       24 |       25 |       26 |       27 |       28 |       29 |
|----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------|
|   0.0464 |   0.0696 |   0.0586 |   0.0511 |   0.0132 |   0.0648 |   0.0703 |   0.0589 |   0.0182 |   0.0691 |   0.0421 |   0.0564 |   0.0553 |   0.0405 |   0.0679 |   0.0698 |   0.0628 |   0.0654 |   0.0692 |   0.0602 |   0.0571 |   0.0619 |   0.0576 |   0.0717 |   0.0731 |   0.0583 |   0.0742 |   0.0506 |   0.0497 |   0.0591 |
|   8.75   |  14.3    |  11.57   |   9.81   |   2.45   |  13.08   |  14.46   |  11.64   |   3.23   |  14.16   |   7.8    |  11.05   |  10.77   |   7.46   |  13.86   |  14.34   |  12.6    |  13.22   |  14.2    |  11.95   |  11.2    |  12.37   |  11.33   |  14.83   |  15.2    |  11.5    |  15.46   |   9.68   |   9.49   |  11.69   |
|   0.01   |   0.02   |   0.02   |   0.02   |   0.04   |   0.02   |   0.03   |   0.02   |   0.01   |   0.02   |   0.03   |   0.02   |   0.01   |   0.01   |   0.04   |   0.03   |   0.02   |   0.03   |   0.01   |   0.02   |   0.01   |   0.01   |   0.02   |   0.02   |   0.01   |   0.02   |   0.02   |   0.02   |   0.01   |   0.02   |
| nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      |
| nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      |
| nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      |

STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/ImageNette_STL10_CL/models

 ********** Hebbian Unsupervised learning of blocks [4] **********
SEED:  0
BEFORE RESIZING
Files already downloaded and verified
AFTER RESIZING
Files already downloaded and verified
INDICES:  5000
IMAGE SIZE: torch.Size([32, 3, 160, 160])
SAVING FOLDER FOR UNSUP:  ImageNette_STL10_CL
INSIDE EVALUATE UNSUP
INSIDE EVALUATE UNSUP RETURNED 0,0
Epoch: [1/1]	lr: 4.21e-02	time: 00:04:33	Acc_train 0.00	Acc_test 0.00	convergence: 2.31e+01	R1: 7	Info MB:0.000e+00/SB:0.000e+00/MW:3.008e-04/SW:1.483e-01/MR:2.412e+01/SR:5.128e+00/MeD:3.419e+00/MaD:2.312e+01/MW:0.589/MAW:0.411
|        0 |       1 |        2 |       3 |       4 |      5 |       6 |      7 |        8 |       9 |      10 |      11 |       12 |      13 |      14 |      15 |      16 |      17 |      18 |      19 |      20 |       21 |      22 |      23 |       24 |      25 |      26 |      27 |      28 |       29 |
|----------+---------+----------+---------+---------+--------+---------+--------+----------+---------+---------+---------+----------+---------+---------+---------+---------+---------+---------+---------+---------+----------+---------+---------+----------+---------+---------+---------+---------+----------|
|   0.0948 |   0.087 |   0.0976 |   0.113 |   0.106 |   0.11 |   0.119 |   0.1  |   0.0986 |   0.129 |   0.124 |   0.113 |   0.0272 |   0.107 |   0.112 |   0.115 |   0.116 |   0.107 |   0.105 |   0.113 |   0.121 |   0.0823 |   0.109 |   0.104 |   0.0985 |   0.113 |   0.111 |   0.105 |   0.112 |   0.0934 |
|  21.06   |  18.9   |  21.87   |  26.47  |  24.39  |  25.43 |  28.24  |  22.57 |  22.13   |  31.17  |  29.65  |  26.43  |   4.8    |  24.61  |  26.18  |  26.93  |  27.18  |  24.7   |  23.86  |  26.5   |  28.8   |  17.61   |  25.21  |  23.62  |  22.11   |  26.33  |  25.79  |  23.95  |  26.03  |  20.68   |
|   0      |   0     |   0.01   |   0     |   0.01  |   0.01 |   0     |   0.01 |   0.01   |   0.01  |   0     |   0.01  |   0.01   |   0.01  |   0     |   0     |   0.01  |   0.01  |   0     |   0.01  |   0     |   0.01   |   0.01  |   0     |   0.01   |   0     |   0     |   0     |   0     |   0.01   |
| nan      | nan     | nan      | nan     | nan     | nan    | nan     | nan    | nan      | nan     | nan     | nan     | nan      | nan     | nan     | nan     | nan     | nan     | nan     | nan     | nan     | nan      | nan     | nan     | nan      | nan     | nan     | nan     | nan     | nan      |
| nan      | nan     | nan      | nan     | nan     | nan    | nan     | nan    | nan      | nan     | nan     | nan     | nan      | nan     | nan     | nan     | nan     | nan     | nan     | nan     | nan     | nan      | nan     | nan     | nan      | nan     | nan     | nan     | nan     | nan      |
| nan      | nan     | nan      | nan     | nan     | nan    | nan     | nan    | nan      | nan     | nan     | nan     | nan      | nan     | nan     | nan     | nan     | nan     | nan     | nan     | nan     | nan      | nan     | nan     | nan      | nan     | nan     | nan     | nan     | nan      |

STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/ImageNette_STL10_CL/models

 ********** Supervised learning of blocks [5] **********
SAVING FOLDER FOR SUP:  ImageNette_STL10_CL
SEED:  0
BEFORE RESIZING
Files already downloaded and verified
AFTER RESIZING
Files already downloaded and verified
INDICES:  5000
IMAGE SIZE: torch.Size([32, 3, 160, 160])
Epoch: [1/50]	lr: 1.00e-03	time: 00:05:51	Loss_train 15.12123	Acc_train 49.22	/	Loss_test 16.76843	Acc_test 48.36
STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/ImageNette_STL10_CL/models
Epoch: [10/50]	lr: 1.00e-03	time: 00:09:23	Loss_train 2.92090	Acc_train 85.98	/	Loss_test 19.33634	Acc_test 62.22
STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/ImageNette_STL10_CL/models
Epoch: [20/50]	lr: 2.50e-04	time: 00:13:14	Loss_train 0.13654	Acc_train 98.78	/	Loss_test 9.59161	Acc_test 73.97
STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/ImageNette_STL10_CL/models
Epoch: [30/50]	lr: 1.25e-04	time: 00:17:06	Loss_train 0.02575	Acc_train 99.66	/	Loss_test 9.53662	Acc_test 74.07
STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/ImageNette_STL10_CL/models
Epoch: [40/50]	lr: 3.13e-05	time: 00:20:57	Loss_train 0.00146	Acc_train 99.97	/	Loss_test 9.06266	Acc_test 74.85
STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/ImageNette_STL10_CL/models
Epoch: [50/50]	lr: 7.81e-06	time: 00:24:49	Loss_train 0.00014	Acc_train 100.00	/	Loss_test 9.08124	Acc_test 75.00
STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/ImageNette_STL10_CL/models
RESULT:  {'train_loss': 0.0001400707842549309, 'train_acc': 99.99600052833557, 'test_loss': 9.081244468688965, 'test_acc': 75.0, 'convergence': 23.118154525756836, 'R1': 7, 'dataset_sup': {'name': 'STL10', 'noise_std': 0, 'channels': 3, 'width': 96, 'height': 96, 'validation_split': 0.2, 'training_sample': 5000, 'testing_sample': 10000, 'out_channels': 10, 'num_workers': 0, 'seed': 0, 'shuffle': True, 'batch_size': 32, 'augmentation': False, 'zca_whitened': False, 'training_class': 'all', 'split': 'train', 'nb_epoch': 50, 'print_freq': 10, 'validation': False, 'continual_learning': True, 'old_dataset_size': 160}, 'dataset_unsup': {'name': 'STL10', 'noise_std': 0, 'channels': 3, 'width': 96, 'height': 96, 'validation_split': 0.2, 'training_sample': 5000, 'testing_sample': 10000, 'out_channels': 10, 'num_workers': 0, 'seed': 0, 'shuffle': True, 'batch_size': 32, 'augmentation': False, 'zca_whitened': False, 'training_class': 'all', 'split': 'train', 'nb_epoch': 1, 'print_freq': 1, 'validation': False, 'continual_learning': True, 'old_dataset_size': 160}, 'train_config': {'t0': {'blocks': [0], 'mode': 'unsupervised', 'lr': 0.08, 'nb_epoch': 1, 'batch_size': 32, 'print_freq': 1}, 't2': {'blocks': [1], 'mode': 'unsupervised', 'lr': 0.01, 'nb_epoch': 1, 'batch_size': 32, 'print_freq': 1}, 't4': {'blocks': [2], 'mode': 'unsupervised', 'lr': 0.01, 'nb_epoch': 1, 'batch_size': 32, 'print_freq': 1}, 't6': {'blocks': [3], 'mode': 'unsupervised', 'lr': 0.01, 'nb_epoch': 1, 'batch_size': 32, 'print_freq': 1}, 't8': {'blocks': [4], 'mode': 'unsupervised', 'lr': 0.01, 'nb_epoch': 1, 'batch_size': 32, 'print_freq': 1}, 't10': {'blocks': [5], 'mode': 'supervised', 'lr': 0.001, 'nb_epoch': 50, 'batch_size': 32, 'print_freq': 10}}}
IN R1:  {'eval_1': {'test_loss': 0.4239501655101776, 'test_acc': 7.43949031829834, 'convergence': 23.671092987060547, 'R1': 12, 'dataset_sup': {'name': 'ImageNette', 'noise_std': 0, 'channels': 3, 'width': 160, 'height': 160, 'validation_split': 0.2, 'training_sample': 9469, 'testing_sample': 10000, 'out_channels': 10, 'num_workers': 4, 'seed': 0, 'shuffle': True, 'batch_size': 32, 'augmentation': True, 'zca_whitened': False, 'training_class': 'all', 'split': 'train', 'px': 160, 'nb_epoch': 200, 'print_freq': 50, 'validation': False, 'continual_learning': False}, 'dataset_unsup': {'name': 'ImageNette', 'noise_std': 0, 'channels': 3, 'width': 160, 'height': 160, 'validation_split': 0.2, 'training_sample': 9469, 'testing_sample': 10000, 'out_channels': 10, 'num_workers': 0, 'seed': 0, 'shuffle': True, 'batch_size': 10, 'augmentation': False, 'zca_whitened': False, 'training_class': 'all', 'split': 'train', 'px': 160, 'nb_epoch': 1, 'print_freq': 10, 'validation': False, 'continual_learning': False}}, 'R1': {'train_loss': 0.0001400707842549309, 'train_acc': 99.99600052833557, 'test_loss': 9.081244468688965, 'test_acc': 75.0, 'convergence': 23.118154525756836, 'R1': 7, 'dataset_sup': {'name': 'STL10', 'noise_std': 0, 'channels': 3, 'width': 96, 'height': 96, 'validation_split': 0.2, 'training_sample': 5000, 'testing_sample': 10000, 'out_channels': 10, 'num_workers': 0, 'seed': 0, 'shuffle': True, 'batch_size': 32, 'augmentation': False, 'zca_whitened': False, 'training_class': 'all', 'split': 'train', 'nb_epoch': 50, 'print_freq': 10, 'validation': False, 'continual_learning': True, 'old_dataset_size': 160}, 'dataset_unsup': {'name': 'STL10', 'noise_std': 0, 'channels': 3, 'width': 96, 'height': 96, 'validation_split': 0.2, 'training_sample': 5000, 'testing_sample': 10000, 'out_channels': 10, 'num_workers': 0, 'seed': 0, 'shuffle': True, 'batch_size': 32, 'augmentation': False, 'zca_whitened': False, 'training_class': 'all', 'split': 'train', 'nb_epoch': 1, 'print_freq': 1, 'validation': False, 'continual_learning': True, 'old_dataset_size': 160}, 'train_config': {'t0': {'blocks': [0], 'mode': 'unsupervised', 'lr': 0.08, 'nb_epoch': 1, 'batch_size': 32, 'print_freq': 1}, 't2': {'blocks': [1], 'mode': 'unsupervised', 'lr': 0.01, 'nb_epoch': 1, 'batch_size': 32, 'print_freq': 1}, 't4': {'blocks': [2], 'mode': 'unsupervised', 'lr': 0.01, 'nb_epoch': 1, 'batch_size': 32, 'print_freq': 1}, 't6': {'blocks': [3], 'mode': 'unsupervised', 'lr': 0.01, 'nb_epoch': 1, 'batch_size': 32, 'print_freq': 1}, 't8': {'blocks': [4], 'mode': 'unsupervised', 'lr': 0.01, 'nb_epoch': 1, 'batch_size': 32, 'print_freq': 1}, 't10': {'blocks': [5], 'mode': 'supervised', 'lr': 0.001, 'nb_epoch': 50, 'batch_size': 32, 'print_freq': 10}}}}
SEED:  0
block 0, size : 48 80 80
range = 2.886751345948129
block 1, size : 192 40 40
range = 1.2028130608117202
block 2, size : 768 20 20
range = 0.6014065304058601
block 3, size : 3072 10 10
range = 0.30070326520293006
block 4, size : 12288 5 5
range = 0.15035163260146503
range = 0.03125
The device used will be: 
True
cuda:0
CONFIG: {'arch': 'CNN', 'nb_train': None, 'lr': 0.08, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 1.1, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 2, 'weight_init': 'normal', 'weight_init_range': 2.886751345948129, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.75, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 48, 'kernel_size': 5, 'in_channels': 3, 'lr_scheduler': {'lr': 0.08, 'adaptive': True, 'nb_epochs': 1, 'ratio': 0.0010560777273207309, 'speed': 7, 'div': 96, 'decay': 'linear', 'power_lr': 0.75}}
CONFIG: {'arch': 'CNN', 'nb_train': None, 'lr': 0.01, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 0.7, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 1, 'weight_init': 'normal', 'weight_init_range': 1.2028130608117202, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.75, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 192, 'kernel_size': 3, 'in_channels': 48, 'lr_scheduler': {'lr': 0.01, 'adaptive': True, 'nb_epochs': 1, 'ratio': 0.0010560777273207309, 'speed': 7, 'div': 96, 'decay': 'linear', 'power_lr': 0.75}}
CONFIG: {'arch': 'CNN', 'nb_train': None, 'lr': 0.01, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 0.5, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 1, 'weight_init': 'normal', 'weight_init_range': 0.6014065304058601, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.75, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 768, 'kernel_size': 3, 'in_channels': 192, 'lr_scheduler': {'lr': 0.01, 'adaptive': True, 'nb_epochs': 1, 'ratio': 0.0010560777273207309, 'speed': 7, 'div': 96, 'decay': 'linear', 'power_lr': 0.75}}
CONFIG: {'arch': 'CNN', 'nb_train': None, 'lr': 0.01, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 0.4, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 1, 'weight_init': 'normal', 'weight_init_range': 0.30070326520293006, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.75, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 3072, 'kernel_size': 3, 'in_channels': 768, 'lr_scheduler': {'lr': 0.01, 'adaptive': True, 'nb_epochs': 1, 'ratio': 0.0010560777273207309, 'speed': 7, 'div': 96, 'decay': 'linear', 'power_lr': 0.75}}
CONFIG: {'arch': 'CNN', 'nb_train': None, 'lr': 0.01, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 0.25, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 1, 'weight_init': 'normal', 'weight_init_range': 0.15035163260146503, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.75, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 12288, 'kernel_size': 3, 'in_channels': 3072, 'lr_scheduler': {'lr': 0.01, 'adaptive': True, 'nb_epochs': 1, 'ratio': 0.0010560777273207309, 'speed': 7, 'div': 96, 'decay': 'linear', 'power_lr': 0.75}}
CONFIG: {'arch': 'MLP', 'lr': 0.05, 'adaptive': True, 'lr_sup': 0.001, 'speed': 0.4, 'lr_div': 100, 'lebesgue_p': 2, 't_invert': 10, 'beta': 0.01, 'power': 4.5, 'ranking_param': 3, 'delta': 0.1, 'hebbian': False, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'lr_bias': 600, 'softness': 'soft', 'soft_activation_fn': 'exp', 'plasticity': 'SoftHebb', 'metric_mode': 'unsupervised', 'weight_init': 'positive', 'weight_init_range': 0.03125, 'weight_init_offset': 0, 'weight_decay': 0, 'radius': 10, 'power_lr': 0.2, 'out_channels': 10, 'in_channels': 307200, 'old_channels': 12288, 'lr_scheduler': {'decay': 'cste', 'lr': 0.1}}

 Model ImageNette_STL10_CL loaded successfuly with best perf



 ----- Architecture Block BatchNorm2dSK3482(5, 5)1.100000023841858reflect, number 0 -----
- BatchNorm2d(3, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
- HebbSoftKrotovConv2d(3, 48, lebesgue_p=2, pruning=0, kernel_size=(5, 5), bias=False, padding_mode=reflect, t_invert=1.100000023841858, bias=False, lr_bias=0.0909, ranking_param=3, delta=2, activation=exp)
- Triangle(power=0.7)
- MaxPool2d(kernel_size=4, stride=2, padding=1, dilation=1, ceil_mode=False)

 ----- Architecture Block BatchNorm2dSK481922(3, 3)0.699999988079071reflect, number 1 -----
- BatchNorm2d(48, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
- HebbSoftKrotovConv2d(48, 192, lebesgue_p=2, pruning=0, kernel_size=(3, 3), bias=False, padding_mode=reflect, t_invert=0.699999988079071, bias=False, lr_bias=0.1429, ranking_param=3, delta=2, activation=exp)
- Triangle(power=0.7)
- MaxPool2d(kernel_size=4, stride=2, padding=1, dilation=1, ceil_mode=False)

 ----- Architecture Block BatchNorm2dSK1927682(3, 3)0.5reflect, number 2 -----
- BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
- HebbSoftKrotovConv2d(192, 768, lebesgue_p=2, pruning=0, kernel_size=(3, 3), bias=False, padding_mode=reflect, t_invert=0.5, bias=False, lr_bias=0.2, ranking_param=3, delta=2, activation=exp)
- Triangle(power=0.7)
- MaxPool2d(kernel_size=4, stride=2, padding=1, dilation=1, ceil_mode=False)

 ----- Architecture Block BatchNorm2dSK76830722(3, 3)0.4000000059604645reflect, number 3 -----
- BatchNorm2d(768, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
- HebbSoftKrotovConv2d(768, 3072, lebesgue_p=2, pruning=0, kernel_size=(3, 3), bias=False, padding_mode=reflect, t_invert=0.4000000059604645, bias=False, lr_bias=0.25, ranking_param=3, delta=2, activation=exp)
- Triangle(power=1.4)
- MaxPool2d(kernel_size=4, stride=2, padding=1, dilation=1, ceil_mode=False)

 ----- Architecture Block BatchNorm2dSK3072122882(3, 3)0.25reflect, number 4 -----
- BatchNorm2d(3072, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
- HebbSoftKrotovConv2d(3072, 12288, lebesgue_p=2, pruning=0, kernel_size=(3, 3), bias=False, padding_mode=reflect, t_invert=0.25, bias=False, lr_bias=0.4, ranking_param=3, delta=2, activation=exp)
- Triangle(power=1.0)
- AvgPool2d(kernel_size=2, stride=2, padding=0)

 ----- Architecture Block FlattenDropout(p=0.5, inplace=False)Linear(in_, number 5 -----
- Flatten(start_dim=1, end_dim=-1)
- Dropout(p=0.5, inplace=False)
- Linear(in_features=307200, out_features=10, bias=True)

 ********** Hebbian Unsupervised learning of blocks [0] **********
SEED:  0
BEFORE RESIZING
AFTER RESIZING
INDICES:  9469
IMAGE SIZE: torch.Size([10, 3, 160, 160])
SAVING FOLDER FOR UNSUP:  ImageNette_STL10_CL
INSIDE EVALUATE UNSUP
INSIDE EVALUATE UNSUP RETURNED 0,0
Epoch: [1/1]	lr: 1.11e-01	time: 00:01:45	Acc_train 0.00	Acc_test 0.00	convergence: 2.40e+01	R1: 0	Info MB:0.000e+00/SB:0.000e+00/MW:6.445e-03/SW:3.349e-01/MR:2.704e+00/SR:1.061e+00/MeD:8.848e-01/MaD:1.704e+00/MW:0.744/MAW:0.256
|       0 |       1 |       2 |       3 |          4 |       5 |        6 |       7 |          8 |       9 |        10 |      11 |      12 |      13 |     14 |      15 |         16 |      17 |      18 |        19 |      20 |      21 |       22 |      23 |      24 |      25 |      26 |      27 |         28 |      29 |
|---------+---------+---------+---------+------------+---------+----------+---------+------------+---------+-----------+---------+---------+---------+--------+---------+------------+---------+---------+-----------+---------+---------+----------+---------+---------+---------+---------+---------+------------+---------|
|   0.144 |   0.108 |   0.149 |   0.117 |   2.53e-09 |   0.063 |   0.0959 |   0.184 |   0.000372 |   0.125 |   0.00337 |   0.188 |   0.147 |   0.152 |   0.13 |   0.182 |   0.000156 |   0.166 |   0.186 |   0.00081 |   0.179 |   0.163 |   0.0494 |   0.178 |   0.158 |   0.106 |   0.176 |   0.125 |   0.000381 |   0.134 |
|   3.19  |   2.49  |   3.3   |   2.66  |   1        |   1.73  |   2.27   |   4.04  |   1        |   2.81  |   1.01    |   4.13  |   3.25  |   3.35  |   2.9  |   3.98  |   1        |   3.64  |   4.07  |   1       |   3.93  |   3.58  |   1.53   |   3.9   |   3.48  |   2.46  |   3.87  |   2.81  |   1        |   2.99  |
|   0.55  |   0.58  |   0.52  |   0.52  |  27.85     |   0.58  |   0.57   |   0.56  |   1.45     |   0.6   |   1.1     |   0.55  |   0.55  |   0.51  |   0.59 |   0.51  |   3.82     |   0.52  |   0.53  |   1.68    |   0.54  |   0.54  |   0.62   |   0.58  |   0.54  |   0.73  |   0.42  |   0.75  |   1.44     |   0.47  |
| nan     | nan     | nan     | nan     | nan        | nan     | nan      | nan     | nan        | nan     | nan       | nan     | nan     | nan     | nan    | nan     | nan        | nan     | nan     | nan       | nan     | nan     | nan      | nan     | nan     | nan     | nan     | nan     | nan        | nan     |
| nan     | nan     | nan     | nan     | nan        | nan     | nan      | nan     | nan        | nan     | nan       | nan     | nan     | nan     | nan    | nan     | nan        | nan     | nan     | nan       | nan     | nan     | nan      | nan     | nan     | nan     | nan     | nan     | nan        | nan     |
| nan     | nan     | nan     | nan     | nan        | nan     | nan      | nan     | nan        | nan     | nan       | nan     | nan     | nan     | nan    | nan     | nan        | nan     | nan     | nan       | nan     | nan     | nan      | nan     | nan     | nan     | nan     | nan     | nan        | nan     |

STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/ImageNette_STL10_CL/models

 ********** Hebbian Unsupervised learning of blocks [1] **********
SEED:  0
BEFORE RESIZING
AFTER RESIZING
INDICES:  9469
IMAGE SIZE: torch.Size([10, 3, 160, 160])
SAVING FOLDER FOR UNSUP:  ImageNette_STL10_CL
INSIDE EVALUATE UNSUP
INSIDE EVALUATE UNSUP RETURNED 0,0
Epoch: [1/1]	lr: 1.11e-01	time: 00:03:30	Acc_train 0.00	Acc_test 0.00	convergence: 2.40e+01	R1: 0	Info MB:0.000e+00/SB:0.000e+00/MW:1.180e-02/SW:1.757e-01/MR:3.409e+00/SR:1.334e+00/MeD:1.075e+00/MaD:4.154e+00/MW:0.645/MAW:0.355
|        0 |        1 |        2 |        3 |        4 |        5 |        6 |        7 |        8 |        9 |       10 |       11 |       12 |       13 |        14 |       15 |       16 |         17 |       18 |       19 |       20 |       21 |       22 |       23 |       24 |      25 |       26 |       27 |       28 |        29 |
|----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+-----------+----------+----------+------------+----------+----------+----------+----------+----------+----------+----------+---------+----------+----------+----------+-----------|
|   0.0182 |   0.0158 |   0.0211 |   0.0236 |   0.0174 |   0.0155 |   0.0245 |   0.0229 |   0.0159 |   0.0218 |   0.0235 |   0.0277 |   0.0252 |   0.0227 |   0.00714 |   0.0128 |   0.0171 |   2.26e-05 |   0.0175 |   0.0177 |   0.0164 |   0.0222 |   0.0266 |   0.0152 |   0.0177 |   0.019 |   0.0273 |   0.0233 |   0.0237 |   0.00308 |
|   3.21   |   2.85   |   3.7    |   4.14   |   3.09   |   2.8    |   4.3    |   4.02   |   2.85   |   3.83   |   4.12   |   4.89   |   4.42   |   3.98   |   1.64    |   2.4    |   3.04   |   1        |   3.11   |   3.14   |   2.94   |   3.89   |   4.68   |   2.74   |   3.14   |   3.35  |   4.82   |   4.09   |   4.16   |   1.21    |
|   0.22   |   0.17   |   0.18   |   0.2    |   0.23   |   0.23   |   0.25   |   0.24   |   0.21   |   0.26   |   0.31   |   0.18   |   0.33   |   0.31   |   0.22    |   0.2    |   0.14   |  17.57     |   0.24   |   0.16   |   0.2    |   0.21   |   0.22   |   0.27   |   0.22   |   0.3   |   0.25   |   0.16   |   0.18   |   0.35    |
| nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan       | nan      | nan      | nan        | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan     | nan      | nan      | nan      | nan       |
| nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan       | nan      | nan      | nan        | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan     | nan      | nan      | nan      | nan       |
| nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan       | nan      | nan      | nan        | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan     | nan      | nan      | nan      | nan       |

STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/ImageNette_STL10_CL/models

 ********** Hebbian Unsupervised learning of blocks [2] **********
SEED:  0
BEFORE RESIZING
AFTER RESIZING
INDICES:  9469
IMAGE SIZE: torch.Size([10, 3, 160, 160])
SAVING FOLDER FOR UNSUP:  ImageNette_STL10_CL
INSIDE EVALUATE UNSUP
INSIDE EVALUATE UNSUP RETURNED 0,0
Epoch: [1/1]	lr: 1.08e-01	time: 00:05:09	Acc_train 0.00	Acc_test 0.00	convergence: 2.40e+01	R1: 0	Info MB:0.000e+00/SB:0.000e+00/MW:6.459e-03/SW:1.660e-01/MR:6.472e+00/SR:2.415e+00/MeD:1.898e+00/MaD:5.885e+00/MW:0.609/MAW:0.391
|        0 |        1 |        2 |        3 |        4 |        5 |        6 |        7 |        8 |        9 |       10 |       11 |       12 |       13 |       14 |       15 |       16 |       17 |       18 |       19 |       20 |       21 |       22 |       23 |       24 |       25 |       26 |       27 |       28 |       29 |
|----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------|
|   0.0449 |   0.0449 |   0.0365 |   0.0546 |   0.0298 |   0.0532 |   0.0065 |   0.0427 |   0.0358 |   0.0387 |   0.0263 |   0.0343 |   0.0349 |   0.0484 |   0.0489 |   0.0285 |   0.0513 |   0.0419 |   0.0366 |   0.0369 |   0.0467 |   0.0229 |   0.0331 |   0.0245 |   0.0191 |   0.0504 |   0.0448 |   0.0405 |   0.0103 |   0.0315 |
|   8.4    |   8.4    |   6.62   |  10.61   |   5.28   |  10.28   |   1.56   |   7.93   |   6.48   |   7.08   |   4.62   |   6.17   |   6.29   |   9.19   |   9.31   |   5.04   |   9.84   |   7.76   |   6.64   |   6.71   |   8.8    |   4.02   |   5.93   |   4.3    |   3.37   |   9.65   |   8.38   |   7.46   |   2.03   |   5.61   |
|   0.07   |   0.08   |   0.07   |   0.07   |   0.07   |   0.1    |   0.11   |   0.13   |   0.07   |   0.09   |   0.06   |   0.01   |   0.09   |   0.08   |   0.09   |   0.07   |   0.07   |   0.07   |   0.01   |   0.1    |   0.09   |   0.03   |   0.08   |   0.05   |   0.09   |   0.09   |   0.09   |   0.1    |   0.03   |   0.08   |
| nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      |
| nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      |
| nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      |

STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/ImageNette_STL10_CL/models

 ********** Hebbian Unsupervised learning of blocks [3] **********
SEED:  0
BEFORE RESIZING
AFTER RESIZING
INDICES:  9469
IMAGE SIZE: torch.Size([10, 3, 160, 160])
SAVING FOLDER FOR UNSUP:  ImageNette_STL10_CL
INSIDE EVALUATE UNSUP
INSIDE EVALUATE UNSUP RETURNED 0,0
Epoch: [1/1]	lr: 5.48e-02	time: 00:07:00	Acc_train 0.00	Acc_test 0.00	convergence: 2.40e+01	R1: 0	Info MB:0.000e+00/SB:0.000e+00/MW:1.067e-03/SW:1.421e-01/MR:1.102e+01/SR:4.260e+00/MeD:3.369e+00/MaD:1.002e+01/MW:0.610/MAW:0.390
|        0 |        1 |       2 |        3 |        4 |       5 |       6 |        7 |        8 |        9 |       10 |       11 |       12 |       13 |       14 |       15 |       16 |       17 |       18 |       19 |       20 |       21 |       22 |       23 |       24 |       25 |       26 |       27 |       28 |       29 |
|----------+----------+---------+----------+----------+---------+---------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------|
|   0.0652 |   0.0757 |   0.052 |   0.0674 |   0.0027 |   0.061 |   0.066 |   0.0548 |   0.0214 |   0.0712 |   0.0552 |   0.0603 |   0.0508 |   0.0519 |   0.0751 |   0.0704 |   0.0793 |   0.0708 |   0.0739 |   0.0523 |   0.0664 |   0.0374 |   0.0448 |   0.0778 |   0.0745 |   0.0682 |   0.0706 |   0.0289 |   0.0553 |   0.0636 |
|  13.17   |  15.86   |  10.01  |  13.73   |   1.17   |  12.14  |  13.39  |  10.66   |   3.75   |  14.7    |  10.75   |  11.98   |   9.73   |   9.99   |  15.71   |  14.49   |  16.81   |  14.59   |  15.38   |  10.08   |  13.49   |   6.81   |   8.39   |  16.41   |  15.55   |  13.93   |  14.55   |   5.12   |  10.79   |  12.78   |
|   0.01   |   0.02   |   0.03  |   0      |   0.1    |   0.02  |   0.02  |   0.02   |   0      |   0.02   |   0      |   0.02   |   0.01   |   0      |   0.02   |   0.02   |   0.02   |   0.02   |   0.01   |   0.02   |   0.02   |   0.02   |   0.01   |   0.02   |   0.02   |   0.02   |   0.02   |   0.02   |   0      |   0.02   |
| nan      | nan      | nan     | nan      | nan      | nan     | nan     | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      |
| nan      | nan      | nan     | nan      | nan      | nan     | nan     | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      |
| nan      | nan      | nan     | nan      | nan      | nan     | nan     | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      |

STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/ImageNette_STL10_CL/models

 ********** Hebbian Unsupervised learning of blocks [4] **********
SEED:  0
BEFORE RESIZING
AFTER RESIZING
INDICES:  9469
IMAGE SIZE: torch.Size([10, 3, 160, 160])
SAVING FOLDER FOR UNSUP:  ImageNette_STL10_CL
INSIDE EVALUATE UNSUP
INSIDE EVALUATE UNSUP RETURNED 0,0
Epoch: [1/1]	lr: 3.48e-02	time: 00:10:05	Acc_train 0.00	Acc_test 0.00	convergence: 2.00e+01	R1: 9	Info MB:0.000e+00/SB:0.000e+00/MW:7.219e-04/SW:1.304e-01/MR:2.102e+01/SR:5.327e+00/MeD:3.594e+00/MaD:2.002e+01/MW:0.582/MAW:0.418
|        0 |        1 |        2 |        3 |        4 |       5 |       6 |       7 |        8 |       9 |      10 |      11 |       12 |     13 |      14 |      15 |       16 |      17 |      18 |       19 |      20 |       21 |       22 |      23 |       24 |       25 |       26 |      27 |      28 |       29 |
|----------+----------+----------+----------+----------+---------+---------+---------+----------+---------+---------+---------+----------+--------+---------+---------+----------+---------+---------+----------+---------+----------+----------+---------+----------+----------+----------+---------+---------+----------|
|   0.0984 |   0.0855 |   0.0833 |   0.0946 |   0.0995 |   0.064 |   0.106 |   0.103 |   0.0949 |   0.111 |   0.103 |   0.116 |   0.0282 |   0.11 |   0.117 |   0.101 |   0.0953 |   0.101 |   0.109 |   0.0901 |   0.101 |   0.0908 |   0.0853 |   0.103 |   0.0916 |   0.0867 |   0.0831 |   0.105 |   0.111 |   0.0979 |
|  22.1    |  18.49   |  17.88   |  21      |  22.39   |  12.87  |  24.15  |  23.35  |  21.09   |  25.9   |  23.29  |  27.12  |   4.99   |  25.58 |  27.42  |  22.84  |  21.21   |  22.95  |  25.29  |  19.76   |  22.96  |  19.95   |  18.42   |  23.27  |  20.18   |  18.81   |  17.82   |  24.03  |  25.84  |  21.95   |
|   0      |   0      |   0.01   |   0.01   |   0.01   |   0.01  |   0     |   0.01  |   0      |   0.01  |   0.01  |   0.01  |   0      |   0.01 |   0.01  |   0     |   0.01   |   0     |   0     |   0.01   |   0.01  |   0      |   0.01   |   0.01  |   0      |   0      |   0.01   |   0.01  |   0     |   0.01   |
| nan      | nan      | nan      | nan      | nan      | nan     | nan     | nan     | nan      | nan     | nan     | nan     | nan      | nan    | nan     | nan     | nan      | nan     | nan     | nan      | nan     | nan      | nan      | nan     | nan      | nan      | nan      | nan     | nan     | nan      |
| nan      | nan      | nan      | nan      | nan      | nan     | nan     | nan     | nan      | nan     | nan     | nan     | nan      | nan    | nan     | nan     | nan      | nan     | nan     | nan      | nan     | nan      | nan      | nan     | nan      | nan      | nan      | nan     | nan     | nan      |
| nan      | nan      | nan      | nan      | nan      | nan     | nan     | nan     | nan      | nan     | nan     | nan     | nan      | nan    | nan     | nan     | nan      | nan     | nan     | nan      | nan     | nan      | nan      | nan     | nan      | nan      | nan      | nan     | nan     | nan      |

STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/ImageNette_STL10_CL/models
SEED:  0
BEFORE RESIZING
AFTER RESIZING
INDICES:  9469
IMAGE SIZE: torch.Size([32, 3, 160, 160])
Accuracy of the network on the 1st dataset: 8.306 %
Test loss on the 1st dataset: 69.882

