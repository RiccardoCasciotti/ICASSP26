BLOCKS:  {'b0': {'arch': 'CNN', 'preset': 'softkrotov-c96-k5-p2-s1-d1-b0-t1-lr0.08-lp0.5-e0', 'operation': 'batchnorm2d', 'num': 0, 'batch_norm': False, 'pool': {'type': 'avg', 'kernel_size': 4, 'stride': 2, 'padding': 1}, 'activation': {'function': 'triangle', 'param': 0.7}, 'resume': None, 'layer': {'arch': 'CNN', 'nb_train': None, 'lr': 0.08, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 1.0, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 2, 'weight_init': 'positive', 'weight_init_range': 2, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.5, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 96, 'kernel_size': 5}}, 'b1': {'arch': 'CNN', 'preset': 'softkrotov-c384-k3-p1-s1-d1-b0-t0.65-lr0.005-lp0.5-e0', 'operation': 'batchnorm2d', 'num': 1, 'batch_norm': False, 'pool': {'type': 'max', 'kernel_size': 4, 'stride': 2, 'padding': 1}, 'activation': {'function': 'triangle', 'param': 0.7}, 'resume': None, 'layer': {'arch': 'CNN', 'nb_train': None, 'lr': 0.005, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 0.65, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 1, 'weight_init': 'positive', 'weight_init_range': 2, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.5, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 384, 'kernel_size': 3}}, 'b2': {'arch': 'CNN', 'preset': 'softkrotov-c1536-k3-p1-s1-d1-b0-t0.45-lr0.01-lp0.5-e0', 'operation': 'batchnorm2d', 'num': 2, 'batch_norm': False, 'pool': {'type': 'avg', 'kernel_size': 4, 'stride': 2, 'padding': 1}, 'activation': {'function': 'triangle', 'param': 1.4}, 'resume': None, 'layer': {'arch': 'CNN', 'nb_train': None, 'lr': 0.01, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 0.45, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 1, 'weight_init': 'positive', 'weight_init_range': 2, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.5, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 1536, 'kernel_size': 3}}, 'b3': {'arch': 'CNN', 'preset': 'softkrotov-c6144-k3-p1-s1-d1-b0-t0.25-lr0.01-lp0.5-e0', 'operation': 'batchnorm2d', 'num': 3, 'batch_norm': False, 'pool': {'type': 'avg', 'kernel_size': 2, 'stride': 2, 'padding': 0}, 'activation': {'function': 'triangle', 'param': 1}, 'resume': None, 'layer': {'arch': 'CNN', 'nb_train': None, 'lr': 0.01, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 0.25, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 1, 'weight_init': 'positive', 'weight_init_range': 2, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.5, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 6144, 'kernel_size': 3}}, 'b4': {'arch': 'MLP', 'preset': 'BP-c10', 'operation': 'flatten', 'num': 4, 'att_dropout': None, 'dropout': 0.5, 'layer': {'arch': 'MLP', 'lr': 0.05, 'adaptive': True, 'lr_sup': 0.001, 'speed': 0.4, 'lr_div': 100, 'lebesgue_p': 2, 't_invert': 10, 'beta': 0.01, 'power': 4.5, 'ranking_param': 3, 'delta': 0.1, 'hebbian': False, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'lr_bias': 600, 'softness': 'soft', 'soft_activation_fn': 'exp', 'plasticity': 'SoftHebb', 'metric_mode': 'unsupervised', 'weight_init': 'positive', 'weight_init_range': 0.25, 'weight_init_offset': 0, 'weight_decay': 0, 'radius': 10, 'power_lr': 0.2, 'out_channels': 10}, 'pool': None, 'activation': None}}
CL:  True
{'name': 'STL10', 'noise_std': 0, 'channels': 3, 'width': 96, 'height': 96, 'validation_split': 0.2, 'training_sample': 5000, 'testing_sample': 10000, 'out_channels': 10, 'num_workers': 0, 'seed': 0, 'shuffle': True, 'batch_size': 64, 'augmentation': True, 'zca_whitened': False, 'training_class': 'all', 'split': 'train', 'nb_epoch': 100, 'print_freq': 10, 'validation': False, 'continual_learning': True}
CL:  False
{'name': 'STL10', 'noise_std': 0, 'channels': 3, 'width': 96, 'height': 96, 'validation_split': 0.2, 'training_sample': 5000, 'testing_sample': 10000, 'out_channels': 10, 'num_workers': 0, 'seed': 0, 'shuffle': True, 'batch_size': 64, 'augmentation': True, 'zca_whitened': False, 'training_class': 'all', 'split': 'train', 'nb_epoch': 100, 'print_freq': 10, 'validation': False, 'continual_learning': False}
CL:  False
{'name': 'STL10', 'noise_std': 0, 'channels': 3, 'width': 96, 'height': 96, 'validation_split': 0.2, 'training_sample': 100000, 'testing_sample': 10000, 'out_channels': 10, 'num_workers': 0, 'seed': 0, 'shuffle': True, 'batch_size': 32, 'augmentation': False, 'zca_whitened': False, 'training_class': 'all', 'split': 'unlabeled', 'nb_epoch': 1, 'print_freq': 25, 'validation': False, 'continual_learning': False}
SEED:  0
block 0, size : 96 48 48
range = 2.886751345948129
block 1, size : 384 24 24
range = 0.8505172717997146
block 2, size : 1536 12 12
range = 0.4252586358998573
block 3, size : 6144 6 6
range = 0.21262931794992865
range = 0.036828478186799345
The device used will be: 
True
cuda:0
CONFIG: {'arch': 'CNN', 'nb_train': None, 'lr': 0.08, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 1.0, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 2, 'weight_init': 'normal', 'weight_init_range': 2.886751345948129, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.5, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 96, 'kernel_size': 5, 'in_channels': 3, 'lr_scheduler': {'lr': 0.08, 'adaptive': True, 'nb_epochs': 1, 'ratio': 0.00032, 'speed': 7, 'div': 96, 'decay': 'linear', 'power_lr': 0.5}}
CONFIG: {'arch': 'CNN', 'nb_train': None, 'lr': 0.005, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 0.65, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 1, 'weight_init': 'normal', 'weight_init_range': 0.8505172717997146, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.5, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 384, 'kernel_size': 3, 'in_channels': 96, 'lr_scheduler': {'lr': 0.005, 'adaptive': True, 'nb_epochs': 1, 'ratio': 0.00032, 'speed': 7, 'div': 96, 'decay': 'linear', 'power_lr': 0.5}}
CONFIG: {'arch': 'CNN', 'nb_train': None, 'lr': 0.01, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 0.45, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 1, 'weight_init': 'normal', 'weight_init_range': 0.4252586358998573, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.5, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 1536, 'kernel_size': 3, 'in_channels': 384, 'lr_scheduler': {'lr': 0.01, 'adaptive': True, 'nb_epochs': 1, 'ratio': 0.00032, 'speed': 7, 'div': 96, 'decay': 'linear', 'power_lr': 0.5}}
CONFIG: {'arch': 'CNN', 'nb_train': None, 'lr': 0.01, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 0.25, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 1, 'weight_init': 'normal', 'weight_init_range': 0.21262931794992865, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.5, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 6144, 'kernel_size': 3, 'in_channels': 1536, 'lr_scheduler': {'lr': 0.01, 'adaptive': True, 'nb_epochs': 1, 'ratio': 0.00032, 'speed': 7, 'div': 96, 'decay': 'linear', 'power_lr': 0.5}}
CONFIG: {'arch': 'MLP', 'lr': 0.05, 'adaptive': True, 'lr_sup': 0.001, 'speed': 0.4, 'lr_div': 100, 'lebesgue_p': 2, 't_invert': 10, 'beta': 0.01, 'power': 4.5, 'ranking_param': 3, 'delta': 0.1, 'hebbian': False, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'lr_bias': 600, 'softness': 'soft', 'soft_activation_fn': 'exp', 'plasticity': 'SoftHebb', 'metric_mode': 'unsupervised', 'weight_init': 'positive', 'weight_init_range': 0.036828478186799345, 'weight_init_offset': 0, 'weight_decay': 0, 'radius': 10, 'power_lr': 0.2, 'out_channels': 10, 'in_channels': 221184, 'old_channels': 6144, 'lr_scheduler': {'decay': 'cste', 'lr': 0.1}}

 Model STL10_CIFAR100_CL loaded successfuly with best perf



 ----- Architecture Block BatchNorm2dSK3962(5, 5)1.0reflect, number 0 -----
- BatchNorm2d(3, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
- HebbSoftKrotovConv2d(3, 96, lebesgue_p=2, pruning=0, kernel_size=(5, 5), bias=False, padding_mode=reflect, t_invert=1.0, bias=False, lr_bias=0.1, ranking_param=3, delta=2, activation=exp)
- Triangle(power=0.7)
- AvgPool2d(kernel_size=4, stride=2, padding=1)

 ----- Architecture Block BatchNorm2dSK963842(3, 3)0.6499999761581421reflect, number 1 -----
- BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
- HebbSoftKrotovConv2d(96, 384, lebesgue_p=2, pruning=0, kernel_size=(3, 3), bias=False, padding_mode=reflect, t_invert=0.6499999761581421, bias=False, lr_bias=0.1538, ranking_param=3, delta=2, activation=exp)
- Triangle(power=0.7)
- MaxPool2d(kernel_size=4, stride=2, padding=1, dilation=1, ceil_mode=False)

 ----- Architecture Block BatchNorm2dSK38415362(3, 3)0.44999998807907104reflect, number 2 -----
- BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
- HebbSoftKrotovConv2d(384, 1536, lebesgue_p=2, pruning=0, kernel_size=(3, 3), bias=False, padding_mode=reflect, t_invert=0.44999998807907104, bias=False, lr_bias=0.2222, ranking_param=3, delta=2, activation=exp)
- Triangle(power=1.4)
- AvgPool2d(kernel_size=4, stride=2, padding=1)

 ----- Architecture Block BatchNorm2dSK153661442(3, 3)0.25reflect, number 3 -----
- BatchNorm2d(1536, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
- HebbSoftKrotovConv2d(1536, 6144, lebesgue_p=2, pruning=0, kernel_size=(3, 3), bias=False, padding_mode=reflect, t_invert=0.25, bias=False, lr_bias=0.4, ranking_param=3, delta=2, activation=exp)
- Triangle(power=1)
- AvgPool2d(kernel_size=2, stride=2, padding=0)

 ----- Architecture Block FlattenDropout(p=0.5, inplace=False)Linear(in_, number 4 -----
- Flatten(start_dim=1, end_dim=-1)
- Dropout(p=0.5, inplace=False)
- Linear(in_features=221184, out_features=10, bias=True)

 ********** Hebbian Unsupervised learning of blocks [0] **********
SEED:  0
BEFORE RESIZING
Files already downloaded and verified
AFTER RESIZING
Files already downloaded and verified
INDICES:  5000
IMAGE SIZE: torch.Size([32, 3, 96, 96])
SAVING FOLDER FOR UNSUP:  STL10_CIFAR100_CL
INSIDE EVALUATE UNSUP
INSIDE EVALUATE UNSUP RETURNED 0,0
Epoch: [1/1]	lr: 1.27e-01	time: 00:00:32	Acc_train 0.00	Acc_test 0.00	convergence: 2.40e+01	R1: 0	Info MB:0.000e+00/SB:0.000e+00/MW:4.443e-03/SW:4.742e-01/MR:3.861e+00/SR:1.405e+00/MeD:1.096e+00/MaD:2.968e+00/MW:0.616/MAW:0.384
|       0 |       1 |       2 |        3 |       4 |       5 |      6 |      7 |       8 |      9 |         10 |      11 |      12 |      13 |      14 |      15 |      16 |      17 |       18 |      19 |      20 |         21 |      22 |      23 |      24 |      25 |      26 |      27 |         28 |      29 |
|---------+---------+---------+----------+---------+---------+--------+--------+---------+--------+------------+---------+---------+---------+---------+---------+---------+---------+----------+---------+---------+------------+---------+---------+---------+---------+---------+---------+------------+---------|
|   0.101 |   0.105 |   0.126 |   0.0458 |   0.158 |   0.183 |   0.15 |   0.11 |   0.151 |   0.15 |   0.000672 |   0.153 |   0.188 |   0.118 |   0.094 |   0.123 |   8e-07 |   0.179 |   0.0926 |   0.143 |   0.149 |   0.000857 |   0.134 |   0.147 |   0.174 |   8e-07 |   0.163 |   0.085 |   0.000788 |   0.174 |
|   2.59  |   2.72  |   3.47  |   1.33   |   4.88  |   6.21  |   4.52 |   2.9  |   4.58  |   4.52 |   1        |   4.68  |   6.53  |   3.18  |   2.38  |   3.35  |   1     |   6.01  |   2.34   |   4.19  |   4.46  |   1        |   3.81  |   4.4   |   5.74  |   1     |   5.16  |   2.13  |   1        |   5.73  |
|   0.41  |   0.4   |   0.63  |   0.62   |   0.37  |   0.52  |   0.37 |   0.65 |   0.41  |   0.39 |   2.66     |   0.35  |   0.5   |   0.62  |   0.62  |   0.56  |  23.11  |   0.74  |   0.69   |   0.34  |   0.4   |   0.77     |   0.27  |   0.37  |   0.9   |  26.58  |   0.44  |   0.36  |   0.8      |   0.51  |
| nan     | nan     | nan     | nan      | nan     | nan     | nan    | nan    | nan     | nan    | nan        | nan     | nan     | nan     | nan     | nan     | nan     | nan     | nan      | nan     | nan     | nan        | nan     | nan     | nan     | nan     | nan     | nan     | nan        | nan     |
| nan     | nan     | nan     | nan      | nan     | nan     | nan    | nan    | nan     | nan    | nan        | nan     | nan     | nan     | nan     | nan     | nan     | nan     | nan      | nan     | nan     | nan        | nan     | nan     | nan     | nan     | nan     | nan     | nan        | nan     |
| nan     | nan     | nan     | nan      | nan     | nan     | nan    | nan    | nan     | nan    | nan        | nan     | nan     | nan     | nan     | nan     | nan     | nan     | nan      | nan     | nan     | nan        | nan     | nan     | nan     | nan     | nan     | nan     | nan        | nan     |

STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/STL10_CIFAR100_CL/models

 ********** Hebbian Unsupervised learning of blocks [1] **********
SEED:  0
BEFORE RESIZING
Files already downloaded and verified
AFTER RESIZING
Files already downloaded and verified
INDICES:  5000
IMAGE SIZE: torch.Size([32, 3, 96, 96])
SAVING FOLDER FOR UNSUP:  STL10_CIFAR100_CL
INSIDE EVALUATE UNSUP
INSIDE EVALUATE UNSUP RETURNED 0,0
Epoch: [1/1]	lr: 1.27e-01	time: 00:01:01	Acc_train 0.00	Acc_test 0.00	convergence: 2.40e+01	R1: 0	Info MB:0.000e+00/SB:0.000e+00/MW:1.516e-02/SW:9.088e-02/MR:2.368e+00/SR:1.316e+00/MeD:1.146e+00/MaD:3.325e+00/MW:0.561/MAW:0.439
|          0 |         1 |         2 |        3 |         4 |        5 |         6 |          7 |         8 |          9 |        10 |        11 |        12 |        13 |        14 |        15 |         16 |         17 |         18 |        19 |        20 |       21 |         22 |        23 |        24 |         25 |        26 |         27 |        28 |        29 |
|------------+-----------+-----------+----------+-----------+----------+-----------+------------+-----------+------------+-----------+-----------+-----------+-----------+-----------+-----------+------------+------------+------------+-----------+-----------+----------+------------+-----------+-----------+------------+-----------+------------+-----------+-----------|
|   0.000415 |   0.00934 |   0.00878 |   0.0102 |   0.00281 |   0.0043 |   0.00296 |   7.93e-05 |   0.00725 |   0.000238 |   0.00863 |   0.00644 |   0.00274 |   0.00218 |   0.00904 |   0.00586 |   0.000646 |   0.000803 |   6.67e-05 |   0.00753 |   0.00788 |   0.0025 |   0.000149 |   0.00569 |   0.00046 |   0.000931 |   0.00924 |   0.000376 |   0.00713 |   0.00139 |
|   1.01     |   4.49    |   4.08    |   5.2    |   1.32    |   1.74   |   1.35    |   1        |   3.1     |   1        |   3.98    |   2.66    |   1.3     |   1.19    |   4.27    |   2.37    |   1.02     |   1.03     |   1        |   3.27    |   3.48    |   1.25   |   1        |   2.3     |   1.01    |   1.03     |   4.42    |   1.01     |   3.03    |   1.08    |
|   0.43     |   0.24    |   0.63    |   0.14   |   0.06    |   0.04   |   0.04    |   2.11     |   0.06    |   0.93     |   0.36    |   0.04    |   0.05    |   0.05    |   0.32    |   0.05    |   0.11     |   0.22     |   0.07     |   0.11    |   0.03    |   0.12   |   0.14     |   0.06    |   0.22    |   0.1      |   0.6     |   0.34     |   0.05    |   0.16    |
| nan        | nan       | nan       | nan      | nan       | nan      | nan       | nan        | nan       | nan        | nan       | nan       | nan       | nan       | nan       | nan       | nan        | nan        | nan        | nan       | nan       | nan      | nan        | nan       | nan       | nan        | nan       | nan        | nan       | nan       |
| nan        | nan       | nan       | nan      | nan       | nan      | nan       | nan        | nan       | nan        | nan       | nan       | nan       | nan       | nan       | nan       | nan        | nan        | nan        | nan       | nan       | nan      | nan        | nan       | nan       | nan        | nan       | nan        | nan       | nan       |
| nan        | nan       | nan       | nan      | nan       | nan      | nan       | nan        | nan       | nan        | nan       | nan       | nan       | nan       | nan       | nan       | nan        | nan        | nan        | nan       | nan       | nan      | nan        | nan       | nan       | nan        | nan       | nan        | nan       | nan       |

STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/STL10_CIFAR100_CL/models

 ********** Hebbian Unsupervised learning of blocks [2] **********
SEED:  0
BEFORE RESIZING
Files already downloaded and verified
AFTER RESIZING
Files already downloaded and verified
INDICES:  5000
IMAGE SIZE: torch.Size([32, 3, 96, 96])
SAVING FOLDER FOR UNSUP:  STL10_CIFAR100_CL
INSIDE EVALUATE UNSUP
INSIDE EVALUATE UNSUP RETURNED 0,0
Epoch: [1/1]	lr: 4.90e-02	time: 00:01:31	Acc_train 0.00	Acc_test 0.00	convergence: 2.40e+01	R1: 0	Info MB:0.000e+00/SB:0.000e+00/MW:3.632e-03/SW:1.158e-01/MR:5.935e+00/SR:3.339e+00/MeD:2.901e+00/MaD:8.825e+00/MW:0.614/MAW:0.386
|       0 |        1 |        2 |        3 |        4 |        5 |        6 |        7 |        8 |        9 |       10 |        11 |       12 |       13 |       14 |       15 |       16 |       17 |         18 |      19 |       20 |       21 |         22 |      23 |       24 |       25 |      26 |      27 |       28 |        29 |
|---------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+-----------+----------+----------+----------+----------+----------+----------+------------+---------+----------+----------+------------+---------+----------+----------+---------+---------+----------+-----------|
|   0.029 |   0.0113 |   0.0258 |   0.0178 |   0.0113 |   0.0276 |   0.0318 |   0.0286 |   0.0246 |   0.0263 |   0.0321 |   0.00747 |   0.0159 |   0.0259 |   0.0172 |   0.0229 |   0.0274 |   0.0245 |   0.000404 |   0.029 |   0.0112 |   0.0267 |   0.000315 |   0.031 |   0.0238 |   0.0245 |   0.018 |   0.017 |   0.0279 |   0.00264 |
|   9.43  |   2.28   |   7.65   |   4.18   |   2.27   |   8.63   |  11.13   |   9.19   |   7.04   |   7.93   |  11.33   |   1.56    |   3.52   |   7.72   |   3.96   |   6.24   |   8.52   |   7.02   |   1        |   9.42  |   2.25   |   8.13   |   1        |  10.63  |   6.65   |   7.03   |   4.25  |   3.89  |   8.8    |   1.07    |
|   0.01  |   0.13   |   0.02   |   0      |   0      |   0.01   |   0.03   |   0.04   |   0.03   |   0.05   |   0.01   |   0       |   0      |   0.03   |   0      |   0.01   |   0.03   |   0.05   |   0.06     |   0.03  |   0      |   0      |   0.17     |   0.03  |   0.11   |   0.01   |   0     |   0     |   0.01   |   0.01    |
| nan     | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan       | nan      | nan      | nan      | nan      | nan      | nan      | nan        | nan     | nan      | nan      | nan        | nan     | nan      | nan      | nan     | nan     | nan      | nan       |
| nan     | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan       | nan      | nan      | nan      | nan      | nan      | nan      | nan        | nan     | nan      | nan      | nan        | nan     | nan      | nan      | nan     | nan     | nan      | nan       |
| nan     | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan       | nan      | nan      | nan      | nan      | nan      | nan      | nan        | nan     | nan      | nan      | nan        | nan     | nan      | nan      | nan     | nan     | nan      | nan       |

STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/STL10_CIFAR100_CL/models

 ********** Hebbian Unsupervised learning of blocks [3] **********
SEED:  0
BEFORE RESIZING
Files already downloaded and verified
AFTER RESIZING
Files already downloaded and verified
INDICES:  5000
IMAGE SIZE: torch.Size([32, 3, 96, 96])
SAVING FOLDER FOR UNSUP:  STL10_CIFAR100_CL
INSIDE EVALUATE UNSUP
INSIDE EVALUATE UNSUP RETURNED 0,0
Epoch: [1/1]	lr: 1.95e-02	time: 00:02:11	Acc_train 0.00	Acc_test 0.00	convergence: 1.18e+01	R1: 78	Info MB:0.000e+00/SB:0.000e+00/MW:5.357e-03/SW:1.161e-01/MR:1.281e+01/SR:4.756e+00/MeD:3.640e+00/MaD:1.181e+01/MW:0.535/MAW:0.465
|        0 |        1 |        2 |        3 |        4 |        5 |        6 |         7 |        8 |        9 |       10 |       11 |       12 |      13 |       14 |      15 |        16 |       17 |       18 |       19 |       20 |       21 |       22 |       23 |       24 |        25 |       26 |       27 |       28 |       29 |
|----------+----------+----------+----------+----------+----------+----------+-----------+----------+----------+----------+----------+----------+---------+----------+---------+-----------+----------+----------+----------+----------+----------+----------+----------+----------+-----------+----------+----------+----------+----------|
|   0.0426 |   0.0413 |   0.0325 |   0.0391 |   0.0369 |   0.0355 |   0.0418 |   0.00947 |   0.0409 |   0.0407 |   0.0358 |   0.0363 |   0.0373 |   0.033 |   0.0383 |   0.038 |   0.00644 |   0.0427 |   0.0345 |   0.0142 |   0.0363 |   0.0358 |   0.0311 |   0.0352 |   0.0356 |   0.00811 |   0.0159 |   0.0409 |   0.0349 |   0.0183 |
|  19.16   |  18.02   |  11.57   |  16.25   |  14.59   |  13.57   |  18.46   |   1.9     |  17.73   |  17.57   |  13.84   |  14.17   |  14.94   |  11.86  |  15.68   |  15.46  |   1.41    |  19.24   |  12.92   |   3.02   |  14.15   |  13.78   |  10.65   |  13.42   |  13.7    |   1.66    |   3.53   |  17.73   |  13.2    |   4.34   |
|   0.01   |   0.03   |   0.01   |   0.01   |   0.01   |   0.02   |   0.01   |   0.02    |   0.03   |   0      |   0.01   |   0.01   |   0.01   |   0.01  |   0.01   |   0.01  |   0.01    |   0.02   |   0.01   |   0      |   0.01   |   0.01   |   0      |   0      |   0.01   |   0.01    |   0      |   0      |   0      |   0      |
| nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan       | nan      | nan      | nan      | nan      | nan      | nan     | nan      | nan     | nan       | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan       | nan      | nan      | nan      | nan      |
| nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan       | nan      | nan      | nan      | nan      | nan      | nan     | nan      | nan     | nan       | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan       | nan      | nan      | nan      | nan      |
| nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan       | nan      | nan      | nan      | nan      | nan      | nan     | nan      | nan     | nan       | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan       | nan      | nan      | nan      | nan      |

STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/STL10_CIFAR100_CL/models
SEED:  0
BEFORE RESIZING
Files already downloaded and verified
AFTER RESIZING
Files already downloaded and verified
INDICES:  5000
IMAGE SIZE: torch.Size([64, 3, 96, 96])
Accuracy of the network on the 1st dataset: 63.225 %
Test loss on the 1st dataset: 1.926
CL:  True
{'name': 'CIFAR100', 'noise_std': 0, 'channels': 3, 'width': 32, 'height': 32, 'validation_split': 0.2, 'training_sample': 50000, 'testing_sample': 10000, 'out_channels': 100, 'num_workers': 0, 'seed': 0, 'shuffle': True, 'batch_size': 64, 'augmentation': False, 'zca_whitened': False, 'training_class': 'all', 'split': 'train', 'nb_epoch': 50, 'print_freq': 10, 'validation': False, 'continual_learning': True}
CL:  True
{'name': 'CIFAR100', 'noise_std': 0, 'channels': 3, 'width': 32, 'height': 32, 'validation_split': 0.2, 'training_sample': 50000, 'testing_sample': 10000, 'out_channels': 100, 'num_workers': 0, 'seed': 0, 'shuffle': True, 'batch_size': 10, 'augmentation': False, 'zca_whitened': False, 'training_class': 'all', 'split': 'train', 'nb_epoch': 1, 'print_freq': 50, 'validation': False, 'continual_learning': True}
SEED:  0
block 0, size : 96 16 16
range = 2.886751345948129
block 1, size : 384 8 8
range = 0.8505172717997146
block 2, size : 1536 4 4
range = 0.4252586358998573
block 3, size : 6144 2 2
range = 0.21262931794992865
range = 0.11048543456039805
The device used will be: 
True
cuda:0
CONFIG: {'arch': 'CNN', 'nb_train': None, 'lr': 0.08, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 1.0, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 2, 'weight_init': 'normal', 'weight_init_range': 2.886751345948129, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.5, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 96, 'kernel_size': 5, 'in_channels': 3, 'lr_scheduler': {'lr': 0.08, 'adaptive': True, 'nb_epochs': 1, 'ratio': 0.00032, 'speed': 7, 'div': 96, 'decay': 'linear', 'power_lr': 0.5}}
CONFIG: {'arch': 'CNN', 'nb_train': None, 'lr': 0.005, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 0.65, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 1, 'weight_init': 'normal', 'weight_init_range': 0.8505172717997146, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.5, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 384, 'kernel_size': 3, 'in_channels': 96, 'lr_scheduler': {'lr': 0.005, 'adaptive': True, 'nb_epochs': 1, 'ratio': 0.00032, 'speed': 7, 'div': 96, 'decay': 'linear', 'power_lr': 0.5}}
CONFIG: {'arch': 'CNN', 'nb_train': None, 'lr': 0.01, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 0.45, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 1, 'weight_init': 'normal', 'weight_init_range': 0.4252586358998573, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.5, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 1536, 'kernel_size': 3, 'in_channels': 384, 'lr_scheduler': {'lr': 0.01, 'adaptive': True, 'nb_epochs': 1, 'ratio': 0.00032, 'speed': 7, 'div': 96, 'decay': 'linear', 'power_lr': 0.5}}
CONFIG: {'arch': 'CNN', 'nb_train': None, 'lr': 0.01, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 0.25, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 1, 'weight_init': 'normal', 'weight_init_range': 0.21262931794992865, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.5, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 6144, 'kernel_size': 3, 'in_channels': 1536, 'lr_scheduler': {'lr': 0.01, 'adaptive': True, 'nb_epochs': 1, 'ratio': 0.00032, 'speed': 7, 'div': 96, 'decay': 'linear', 'power_lr': 0.5}}
CONFIG: {'arch': 'MLP', 'lr': 0.05, 'adaptive': True, 'lr_sup': 0.001, 'speed': 0.4, 'lr_div': 100, 'lebesgue_p': 2, 't_invert': 10, 'beta': 0.01, 'power': 4.5, 'ranking_param': 3, 'delta': 0.1, 'hebbian': False, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'lr_bias': 600, 'softness': 'soft', 'soft_activation_fn': 'exp', 'plasticity': 'SoftHebb', 'metric_mode': 'unsupervised', 'weight_init': 'positive', 'weight_init_range': 0.036828478186799345, 'weight_init_offset': 0, 'weight_decay': 0, 'radius': 10, 'power_lr': 0.2, 'out_channels': 10, 'in_channels': 221184, 'old_channels': 6144, 'lr_scheduler': {'decay': 'cste', 'lr': 0.1}}

 Model STL10_CIFAR100_CL loaded successfuly with best perf



 ----- Architecture Block BatchNorm2dSK3962(5, 5)1.0reflect, number 0 -----
- BatchNorm2d(3, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
- HebbSoftKrotovConv2d(3, 96, lebesgue_p=2, pruning=0, kernel_size=(5, 5), bias=False, padding_mode=reflect, t_invert=1.0, bias=False, lr_bias=0.1, ranking_param=3, delta=2, activation=exp)
- Triangle(power=0.7)
- AvgPool2d(kernel_size=4, stride=2, padding=1)

 ----- Architecture Block BatchNorm2dSK963842(3, 3)0.6499999761581421reflect, number 1 -----
- BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
- HebbSoftKrotovConv2d(96, 384, lebesgue_p=2, pruning=0, kernel_size=(3, 3), bias=False, padding_mode=reflect, t_invert=0.6499999761581421, bias=False, lr_bias=0.1538, ranking_param=3, delta=2, activation=exp)
- Triangle(power=0.7)
- MaxPool2d(kernel_size=4, stride=2, padding=1, dilation=1, ceil_mode=False)

 ----- Architecture Block BatchNorm2dSK38415362(3, 3)0.44999998807907104reflect, number 2 -----
- BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
- HebbSoftKrotovConv2d(384, 1536, lebesgue_p=2, pruning=0, kernel_size=(3, 3), bias=False, padding_mode=reflect, t_invert=0.44999998807907104, bias=False, lr_bias=0.2222, ranking_param=3, delta=2, activation=exp)
- Triangle(power=1.4)
- AvgPool2d(kernel_size=4, stride=2, padding=1)

 ----- Architecture Block BatchNorm2dSK153661442(3, 3)0.25reflect, number 3 -----
- BatchNorm2d(1536, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
- HebbSoftKrotovConv2d(1536, 6144, lebesgue_p=2, pruning=0, kernel_size=(3, 3), bias=False, padding_mode=reflect, t_invert=0.25, bias=False, lr_bias=0.4, ranking_param=3, delta=2, activation=exp)
- Triangle(power=1)
- AvgPool2d(kernel_size=2, stride=2, padding=0)

 ----- Architecture Block FlattenDropout(p=0.5, inplace=False)Linear(in_, number 4 -----
- Flatten(start_dim=1, end_dim=-1)
- Dropout(p=0.5, inplace=False)
- Linear(in_features=221184, out_features=10, bias=True)

 ********** Hebbian Unsupervised learning of blocks [0] **********
SEED:  0
BEFORE RESIZING
Files already downloaded and verified
AFTER RESIZING
Files already downloaded and verified
INDICES:  50000
IMAGE SIZE: torch.Size([10, 3, 96, 96])
SAVING FOLDER FOR UNSUP:  STL10_CIFAR100_CL
INSIDE EVALUATE UNSUP
INSIDE EVALUATE UNSUP RETURNED 0,0
Epoch: [1/1]	lr: 2.35e-01	time: 00:03:01	Acc_train 0.00	Acc_test 0.00	convergence: 2.40e+01	R1: 0	Info MB:0.000e+00/SB:0.000e+00/MW:5.235e-03/SW:1.880e+00/MR:1.240e+01/SR:1.061e+01/MeD:8.488e+00/MaD:3.424e+01/MW:0.659/MAW:0.341
|       0 |       1 |       2 |        3 |       4 |      5 |      6 |       7 |       8 |       9 |         10 |      11 |      12 |      13 |      14 |      15 |         16 |      17 |      18 |      19 |      20 |        21 |     22 |      23 |     24 |         25 |     26 |       27 |        28 |      29 |
|---------+---------+---------+----------+---------+--------+--------+---------+---------+---------+------------+---------+---------+---------+---------+---------+------------+---------+---------+---------+---------+-----------+--------+---------+--------+------------+--------+----------+-----------+---------|
|   0.143 |   0.251 |   0.225 |   0.0494 |   0.161 |   0.39 |   0.33 |   0.284 |   0.341 |   0.257 |   0.000613 |   0.139 |   0.465 |   0.266 |   0.238 |   0.239 |   0.000257 |   0.428 |   0.232 |   0.135 |   0.412 |   0.00179 |   0.23 |   0.143 |   0.54 |   0.000219 |   0.14 |   0.0718 |   0.00177 |   0.389 |
|   4.19  |  10.81  |   8.88  |   1.38   |   5.03  |  24.82 |  17.97 |  13.59  |  19.21  |  11.3   |   1        |   4.04  |  34.82  |  12.09  |   9.86  |   9.96  |   1        |  29.64  |   9.42  |   3.85  |  27.57  |   1       |   9.24 |   4.19  |  46.64 |   1        |   4.06 |   1.81   |   1       |  24.61  |
|   0.28  |   0.37  |   0.28  |   0.28   |   0.28  |   0.38 |   0.42 |   0.42  |   0.38  |   0.28  |   5.02     |   0.28  |   0.34  |   0.44  |   0.41  |   0.43  |  25.24     |   0.46  |   0.43  |   0.28  |   0.46  |   0.6     |   0.48 |   0.28  |   0.38 |  30.79     |   0.28 |   0.5    |   0.63    |   0.42  |
| nan     | nan     | nan     | nan      | nan     | nan    | nan    | nan     | nan     | nan     | nan        | nan     | nan     | nan     | nan     | nan     | nan        | nan     | nan     | nan     | nan     | nan       | nan    | nan     | nan    | nan        | nan    | nan      | nan       | nan     |
| nan     | nan     | nan     | nan      | nan     | nan    | nan    | nan     | nan     | nan     | nan        | nan     | nan     | nan     | nan     | nan     | nan        | nan     | nan     | nan     | nan     | nan       | nan    | nan     | nan    | nan        | nan    | nan      | nan       | nan     |
| nan     | nan     | nan     | nan      | nan     | nan    | nan    | nan     | nan     | nan     | nan        | nan     | nan     | nan     | nan     | nan     | nan        | nan     | nan     | nan     | nan     | nan       | nan    | nan     | nan    | nan        | nan    | nan      | nan       | nan     |

STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/STL10_CIFAR100_CL/models

 ********** Hebbian Unsupervised learning of blocks [1] **********
SEED:  0
BEFORE RESIZING
Files already downloaded and verified
AFTER RESIZING
Files already downloaded and verified
INDICES:  50000
IMAGE SIZE: torch.Size([10, 3, 96, 96])
SAVING FOLDER FOR UNSUP:  STL10_CIFAR100_CL
INSIDE EVALUATE UNSUP
INSIDE EVALUATE UNSUP RETURNED 0,0
Epoch: [1/1]	lr: 2.35e-01	time: 00:06:02	Acc_train 0.00	Acc_test 0.00	convergence: 2.40e+01	R1: 0	Info MB:0.000e+00/SB:0.000e+00/MW:1.662e-02/SW:9.910e-02/MR:2.429e+00/SR:1.682e+00/MeD:1.373e+00/MaD:7.326e+00/MW:0.706/MAW:0.294
|          0 |        1 |         2 |          3 |         4 |         5 |       6 |          7 |        8 |          9 |        10 |        11 |        12 |        13 |       14 |       15 |         16 |         17 |      18 |        19 |        20 |        21 |        22 |        23 |         24 |         25 |        26 |         27 |       28 |       29 |
|------------+----------+-----------+------------+-----------+-----------+---------+------------+----------+------------+-----------+-----------+-----------+-----------+----------+----------+------------+------------+---------+-----------+-----------+-----------+-----------+-----------+------------+------------+-----------+------------+----------+----------|
|   0.000455 |   0.0113 |   0.00545 |   1.99e-05 |   0.00309 |   0.00179 |   0.003 |   8.87e-05 |   0.0088 |   0.000261 |   0.00739 |   0.00671 |   0.00285 |   0.00237 |   0.0106 |   0.0064 |   0.000519 |   0.000821 |   7e-05 |   0.00886 |   0.00202 |   0.00247 |   9.8e-05 |   0.00638 |   0.000483 |   0.000273 |   0.00988 |   0.000406 |   0.0085 |   0.0014 |
|   1.01     |   6.09   |   2.19    |   1        |   1.38    |   1.13    |   1.36  |   1        |   4.1    |   1        |   3.18    |   2.8     |   1.32    |   1.22    |   5.5    |   2.64   |   1.01     |   1.03     |   1     |   4.14    |   1.16    |   1.24    |   1       |   2.63    |   1.01     |   1        |   4.9     |   1.01     |   3.89   |   1.08   |
|   0.09     |   0.09   |   0.12    |   4.45     |   0.03    |   0.09    |   0.02  |   0.39     |   0.03   |   0.08     |   0.06    |   0.02    |   0.02    |   0.02    |   0.08   |   0.02   |   0.19     |   0.03     |   0.15  |   0.02    |   0.08    |   0.02    |   0.73    |   0.02    |   0.05     |   0.35     |   0.05    |   0.06     |   0.06   |   0.02   |
| nan        | nan      | nan       | nan        | nan       | nan       | nan     | nan        | nan      | nan        | nan       | nan       | nan       | nan       | nan      | nan      | nan        | nan        | nan     | nan       | nan       | nan       | nan       | nan       | nan        | nan        | nan       | nan        | nan      | nan      |
| nan        | nan      | nan       | nan        | nan       | nan       | nan     | nan        | nan      | nan        | nan       | nan       | nan       | nan       | nan      | nan      | nan        | nan        | nan     | nan       | nan       | nan       | nan       | nan       | nan        | nan        | nan       | nan        | nan      | nan      |
| nan        | nan      | nan       | nan        | nan       | nan       | nan     | nan        | nan      | nan        | nan       | nan       | nan       | nan       | nan      | nan      | nan        | nan        | nan     | nan       | nan       | nan       | nan       | nan       | nan        | nan        | nan       | nan        | nan      | nan      |

STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/STL10_CIFAR100_CL/models

 ********** Hebbian Unsupervised learning of blocks [2] **********
SEED:  0
BEFORE RESIZING
Files already downloaded and verified
AFTER RESIZING
Files already downloaded and verified
INDICES:  50000
IMAGE SIZE: torch.Size([10, 3, 96, 96])
SAVING FOLDER FOR UNSUP:  STL10_CIFAR100_CL
INSIDE EVALUATE UNSUP
INSIDE EVALUATE UNSUP RETURNED 0,0
Epoch: [1/1]	lr: 4.90e-02	time: 00:09:20	Acc_train 0.00	Acc_test 0.00	convergence: 2.40e+01	R1: 0	Info MB:0.000e+00/SB:0.000e+00/MW:3.720e-03/SW:1.196e-01/MR:5.979e+00/SR:3.705e+00/MeD:3.247e+00/MaD:1.061e+01/MW:0.702/MAW:0.298
|        0 |        1 |        2 |        3 |        4 |        5 |        6 |        7 |         8 |        9 |       10 |        11 |       12 |       13 |       14 |       15 |       16 |      17 |         18 |      19 |       20 |       21 |         22 |       23 |       24 |       25 |       26 |       27 |       28 |        29 |
|----------+----------+----------+----------+----------+----------+----------+----------+-----------+----------+----------+-----------+----------+----------+----------+----------+----------+---------+------------+---------+----------+----------+------------+----------+----------+----------+----------+----------+----------+-----------|
|   0.0288 |   0.0149 |   0.0262 |   0.0188 |   0.0113 |   0.0163 |   0.0279 |   0.0287 |   0.00014 |   0.0281 |   0.0277 |   0.00773 |   0.0164 |   0.0229 |   0.0178 |   0.0323 |   0.0265 |   0.027 |   0.000411 |   0.026 |   0.0115 |   0.0302 |   0.000328 |   0.0283 |   0.0336 |   0.0262 |   0.0189 |   0.0177 |   0.0262 |   0.00277 |
|   9.3    |   3.21   |   7.86   |   4.54   |   2.29   |   3.65   |   8.79   |   9.24   |   1       |   8.89   |   8.66   |   1.6     |   3.69   |   6.24   |   4.16   |  11.46   |   8.03   |   8.28  |   1        |   7.76  |   2.32   |  10.11   |   1        |   9      |  12.3    |   7.88   |   4.57   |   4.12   |   7.85   |   1.08    |
|   0.02   |   0      |   0.01   |   0      |   0      |   0.02   |   0.02   |   0.02   |   0.47    |   0.02   |   0.03   |   0       |   0      |   0.01   |   0      |   0      |   0.02   |   0.02  |   0.01     |   0.02  |   0      |   0.02   |   0.02     |   0.02   |   0.02   |   0.02   |   0      |   0      |   0.02   |   0       |
| nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan       | nan      | nan      | nan       | nan      | nan      | nan      | nan      | nan      | nan     | nan        | nan     | nan      | nan      | nan        | nan      | nan      | nan      | nan      | nan      | nan      | nan       |
| nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan       | nan      | nan      | nan       | nan      | nan      | nan      | nan      | nan      | nan     | nan        | nan     | nan      | nan      | nan        | nan      | nan      | nan      | nan      | nan      | nan      | nan       |
| nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan       | nan      | nan      | nan       | nan      | nan      | nan      | nan      | nan      | nan     | nan        | nan     | nan      | nan      | nan        | nan      | nan      | nan      | nan      | nan      | nan      | nan       |

STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/STL10_CIFAR100_CL/models

 ********** Hebbian Unsupervised learning of blocks [3] **********
SEED:  0
BEFORE RESIZING
Files already downloaded and verified
AFTER RESIZING
Files already downloaded and verified
INDICES:  50000
IMAGE SIZE: torch.Size([10, 3, 96, 96])
SAVING FOLDER FOR UNSUP:  STL10_CIFAR100_CL
INSIDE EVALUATE UNSUP
INSIDE EVALUATE UNSUP RETURNED 0,0
Epoch: [1/1]	lr: 1.92e-02	time: 00:15:00	Acc_train 0.00	Acc_test 0.00	convergence: 1.08e+01	R1: 120	Info MB:0.000e+00/SB:0.000e+00/MW:5.905e-03/SW:1.088e-01/MR:1.180e+01/SR:4.966e+00/MeD:3.940e+00/MaD:1.302e+01/MW:0.622/MAW:0.378
|        0 |        1 |       2 |        3 |        4 |        5 |        6 |         7 |        8 |        9 |       10 |       11 |       12 |      13 |       14 |       15 |        16 |       17 |       18 |       19 |       20 |       21 |       22 |       23 |       24 |        25 |      26 |       27 |      28 |       29 |
|----------+----------+---------+----------+----------+----------+----------+-----------+----------+----------+----------+----------+----------+---------+----------+----------+-----------+----------+----------+----------+----------+----------+----------+----------+----------+-----------+---------+----------+---------+----------|
|   0.0381 |   0.0336 |   0.039 |   0.0356 |   0.0356 |   0.0345 |   0.0425 |   0.00954 |   0.0394 |   0.0373 |   0.0378 |   0.0367 |   0.0356 |   0.014 |   0.0363 |   0.0316 |   0.00692 |   0.0391 |   0.0314 |   0.0142 |   0.0343 |   0.0339 |   0.0339 |   0.0405 |   0.0384 |   0.00369 |   0.016 |   0.0276 |   0.031 |   0.0126 |
|  15.55   |  12.27   |  16.2   |  13.67   |  13.69   |  12.89   |  19.09   |   1.91    |  16.55   |  14.95   |  15.3    |  14.47   |  13.65   |   2.95  |  14.16   |  10.98   |   1.48    |  16.27   |  10.83   |   3.03   |  12.76   |  12.47   |  12.46   |  17.36   |  15.78   |   1.14    |   3.55  |   8.6    |  10.63  |   2.58   |
|   0.01   |   0.01   |   0     |   0.01   |   0.01   |   0.01   |   0.01   |   0       |   0.01   |   0.01   |   0      |   0.01   |   0.01   |   0.01  |   0.01   |   0.01   |   0       |   0.01   |   0      |   0      |   0.01   |   0.01   |   0      |   0.01   |   0.01   |   0.04    |   0     |   0.01   |   0     |   0.01   |
| nan      | nan      | nan     | nan      | nan      | nan      | nan      | nan       | nan      | nan      | nan      | nan      | nan      | nan     | nan      | nan      | nan       | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan       | nan     | nan      | nan     | nan      |
| nan      | nan      | nan     | nan      | nan      | nan      | nan      | nan       | nan      | nan      | nan      | nan      | nan      | nan     | nan      | nan      | nan       | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan       | nan     | nan      | nan     | nan      |
| nan      | nan      | nan     | nan      | nan      | nan      | nan      | nan       | nan      | nan      | nan      | nan      | nan      | nan     | nan      | nan      | nan       | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan       | nan     | nan      | nan     | nan      |

STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/STL10_CIFAR100_CL/models

 ********** Supervised learning of blocks [4] **********
SAVING FOLDER FOR SUP:  STL10_CIFAR100_CL
SEED:  0
BEFORE RESIZING
Files already downloaded and verified
AFTER RESIZING
Files already downloaded and verified
INDICES:  50000
IMAGE SIZE: torch.Size([64, 3, 96, 96])

