BLOCKS:  {'b0': {'arch': 'CNN', 'preset': 'softkrotov-c96-k5-p2-s1-d1-b0-t1-lr0.08-lp0.5-e0', 'operation': 'batchnorm2d', 'num': 0, 'batch_norm': False, 'pool': {'type': 'avg', 'kernel_size': 4, 'stride': 2, 'padding': 1}, 'activation': {'function': 'triangle', 'param': 0.7}, 'resume': None, 'layer': {'arch': 'CNN', 'nb_train': None, 'lr': 0.08, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 1.0, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 2, 'weight_init': 'positive', 'weight_init_range': 2, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.5, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 96, 'kernel_size': 5}}, 'b1': {'arch': 'CNN', 'preset': 'softkrotov-c384-k3-p1-s1-d1-b0-t0.65-lr0.005-lp0.5-e0', 'operation': 'batchnorm2d', 'num': 1, 'batch_norm': False, 'pool': {'type': 'max', 'kernel_size': 4, 'stride': 2, 'padding': 1}, 'activation': {'function': 'triangle', 'param': 0.7}, 'resume': None, 'layer': {'arch': 'CNN', 'nb_train': None, 'lr': 0.005, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 0.65, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 1, 'weight_init': 'positive', 'weight_init_range': 2, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.5, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 384, 'kernel_size': 3}}, 'b2': {'arch': 'CNN', 'preset': 'softkrotov-c1536-k3-p1-s1-d1-b0-t0.45-lr0.01-lp0.5-e0', 'operation': 'batchnorm2d', 'num': 2, 'batch_norm': False, 'pool': {'type': 'avg', 'kernel_size': 4, 'stride': 2, 'padding': 1}, 'activation': {'function': 'triangle', 'param': 1.4}, 'resume': None, 'layer': {'arch': 'CNN', 'nb_train': None, 'lr': 0.01, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 0.45, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 1, 'weight_init': 'positive', 'weight_init_range': 2, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.5, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 1536, 'kernel_size': 3}}, 'b3': {'arch': 'CNN', 'preset': 'softkrotov-c6144-k3-p1-s1-d1-b0-t0.25-lr0.01-lp0.5-e0', 'operation': 'batchnorm2d', 'num': 3, 'batch_norm': False, 'pool': {'type': 'avg', 'kernel_size': 2, 'stride': 2, 'padding': 0}, 'activation': {'function': 'triangle', 'param': 1}, 'resume': None, 'layer': {'arch': 'CNN', 'nb_train': None, 'lr': 0.01, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 0.25, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 1, 'weight_init': 'positive', 'weight_init_range': 2, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.5, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 6144, 'kernel_size': 3}}, 'b4': {'arch': 'MLP', 'preset': 'BP-c10', 'operation': 'flatten', 'num': 4, 'att_dropout': None, 'dropout': 0.5, 'layer': {'arch': 'MLP', 'lr': 0.05, 'adaptive': True, 'lr_sup': 0.001, 'speed': 0.4, 'lr_div': 100, 'lebesgue_p': 2, 't_invert': 10, 'beta': 0.01, 'power': 4.5, 'ranking_param': 3, 'delta': 0.1, 'hebbian': False, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'lr_bias': 600, 'softness': 'soft', 'soft_activation_fn': 'exp', 'plasticity': 'SoftHebb', 'metric_mode': 'unsupervised', 'weight_init': 'positive', 'weight_init_range': 0.25, 'weight_init_offset': 0, 'weight_decay': 0, 'radius': 10, 'power_lr': 0.2, 'out_channels': 10}, 'pool': None, 'activation': None}}
CL:  True
{'name': 'STL10', 'noise_std': 0, 'channels': 3, 'width': 96, 'height': 96, 'validation_split': 0.2, 'training_sample': 5000, 'testing_sample': 10000, 'out_channels': 10, 'num_workers': 0, 'seed': 0, 'shuffle': True, 'batch_size': 64, 'augmentation': True, 'zca_whitened': False, 'training_class': 'all', 'split': 'train', 'nb_epoch': 100, 'print_freq': 10, 'validation': False, 'continual_learning': True}
CL:  False
{'name': 'STL10', 'noise_std': 0, 'channels': 3, 'width': 96, 'height': 96, 'validation_split': 0.2, 'training_sample': 5000, 'testing_sample': 10000, 'out_channels': 10, 'num_workers': 0, 'seed': 0, 'shuffle': True, 'batch_size': 64, 'augmentation': True, 'zca_whitened': False, 'training_class': 'all', 'split': 'train', 'nb_epoch': 100, 'print_freq': 10, 'validation': False, 'continual_learning': False}
CL:  False
{'name': 'STL10', 'noise_std': 0, 'channels': 3, 'width': 96, 'height': 96, 'validation_split': 0.2, 'training_sample': 100000, 'testing_sample': 10000, 'out_channels': 10, 'num_workers': 0, 'seed': 0, 'shuffle': True, 'batch_size': 32, 'augmentation': False, 'zca_whitened': False, 'training_class': 'all', 'split': 'unlabeled', 'nb_epoch': 1, 'print_freq': 25, 'validation': False, 'continual_learning': False}
SEED:  0
block 0, size : 96 48 48
range = 2.886751345948129
block 1, size : 384 24 24
range = 0.8505172717997146
block 2, size : 1536 12 12
range = 0.4252586358998573
block 3, size : 6144 6 6
range = 0.21262931794992865
range = 0.036828478186799345
The device used will be: 
True
cuda:0
CONFIG: {'arch': 'CNN', 'nb_train': None, 'lr': 0.08, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 1.0, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 2, 'weight_init': 'normal', 'weight_init_range': 2.886751345948129, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.5, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 96, 'kernel_size': 5, 'in_channels': 3, 'lr_scheduler': {'lr': 0.08, 'adaptive': True, 'nb_epochs': 1, 'ratio': 0.00032, 'speed': 7, 'div': 96, 'decay': 'linear', 'power_lr': 0.5}}
CONFIG: {'arch': 'CNN', 'nb_train': None, 'lr': 0.005, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 0.65, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 1, 'weight_init': 'normal', 'weight_init_range': 0.8505172717997146, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.5, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 384, 'kernel_size': 3, 'in_channels': 96, 'lr_scheduler': {'lr': 0.005, 'adaptive': True, 'nb_epochs': 1, 'ratio': 0.00032, 'speed': 7, 'div': 96, 'decay': 'linear', 'power_lr': 0.5}}
CONFIG: {'arch': 'CNN', 'nb_train': None, 'lr': 0.01, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 0.45, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 1, 'weight_init': 'normal', 'weight_init_range': 0.4252586358998573, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.5, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 1536, 'kernel_size': 3, 'in_channels': 384, 'lr_scheduler': {'lr': 0.01, 'adaptive': True, 'nb_epochs': 1, 'ratio': 0.00032, 'speed': 7, 'div': 96, 'decay': 'linear', 'power_lr': 0.5}}
CONFIG: {'arch': 'CNN', 'nb_train': None, 'lr': 0.01, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 0.25, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 1, 'weight_init': 'normal', 'weight_init_range': 0.21262931794992865, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.5, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 6144, 'kernel_size': 3, 'in_channels': 1536, 'lr_scheduler': {'lr': 0.01, 'adaptive': True, 'nb_epochs': 1, 'ratio': 0.00032, 'speed': 7, 'div': 96, 'decay': 'linear', 'power_lr': 0.5}}
CONFIG: {'arch': 'MLP', 'lr': 0.05, 'adaptive': True, 'lr_sup': 0.001, 'speed': 0.4, 'lr_div': 100, 'lebesgue_p': 2, 't_invert': 10, 'beta': 0.01, 'power': 4.5, 'ranking_param': 3, 'delta': 0.1, 'hebbian': False, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'lr_bias': 600, 'softness': 'soft', 'soft_activation_fn': 'exp', 'plasticity': 'SoftHebb', 'metric_mode': 'unsupervised', 'weight_init': 'positive', 'weight_init_range': 0.036828478186799345, 'weight_init_offset': 0, 'weight_decay': 0, 'radius': 10, 'power_lr': 0.2, 'out_channels': 10, 'in_channels': 221184, 'old_channels': 6144, 'lr_scheduler': {'decay': 'cste', 'lr': 0.1}}

 Model STL10_ImageNette_CL loaded successfuly with best perf



 ----- Architecture Block BatchNorm2dSK3962(5, 5)1.0reflect, number 0 -----
- BatchNorm2d(3, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
- HebbSoftKrotovConv2d(3, 96, lebesgue_p=2, pruning=0, kernel_size=(5, 5), bias=False, padding_mode=reflect, t_invert=1.0, bias=False, lr_bias=0.1, ranking_param=3, delta=2, activation=exp)
- Triangle(power=0.7)
- AvgPool2d(kernel_size=4, stride=2, padding=1)

 ----- Architecture Block BatchNorm2dSK963842(3, 3)0.6499999761581421reflect, number 1 -----
- BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
- HebbSoftKrotovConv2d(96, 384, lebesgue_p=2, pruning=0, kernel_size=(3, 3), bias=False, padding_mode=reflect, t_invert=0.6499999761581421, bias=False, lr_bias=0.1538, ranking_param=3, delta=2, activation=exp)
- Triangle(power=0.7)
- MaxPool2d(kernel_size=4, stride=2, padding=1, dilation=1, ceil_mode=False)

 ----- Architecture Block BatchNorm2dSK38415362(3, 3)0.44999998807907104reflect, number 2 -----
- BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
- HebbSoftKrotovConv2d(384, 1536, lebesgue_p=2, pruning=0, kernel_size=(3, 3), bias=False, padding_mode=reflect, t_invert=0.44999998807907104, bias=False, lr_bias=0.2222, ranking_param=3, delta=2, activation=exp)
- Triangle(power=1.4)
- AvgPool2d(kernel_size=4, stride=2, padding=1)

 ----- Architecture Block BatchNorm2dSK153661442(3, 3)0.25reflect, number 3 -----
- BatchNorm2d(1536, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
- HebbSoftKrotovConv2d(1536, 6144, lebesgue_p=2, pruning=0, kernel_size=(3, 3), bias=False, padding_mode=reflect, t_invert=0.25, bias=False, lr_bias=0.4, ranking_param=3, delta=2, activation=exp)
- Triangle(power=1)
- AvgPool2d(kernel_size=2, stride=2, padding=0)

 ----- Architecture Block FlattenDropout(p=0.5, inplace=False)Linear(in_, number 4 -----
- Flatten(start_dim=1, end_dim=-1)
- Dropout(p=0.5, inplace=False)
- Linear(in_features=221184, out_features=10, bias=True)

 ********** Hebbian Unsupervised learning of blocks [0] **********
SEED:  0
BEFORE RESIZING
Files already downloaded and verified
AFTER RESIZING
Files already downloaded and verified
INDICES:  5000
IMAGE SIZE: torch.Size([32, 3, 96, 96])
SAVING FOLDER FOR UNSUP:  STL10_ImageNette_CL
INSIDE EVALUATE UNSUP
INSIDE EVALUATE UNSUP RETURNED 0,0
Epoch: [1/1]	lr: 1.23e-01	time: 00:00:34	Acc_train 0.00	Acc_test 0.00	convergence: 2.40e+01	R1: 0	Info MB:0.000e+00/SB:0.000e+00/MW:3.878e-03/SW:4.535e-01/MR:3.683e+00/SR:1.372e+00/MeD:1.038e+00/MaD:3.301e+00/MW:0.617/MAW:0.383
|        0 |        1 |       2 |      3 |       4 |       5 |      6 |       7 |       8 |       9 |        10 |      11 |      12 |      13 |      14 |      15 |         16 |      17 |      18 |      19 |      20 |        21 |       22 |      23 |      24 |         25 |      26 |       27 |        28 |      29 |
|----------+----------+---------+--------+---------+---------+--------+---------+---------+---------+-----------+---------+---------+---------+---------+---------+------------+---------+---------+---------+---------+-----------+----------+---------+---------+------------+---------+----------+-----------+---------|
|   0.0963 |   0.0869 |   0.138 |   0.18 |   0.149 |   0.196 |   0.14 |   0.121 |   0.147 |   0.141 |   0.00132 |   0.144 |   0.187 |   0.119 |   0.107 |   0.115 |   9.16e-05 |   0.175 |   0.106 |   0.137 |   0.141 |   0.00174 |   0.0565 |   0.137 |   0.172 |   7.81e-05 |   0.156 |   0.0801 |   0.00244 |   0.172 |
|   2.45   |   2.18   |   3.98  |   6.05 |   4.48  |   6.98  |   4.08 |   3.29  |   4.38  |   4.12  |   1       |   4.23  |   6.46  |   3.2   |   2.78  |   3.08  |   1        |   5.81  |   2.76  |   3.94  |   4.12  |   1       |   1.5    |   3.91  |   5.61  |   1        |   4.82  |   2      |   1       |   5.64  |
|   0.37   |   0.42   |   0.36  |   0.41 |   0.45  |   0.37  |   0.32 |   0.41  |   0.33  |   0.48  |   3.36    |   0.45  |   0.34  |   0.45  |   0.44  |   0.44  |  24.79     |   0.43  |   0.42  |   0.43  |   0.47  |   1.07    |   0.43   |   0.46  |   0.46  |  27.83     |   0.32  |   0.51   |   1.09    |   0.37  |
| nan      | nan      | nan     | nan    | nan     | nan     | nan    | nan     | nan     | nan     | nan       | nan     | nan     | nan     | nan     | nan     | nan        | nan     | nan     | nan     | nan     | nan       | nan      | nan     | nan     | nan        | nan     | nan      | nan       | nan     |
| nan      | nan      | nan     | nan    | nan     | nan     | nan    | nan     | nan     | nan     | nan       | nan     | nan     | nan     | nan     | nan     | nan        | nan     | nan     | nan     | nan     | nan       | nan      | nan     | nan     | nan        | nan     | nan      | nan       | nan     |
| nan      | nan      | nan     | nan    | nan     | nan     | nan    | nan     | nan     | nan     | nan       | nan     | nan     | nan     | nan     | nan     | nan        | nan     | nan     | nan     | nan     | nan       | nan      | nan     | nan     | nan        | nan     | nan      | nan       | nan     |

STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/STL10_ImageNette_CL/models

 ********** Hebbian Unsupervised learning of blocks [1] **********
SEED:  0
BEFORE RESIZING
Files already downloaded and verified
AFTER RESIZING
Files already downloaded and verified
INDICES:  5000
IMAGE SIZE: torch.Size([32, 3, 96, 96])
SAVING FOLDER FOR UNSUP:  STL10_ImageNette_CL
INSIDE EVALUATE UNSUP
INSIDE EVALUATE UNSUP RETURNED 0,0
Epoch: [1/1]	lr: 1.23e-01	time: 00:01:04	Acc_train 0.00	Acc_test 0.00	convergence: 2.40e+01	R1: 0	Info MB:0.000e+00/SB:0.000e+00/MW:9.494e-03/SW:9.167e-02/MR:2.396e+00/SR:1.265e+00/MeD:1.052e+00/MaD:5.124e+00/MW:0.609/MAW:0.391
|          0 |         1 |        2 |         3 |         4 |         5 |         6 |          7 |         8 |        9 |        10 |        11 |        12 |        13 |        14 |        15 |        16 |         17 |       18 |       19 |        20 |        21 |        22 |        23 |         24 |        25 |        26 |         27 |        28 |        29 |
|------------+-----------+----------+-----------+-----------+-----------+-----------+------------+-----------+----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+------------+----------+----------+-----------+-----------+-----------+-----------+------------+-----------+-----------+------------+-----------+-----------|
|   0.000372 |   0.00804 |   0.0076 |   0.00971 |   0.00237 |   0.00933 |   0.00261 |   8.36e-05 |   0.00599 |   0.0002 |   0.00702 |   0.00611 |   0.00218 |   0.00172 |   0.00648 |   0.00495 |   0.00111 |   0.000741 |   0.0104 |   0.0063 |   0.00758 |   0.00237 |   0.00848 |   0.00399 |   0.000425 |   0.00588 |   0.00994 |   0.000336 |   0.00474 |   0.00129 |
|   1.01     |   3.59    |   3.31   |   4.77    |   1.23    |   4.49    |   1.27    |   1        |   2.43    |   1      |   2.97    |   2.49    |   1.19    |   1.12    |   2.68    |   1.98    |   1.05    |   1.02     |   5.32   |   2.59   |   3.3     |   1.23    |   3.88    |   1.64    |   1.01     |   2.38    |   4.95    |   1        |   1.9     |   1.07    |
|   0.49     |   0.07    |   0.09   |   0.08    |   0.15    |   0.07    |   0.18    |   2.02     |   0.06    |   1.21   |   0.08    |   0.05    |   0.17    |   0.15    |   0.08    |   0.09    |   0.17    |   0.45     |   0.1    |   0.08   |   0.07    |   0.19    |   0.11    |   0.1     |   0.34     |   0.09    |   0.11    |   0.51     |   0.08    |   0.25    |
| nan        | nan       | nan      | nan       | nan       | nan       | nan       | nan        | nan       | nan      | nan       | nan       | nan       | nan       | nan       | nan       | nan       | nan        | nan      | nan      | nan       | nan       | nan       | nan       | nan        | nan       | nan       | nan        | nan       | nan       |
| nan        | nan       | nan      | nan       | nan       | nan       | nan       | nan        | nan       | nan      | nan       | nan       | nan       | nan       | nan       | nan       | nan       | nan        | nan      | nan      | nan       | nan       | nan       | nan       | nan        | nan       | nan       | nan        | nan       | nan       |
| nan        | nan       | nan      | nan       | nan       | nan       | nan       | nan        | nan       | nan      | nan       | nan       | nan       | nan       | nan       | nan       | nan       | nan        | nan      | nan      | nan       | nan       | nan       | nan       | nan        | nan       | nan       | nan        | nan       | nan       |

STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/STL10_ImageNette_CL/models

 ********** Hebbian Unsupervised learning of blocks [2] **********
SEED:  0
BEFORE RESIZING
Files already downloaded and verified
AFTER RESIZING
Files already downloaded and verified
INDICES:  5000
IMAGE SIZE: torch.Size([32, 3, 96, 96])
SAVING FOLDER FOR UNSUP:  STL10_ImageNette_CL
INSIDE EVALUATE UNSUP
INSIDE EVALUATE UNSUP RETURNED 0,0
Epoch: [1/1]	lr: 4.90e-02	time: 00:01:34	Acc_train 0.00	Acc_test 0.00	convergence: 2.40e+01	R1: 0	Info MB:0.000e+00/SB:0.000e+00/MW:4.402e-03/SW:1.138e-01/MR:6.051e+00/SR:2.866e+00/MeD:2.345e+00/MaD:6.858e+00/MW:0.633/MAW:0.367
|        0 |        1 |        2 |        3 |        4 |        5 |        6 |        7 |       8 |        9 |      10 |        11 |      12 |       13 |       14 |       15 |       16 |       17 |        18 |       19 |       20 |       21 |         22 |       23 |       24 |       25 |       26 |      27 |       28 |        29 |
|----------+----------+----------+----------+----------+----------+----------+----------+---------+----------+---------+-----------+---------+----------+----------+----------+----------+----------+-----------+----------+----------+----------+------------+----------+----------+----------+----------+---------+----------+-----------|
|   0.0252 |   0.0237 |   0.0252 |   0.0169 |   0.0112 |   0.0269 |   0.0243 |   0.0258 |   0.026 |   0.0283 |   0.023 |   0.00648 |   0.015 |   0.0253 |   0.0155 |   0.0265 |   0.0258 |   0.0209 |   0.00038 |   0.0282 |   0.0102 |   0.0212 |   0.000318 |   0.0257 |   0.0261 |   0.0259 |   0.0177 |   0.016 |   0.0287 |   0.00217 |
|   7.36   |   6.61   |   7.36   |   3.85   |   2.25   |   8.24   |   6.89   |   7.64   |   7.78  |   9.02   |   6.31  |   1.42    |   3.26  |   7.41   |   3.41   |   8.02   |   7.65   |   5.37   |   1       |   8.95   |   2.05   |   5.5    |   1        |   7.59   |   7.82   |   7.7    |   4.15   |   3.56  |   9.26   |   1.05    |
|   0.01   |   0.01   |   0.01   |   0      |   0      |   0.01   |   0.02   |   0.01   |   0.02  |   0.02   |   0.03  |   0.02    |   0.01  |   0.01   |   0.01   |   0.02   |   0.01   |   0.02   |   0.17    |   0.02   |   0.01   |   0.01   |   0.36     |   0.02   |   0.02   |   0.02   |   0      |   0.01  |   0.01   |   0.06    |
| nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan     | nan      | nan     | nan       | nan     | nan      | nan      | nan      | nan      | nan      | nan       | nan      | nan      | nan      | nan        | nan      | nan      | nan      | nan      | nan     | nan      | nan       |
| nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan     | nan      | nan     | nan       | nan     | nan      | nan      | nan      | nan      | nan      | nan       | nan      | nan      | nan      | nan        | nan      | nan      | nan      | nan      | nan     | nan      | nan       |
| nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan     | nan      | nan     | nan       | nan     | nan      | nan      | nan      | nan      | nan      | nan       | nan      | nan      | nan      | nan        | nan      | nan      | nan      | nan      | nan     | nan      | nan       |

STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/STL10_ImageNette_CL/models

 ********** Hebbian Unsupervised learning of blocks [3] **********
SEED:  0
BEFORE RESIZING
Files already downloaded and verified
AFTER RESIZING
Files already downloaded and verified
INDICES:  5000
IMAGE SIZE: torch.Size([32, 3, 96, 96])
SAVING FOLDER FOR UNSUP:  STL10_ImageNette_CL
INSIDE EVALUATE UNSUP
INSIDE EVALUATE UNSUP RETURNED 0,0
Epoch: [1/1]	lr: 2.04e-02	time: 00:02:15	Acc_train 0.00	Acc_test 0.00	convergence: 1.26e+01	R1: 43	Info MB:0.000e+00/SB:0.000e+00/MW:3.981e-03/SW:1.208e-01/MR:1.358e+01/SR:4.180e+00/MeD:3.104e+00/MaD:1.258e+01/MW:0.527/MAW:0.473
|        0 |        1 |        2 |        3 |        4 |        5 |        6 |        7 |       8 |        9 |       10 |       11 |       12 |       13 |      14 |      15 |       16 |       17 |       18 |       19 |       20 |       21 |       22 |       23 |       24 |       25 |       26 |       27 |       28 |       29 |
|----------+----------+----------+----------+----------+----------+----------+----------+---------+----------+----------+----------+----------+----------+---------+---------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------|
|   0.0406 |   0.0364 |   0.0392 |   0.0321 |   0.0377 |   0.0384 |   0.0367 |   0.0088 |   0.041 |   0.0394 |   0.0384 |   0.0392 |   0.0407 |   0.0377 |   0.037 |   0.036 |   0.0271 |   0.0424 |   0.0321 |   0.0132 |   0.0353 |   0.0379 |   0.0407 |   0.0298 |   0.0383 |   0.0403 |   0.0143 |   0.0403 |   0.0416 |   0.0362 |
|  17.51   |  14.25   |  16.36   |  11.3    |  15.22   |  15.74   |  14.45   |   1.77   |  17.79  |  16.52   |  15.78   |  16.37   |  17.53   |  15.2    |  14.72  |  13.98  |   8.37   |  19      |  11.33   |   2.75   |  13.44   |  15.35   |  17.57   |   9.85   |  15.67   |  17.27   |   3.05   |  17.21   |  18.29   |  14.08   |
|   0.01   |   0.01   |   0.01   |   0.01   |   0.01   |   0.01   |   0      |   0.05   |   0.01  |   0.01   |   0.01   |   0.01   |   0.01   |   0.01   |   0.01  |   0.01  |   0      |   0.01   |   0.01   |   0.03   |   0.01   |   0.01   |   0.02   |   0.01   |   0.01   |   0      |   0.05   |   0.01   |   0.01   |   0.01   |
| nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan     | nan      | nan      | nan      | nan      | nan      | nan     | nan     | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      |
| nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan     | nan      | nan      | nan      | nan      | nan      | nan     | nan     | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      |
| nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan     | nan      | nan      | nan      | nan      | nan      | nan     | nan     | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      |

STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/STL10_ImageNette_CL/models
SEED:  0
BEFORE RESIZING
Files already downloaded and verified
AFTER RESIZING
Files already downloaded and verified
INDICES:  5000
IMAGE SIZE: torch.Size([64, 3, 96, 96])
Accuracy of the network on the 1st dataset: 74.950 %
Test loss on the 1st dataset: 1.705
CL:  True
{'name': 'ImageNette', 'noise_std': 0, 'channels': 3, 'width': 160, 'height': 160, 'validation_split': 0.2, 'training_sample': 9469, 'testing_sample': 10000, 'out_channels': 10, 'num_workers': 0, 'seed': 0, 'shuffle': True, 'batch_size': 32, 'augmentation': False, 'zca_whitened': False, 'training_class': 'all', 'split': 'train', 'px': 160, 'nb_epoch': 50, 'print_freq': 10, 'validation': False, 'continual_learning': True}
CL:  True
{'name': 'ImageNette', 'noise_std': 0, 'channels': 3, 'width': 160, 'height': 160, 'validation_split': 0.2, 'training_sample': 9469, 'testing_sample': 10000, 'out_channels': 10, 'num_workers': 0, 'seed': 0, 'shuffle': True, 'batch_size': 10, 'augmentation': False, 'zca_whitened': False, 'training_class': 'all', 'split': 'train', 'px': 160, 'nb_epoch': 1, 'print_freq': 10, 'validation': False, 'continual_learning': True}
SEED:  0
block 0, size : 96 80 80
range = 2.886751345948129
block 1, size : 384 40 40
range = 0.8505172717997146
block 2, size : 1536 20 20
range = 0.4252586358998573
block 3, size : 6144 10 10
range = 0.21262931794992865
range = 0.02209708691207961
The device used will be: 
True
cuda:0
CONFIG: {'arch': 'CNN', 'nb_train': None, 'lr': 0.08, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 1.0, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 2, 'weight_init': 'normal', 'weight_init_range': 2.886751345948129, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.5, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 96, 'kernel_size': 5, 'in_channels': 3, 'lr_scheduler': {'lr': 0.08, 'adaptive': True, 'nb_epochs': 1, 'ratio': 0.00032, 'speed': 7, 'div': 96, 'decay': 'linear', 'power_lr': 0.5}}
CONFIG: {'arch': 'CNN', 'nb_train': None, 'lr': 0.005, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 0.65, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 1, 'weight_init': 'normal', 'weight_init_range': 0.8505172717997146, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.5, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 384, 'kernel_size': 3, 'in_channels': 96, 'lr_scheduler': {'lr': 0.005, 'adaptive': True, 'nb_epochs': 1, 'ratio': 0.00032, 'speed': 7, 'div': 96, 'decay': 'linear', 'power_lr': 0.5}}
CONFIG: {'arch': 'CNN', 'nb_train': None, 'lr': 0.01, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 0.45, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 1, 'weight_init': 'normal', 'weight_init_range': 0.4252586358998573, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.5, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 1536, 'kernel_size': 3, 'in_channels': 384, 'lr_scheduler': {'lr': 0.01, 'adaptive': True, 'nb_epochs': 1, 'ratio': 0.00032, 'speed': 7, 'div': 96, 'decay': 'linear', 'power_lr': 0.5}}
CONFIG: {'arch': 'CNN', 'nb_train': None, 'lr': 0.01, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 0.25, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 1, 'weight_init': 'normal', 'weight_init_range': 0.21262931794992865, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.5, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 6144, 'kernel_size': 3, 'in_channels': 1536, 'lr_scheduler': {'lr': 0.01, 'adaptive': True, 'nb_epochs': 1, 'ratio': 0.00032, 'speed': 7, 'div': 96, 'decay': 'linear', 'power_lr': 0.5}}
CONFIG: {'arch': 'MLP', 'lr': 0.05, 'adaptive': True, 'lr_sup': 0.001, 'speed': 0.4, 'lr_div': 100, 'lebesgue_p': 2, 't_invert': 10, 'beta': 0.01, 'power': 4.5, 'ranking_param': 3, 'delta': 0.1, 'hebbian': False, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'lr_bias': 600, 'softness': 'soft', 'soft_activation_fn': 'exp', 'plasticity': 'SoftHebb', 'metric_mode': 'unsupervised', 'weight_init': 'positive', 'weight_init_range': 0.036828478186799345, 'weight_init_offset': 0, 'weight_decay': 0, 'radius': 10, 'power_lr': 0.2, 'out_channels': 10, 'in_channels': 221184, 'old_channels': 6144, 'lr_scheduler': {'decay': 'cste', 'lr': 0.1}}

 Model STL10_ImageNette_CL loaded successfuly with best perf



 ----- Architecture Block BatchNorm2dSK3962(5, 5)1.0reflect, number 0 -----
- BatchNorm2d(3, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
- HebbSoftKrotovConv2d(3, 96, lebesgue_p=2, pruning=0, kernel_size=(5, 5), bias=False, padding_mode=reflect, t_invert=1.0, bias=False, lr_bias=0.1, ranking_param=3, delta=2, activation=exp)
- Triangle(power=0.7)
- AvgPool2d(kernel_size=4, stride=2, padding=1)

 ----- Architecture Block BatchNorm2dSK963842(3, 3)0.6499999761581421reflect, number 1 -----
- BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
- HebbSoftKrotovConv2d(96, 384, lebesgue_p=2, pruning=0, kernel_size=(3, 3), bias=False, padding_mode=reflect, t_invert=0.6499999761581421, bias=False, lr_bias=0.1538, ranking_param=3, delta=2, activation=exp)
- Triangle(power=0.7)
- MaxPool2d(kernel_size=4, stride=2, padding=1, dilation=1, ceil_mode=False)

 ----- Architecture Block BatchNorm2dSK38415362(3, 3)0.44999998807907104reflect, number 2 -----
- BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
- HebbSoftKrotovConv2d(384, 1536, lebesgue_p=2, pruning=0, kernel_size=(3, 3), bias=False, padding_mode=reflect, t_invert=0.44999998807907104, bias=False, lr_bias=0.2222, ranking_param=3, delta=2, activation=exp)
- Triangle(power=1.4)
- AvgPool2d(kernel_size=4, stride=2, padding=1)

 ----- Architecture Block BatchNorm2dSK153661442(3, 3)0.25reflect, number 3 -----
- BatchNorm2d(1536, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
- HebbSoftKrotovConv2d(1536, 6144, lebesgue_p=2, pruning=0, kernel_size=(3, 3), bias=False, padding_mode=reflect, t_invert=0.25, bias=False, lr_bias=0.4, ranking_param=3, delta=2, activation=exp)
- Triangle(power=1)
- AvgPool2d(kernel_size=2, stride=2, padding=0)

 ----- Architecture Block FlattenDropout(p=0.5, inplace=False)Linear(in_, number 4 -----
- Flatten(start_dim=1, end_dim=-1)
- Dropout(p=0.5, inplace=False)
- Linear(in_features=221184, out_features=10, bias=True)

 ********** Hebbian Unsupervised learning of blocks [0] **********
SEED:  0
BEFORE RESIZING
AFTER RESIZING
INDICES:  9469
IMAGE SIZE: torch.Size([10, 3, 96, 96])
SAVING FOLDER FOR UNSUP:  STL10_ImageNette_CL
INSIDE EVALUATE UNSUP
INSIDE EVALUATE UNSUP RETURNED 0,0
Epoch: [1/1]	lr: 1.33e-01	time: 00:01:23	Acc_train 0.00	Acc_test 0.00	convergence: 2.40e+01	R1: 0	Info MB:0.000e+00/SB:0.000e+00/MW:7.464e-03/SW:5.563e-01/MR:4.303e+00/SR:2.177e+00/MeD:1.631e+00/MaD:5.688e+00/MW:0.650/MAW:0.350
|        0 |        1 |       2 |       3 |       4 |      5 |       6 |       7 |       8 |       9 |        10 |      11 |      12 |      13 |     14 |      15 |         16 |      17 |       18 |      19 |      20 |         21 |     22 |      23 |      24 |         25 |      26 |       27 |         28 |      29 |
|----------+----------+---------+---------+---------+--------+---------+---------+---------+---------+-----------+---------+---------+---------+--------+---------+------------+---------+----------+---------+---------+------------+--------+---------+---------+------------+---------+----------+------------+---------|
|   0.0957 |   0.0889 |   0.209 |   0.205 |   0.158 |   0.24 |   0.187 |   0.105 |   0.158 |   0.148 |   0.00121 |   0.156 |   0.236 |   0.142 |   0.1  |   0.106 |   0.000254 |   0.204 |   0.0976 |   0.139 |   0.147 |   0.000579 |   0.06 |   0.143 |   0.203 |   0.000163 |   0.211 |   0.0215 |   0.000628 |   0.196 |
|   2.43   |   2.24   |   7.85  |   7.59  |   4.91  |   9.99 |   6.46  |   2.71  |   4.9   |   4.43  |   1       |   4.81  |   9.71  |   4.15  |   2.57 |   2.76  |   1        |   7.52  |   2.49   |   4.04  |   4.39  |   1        |   1.56 |   4.21  |   7.44  |   1        |   7.95  |   1.07   |   1        |   6.98  |
|   0.36   |   0.36   |   0.36  |   0.41  |   0.42  |   0.36 |   0.32  |   0.38  |   0.32  |   0.44  |   3.05    |   0.41  |   0.31  |   0.47  |   0.41 |   0.42  |  23.85     |   0.37  |   0.4    |   0.39  |   0.43  |   1.26     |   0.38 |   0.42  |   0.42  |  30.99     |   0.3   |   0.52   |   1.23     |   0.35  |
| nan      | nan      | nan     | nan     | nan     | nan    | nan     | nan     | nan     | nan     | nan       | nan     | nan     | nan     | nan    | nan     | nan        | nan     | nan      | nan     | nan     | nan        | nan    | nan     | nan     | nan        | nan     | nan      | nan        | nan     |
| nan      | nan      | nan     | nan     | nan     | nan    | nan     | nan     | nan     | nan     | nan       | nan     | nan     | nan     | nan    | nan     | nan        | nan     | nan      | nan     | nan     | nan        | nan    | nan     | nan     | nan        | nan     | nan      | nan        | nan     |
| nan      | nan      | nan     | nan     | nan     | nan    | nan     | nan     | nan     | nan     | nan       | nan     | nan     | nan     | nan    | nan     | nan        | nan     | nan      | nan     | nan     | nan        | nan    | nan     | nan     | nan        | nan     | nan      | nan        | nan     |

STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/STL10_ImageNette_CL/models

 ********** Hebbian Unsupervised learning of blocks [1] **********
SEED:  0
BEFORE RESIZING
AFTER RESIZING
INDICES:  9469
IMAGE SIZE: torch.Size([10, 3, 96, 96])
SAVING FOLDER FOR UNSUP:  STL10_ImageNette_CL
INSIDE EVALUATE UNSUP
INSIDE EVALUATE UNSUP RETURNED 0,0
Epoch: [1/1]	lr: 1.33e-01	time: 00:02:09	Acc_train 0.00	Acc_test 0.00	convergence: 2.40e+01	R1: 0	Info MB:0.000e+00/SB:0.000e+00/MW:9.589e-03/SW:9.220e-02/MR:2.395e+00/SR:1.302e+00/MeD:1.078e+00/MaD:4.870e+00/MW:0.649/MAW:0.351
|          0 |         1 |         2 |        3 |         4 |        5 |         6 |          7 |         8 |          9 |        10 |        11 |       12 |        13 |        14 |        15 |         16 |         17 |      18 |        19 |        20 |        21 |        22 |        23 |         24 |        25 |     26 |         27 |        28 |        29 |
|------------+-----------+-----------+----------+-----------+----------+-----------+------------+-----------+------------+-----------+-----------+----------+-----------+-----------+-----------+------------+------------+---------+-----------+-----------+-----------+-----------+-----------+------------+-----------+--------+------------+-----------+-----------|
|   0.000342 |   0.00826 |   0.00762 |   0.0109 |   0.00218 |   0.0105 |   0.00229 |   6.71e-05 |   0.00575 |   0.000128 |   0.00684 |   0.00648 |   0.0021 |   0.00139 |   0.00693 |   0.00529 |   0.000941 |   0.000654 |   0.011 |   0.00662 |   0.00717 |   0.00206 |   0.00775 |   0.00382 |   0.000431 |   0.00549 |   0.01 |   0.000298 |   0.00447 |   0.00101 |
|   1        |   3.73    |   3.32    |   5.71   |   1.19    |   5.43   |   1.21    |   1        |   2.32    |   1        |   2.87    |   2.68    |   1.18   |   1.08    |   2.92    |   2.12    |   1.04     |   1.02     |   5.81  |   2.75    |   3.06    |   1.17    |   3.4     |   1.58    |   1.01     |   2.21    |   5.01 |   1        |   1.8     |   1.04    |
|   0.35     |   0.05    |   0.11    |   0.06   |   0.11    |   0.09   |   0.17    |   2.01     |   0.04    |   1.67     |   0.08    |   0.03    |   0.12   |   0.19    |   0.06    |   0.06    |   0.22     |   0.35     |   0.09  |   0.06    |   0.08    |   0.18    |   0.17    |   0.08    |   0.13     |   0.11    |   0.11 |   0.47     |   0.1     |   0.28    |
| nan        | nan       | nan       | nan      | nan       | nan      | nan       | nan        | nan       | nan        | nan       | nan       | nan      | nan       | nan       | nan       | nan        | nan        | nan     | nan       | nan       | nan       | nan       | nan       | nan        | nan       | nan    | nan        | nan       | nan       |
| nan        | nan       | nan       | nan      | nan       | nan      | nan       | nan        | nan       | nan        | nan       | nan       | nan      | nan       | nan       | nan       | nan        | nan        | nan     | nan       | nan       | nan       | nan       | nan       | nan        | nan       | nan    | nan        | nan       | nan       |
| nan        | nan       | nan       | nan      | nan       | nan      | nan       | nan        | nan       | nan        | nan       | nan       | nan      | nan       | nan       | nan       | nan        | nan        | nan     | nan       | nan       | nan       | nan       | nan       | nan        | nan       | nan    | nan        | nan       | nan       |

STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/STL10_ImageNette_CL/models

 ********** Hebbian Unsupervised learning of blocks [2] **********
SEED:  0
BEFORE RESIZING
AFTER RESIZING
INDICES:  9469
IMAGE SIZE: torch.Size([10, 3, 96, 96])
SAVING FOLDER FOR UNSUP:  STL10_ImageNette_CL
INSIDE EVALUATE UNSUP
INSIDE EVALUATE UNSUP RETURNED 0,0
Epoch: [1/1]	lr: 4.90e-02	time: 00:03:00	Acc_train 0.00	Acc_test 0.00	convergence: 2.40e+01	R1: 0	Info MB:0.000e+00/SB:0.000e+00/MW:4.332e-03/SW:1.160e-01/MR:6.119e+00/SR:3.021e+00/MeD:2.511e+00/MaD:6.479e+00/MW:0.642/MAW:0.358
|        0 |        1 |        2 |        3 |        4 |        5 |       6 |        7 |        8 |        9 |       10 |       11 |       12 |       13 |       14 |       15 |       16 |       17 |         18 |       19 |        20 |       21 |         22 |       23 |       24 |       25 |       26 |      27 |      28 |       29 |
|----------+----------+----------+----------+----------+----------+---------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+------------+----------+-----------+----------+------------+----------+----------+----------+----------+---------+---------+----------|
|   0.0277 |   0.0261 |   0.0252 |   0.0161 |   0.0114 |   0.0292 |   0.027 |   0.0257 |   0.0281 |   0.0335 |   0.0242 |   0.0021 |   0.0129 |   0.0271 |   0.0161 |   0.0243 |   0.0276 |   0.0233 |   0.000312 |   0.0293 |   0.00981 |   0.0236 |   0.000271 |   0.0254 |   0.0279 |   0.0254 |   0.0186 |   0.016 |   0.025 |   0.0016 |
|   8.65   |   7.83   |   7.37   |   3.59   |   2.31   |   9.55   |   8.29  |   7.6    |   8.89   |  12.22   |   6.86   |   1.04   |   2.67   |   8.32   |   3.58   |   6.91   |   8.64   |   6.44   |   1        |   9.6    |   1.96    |   6.57   |   1        |   7.45   |   8.81   |   7.47   |   4.47   |   3.56  |   7.26  |   1.03   |
|   0      |   0.01   |   0.01   |   0.01   |   0      |   0.01   |   0.01  |   0.01   |   0.02   |   0.02   |   0.02   |   0.09   |   0.01   |   0      |   0      |   0.02   |   0.01   |   0.01   |   0.24     |   0.02   |   0.01    |   0.01   |   0.37     |   0.02   |   0.02   |   0.02   |   0      |   0.01  |   0.02  |   0.08   |
| nan      | nan      | nan      | nan      | nan      | nan      | nan     | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan        | nan      | nan       | nan      | nan        | nan      | nan      | nan      | nan      | nan     | nan     | nan      |
| nan      | nan      | nan      | nan      | nan      | nan      | nan     | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan        | nan      | nan       | nan      | nan        | nan      | nan      | nan      | nan      | nan     | nan     | nan      |
| nan      | nan      | nan      | nan      | nan      | nan      | nan     | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan        | nan      | nan       | nan      | nan        | nan      | nan      | nan      | nan      | nan     | nan     | nan      |

STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/STL10_ImageNette_CL/models

 ********** Hebbian Unsupervised learning of blocks [3] **********
SEED:  0
BEFORE RESIZING
AFTER RESIZING
INDICES:  9469
IMAGE SIZE: torch.Size([10, 3, 96, 96])
SAVING FOLDER FOR UNSUP:  STL10_ImageNette_CL
INSIDE EVALUATE UNSUP
INSIDE EVALUATE UNSUP RETURNED 0,0
Epoch: [1/1]	lr: 2.05e-02	time: 00:04:17	Acc_train 0.00	Acc_test 0.00	convergence: 1.21e+01	R1: 44	Info MB:0.000e+00/SB:0.000e+00/MW:4.276e-03/SW:1.166e-01/MR:1.307e+01/SR:4.187e+00/MeD:3.156e+00/MaD:1.207e+01/MW:0.527/MAW:0.473
|        0 |        1 |        2 |        3 |       4 |        5 |        6 |         7 |        8 |        9 |       10 |       11 |       12 |       13 |       14 |       15 |       16 |      17 |       18 |       19 |       20 |       21 |       22 |       23 |       24 |       25 |      26 |       27 |       28 |      29 |
|----------+----------+----------+----------+---------+----------+----------+-----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+---------+----------+----------+----------+----------+----------+----------+----------+----------+---------+----------+----------+---------|
|   0.0404 |   0.0378 |   0.0359 |   0.0342 |   0.037 |   0.0361 |   0.0386 |   0.00873 |   0.0445 |   0.0384 |   0.0392 |   0.0393 |   0.0399 |   0.0347 |   0.0387 |   0.0345 |   0.0276 |   0.041 |   0.0317 |   0.0112 |   0.0343 |   0.0363 |   0.0425 |   0.0239 |   0.0362 |   0.0355 |   0.015 |   0.0386 |   0.0395 |   0.035 |
|  17.36   |  15.32   |  13.9    |  12.69   |  14.71  |  14.05   |  15.87   |   1.76    |  20.79   |  15.78   |  16.38   |  16.42   |  16.93   |  13.04   |  15.99   |  12.93   |   8.59   |  17.82  |  11.04   |   2.26   |  12.78   |  14.16   |  19.04   |   6.7    |  14.14   |  13.58   |   3.26  |  15.86   |  16.58   |  13.23  |
|   0.02   |   0.01   |   0.01   |   0      |   0.01  |   0.02   |   0      |   0.03    |   0.01   |   0.01   |   0.01   |   0.01   |   0.01   |   0.01   |   0.01   |   0.01   |   0.01   |   0.02  |   0      |   0.04   |   0.01   |   0.01   |   0.01   |   0.01   |   0.01   |   0.02   |   0.01  |   0.01   |   0.01   |   0.01  |
| nan      | nan      | nan      | nan      | nan     | nan      | nan      | nan       | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan     | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan     | nan      | nan      | nan     |
| nan      | nan      | nan      | nan      | nan     | nan      | nan      | nan       | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan     | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan     | nan      | nan      | nan     |
| nan      | nan      | nan      | nan      | nan     | nan      | nan      | nan       | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan     | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan     | nan      | nan      | nan     |

STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/STL10_ImageNette_CL/models

 ********** Supervised learning of blocks [4] **********
SAVING FOLDER FOR SUP:  STL10_ImageNette_CL
SEED:  0
BEFORE RESIZING
AFTER RESIZING
INDICES:  9469
IMAGE SIZE: torch.Size([32, 3, 96, 96])
Epoch: [1/50]	lr: 1.00e-03	time: 00:05:07	Loss_train 11.12669	Acc_train 54.03	/	Loss_test 7.07074	Acc_test 65.89
STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/STL10_ImageNette_CL/models
Epoch: [10/50]	lr: 1.00e-03	time: 00:09:08	Loss_train 2.34832	Acc_train 84.55	/	Loss_test 7.79827	Acc_test 72.76
STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/STL10_ImageNette_CL/models
Epoch: [20/50]	lr: 2.50e-04	time: 00:13:35	Loss_train 0.22247	Acc_train 97.29	/	Loss_test 6.28623	Acc_test 76.00
STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/STL10_ImageNette_CL/models
Epoch: [30/50]	lr: 1.25e-04	time: 00:18:02	Loss_train 0.05338	Acc_train 99.09	/	Loss_test 5.88439	Acc_test 77.43
STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/STL10_ImageNette_CL/models
Epoch: [40/50]	lr: 3.13e-05	time: 00:22:29	Loss_train 0.00799	Acc_train 99.80	/	Loss_test 5.73123	Acc_test 77.50
STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/STL10_ImageNette_CL/models
Epoch: [50/50]	lr: 7.81e-06	time: 00:26:55	Loss_train 0.00437	Acc_train 99.87	/	Loss_test 5.60223	Acc_test 77.83
STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/STL10_ImageNette_CL/models
RESULT:  {'train_loss': 0.004374958109110594, 'train_acc': 99.86904859542847, 'test_loss': 5.602234363555908, 'test_acc': 77.83439636230469, 'convergence': 12.066953659057617, 'R1': 44, 'dataset_sup': {'name': 'ImageNette', 'noise_std': 0, 'channels': 3, 'width': 160, 'height': 160, 'validation_split': 0.2, 'training_sample': 9469, 'testing_sample': 10000, 'out_channels': 10, 'num_workers': 0, 'seed': 0, 'shuffle': True, 'batch_size': 32, 'augmentation': False, 'zca_whitened': False, 'training_class': 'all', 'split': 'train', 'px': 160, 'nb_epoch': 50, 'print_freq': 10, 'validation': False, 'continual_learning': True, 'old_dataset_size': 96}, 'dataset_unsup': {'name': 'ImageNette', 'noise_std': 0, 'channels': 3, 'width': 160, 'height': 160, 'validation_split': 0.2, 'training_sample': 9469, 'testing_sample': 10000, 'out_channels': 10, 'num_workers': 0, 'seed': 0, 'shuffle': True, 'batch_size': 10, 'augmentation': False, 'zca_whitened': False, 'training_class': 'all', 'split': 'train', 'px': 160, 'nb_epoch': 1, 'print_freq': 10, 'validation': False, 'continual_learning': True, 'old_dataset_size': 96}, 'train_config': {'t0': {'blocks': [0], 'mode': 'unsupervised', 'lr': 0.08, 'nb_epoch': 1, 'batch_size': 10, 'print_freq': 10}, 't2': {'blocks': [1], 'mode': 'unsupervised', 'lr': 0.005, 'nb_epoch': 1, 'batch_size': 10, 'print_freq': 10}, 't4': {'blocks': [2], 'mode': 'unsupervised', 'lr': 0.01, 'nb_epoch': 1, 'batch_size': 10, 'print_freq': 10}, 't6': {'blocks': [3], 'mode': 'unsupervised', 'lr': 0.01, 'nb_epoch': 1, 'batch_size': 10, 'print_freq': 10}, 't8': {'blocks': [4], 'mode': 'supervised', 'lr': 0.001, 'nb_epoch': 50, 'batch_size': 32, 'print_freq': 10}}}
IN R1:  {'eval_1': {'test_loss': 1.7046663761138916, 'test_acc': 74.94999694824219, 'convergence': 12.583572387695312, 'R1': 43, 'dataset_sup': {'name': 'STL10', 'noise_std': 0, 'channels': 3, 'width': 96, 'height': 96, 'validation_split': 0.2, 'training_sample': 5000, 'testing_sample': 10000, 'out_channels': 10, 'num_workers': 4, 'seed': 0, 'shuffle': True, 'batch_size': 64, 'augmentation': True, 'zca_whitened': False, 'training_class': 'all', 'split': 'train', 'nb_epoch': 100, 'print_freq': 10, 'validation': False, 'continual_learning': False}, 'dataset_unsup': {'name': 'STL10', 'noise_std': 0, 'channels': 3, 'width': 96, 'height': 96, 'validation_split': 0.2, 'training_sample': 100000, 'testing_sample': 10000, 'out_channels': 10, 'num_workers': 0, 'seed': 0, 'shuffle': True, 'batch_size': 32, 'augmentation': False, 'zca_whitened': False, 'training_class': 'all', 'split': 'unlabeled', 'nb_epoch': 1, 'print_freq': 25, 'validation': False, 'continual_learning': False}}, 'R1': {'train_loss': 0.004374958109110594, 'train_acc': 99.86904859542847, 'test_loss': 5.602234363555908, 'test_acc': 77.83439636230469, 'convergence': 12.066953659057617, 'R1': 44, 'dataset_sup': {'name': 'ImageNette', 'noise_std': 0, 'channels': 3, 'width': 160, 'height': 160, 'validation_split': 0.2, 'training_sample': 9469, 'testing_sample': 10000, 'out_channels': 10, 'num_workers': 0, 'seed': 0, 'shuffle': True, 'batch_size': 32, 'augmentation': False, 'zca_whitened': False, 'training_class': 'all', 'split': 'train', 'px': 160, 'nb_epoch': 50, 'print_freq': 10, 'validation': False, 'continual_learning': True, 'old_dataset_size': 96}, 'dataset_unsup': {'name': 'ImageNette', 'noise_std': 0, 'channels': 3, 'width': 160, 'height': 160, 'validation_split': 0.2, 'training_sample': 9469, 'testing_sample': 10000, 'out_channels': 10, 'num_workers': 0, 'seed': 0, 'shuffle': True, 'batch_size': 10, 'augmentation': False, 'zca_whitened': False, 'training_class': 'all', 'split': 'train', 'px': 160, 'nb_epoch': 1, 'print_freq': 10, 'validation': False, 'continual_learning': True, 'old_dataset_size': 96}, 'train_config': {'t0': {'blocks': [0], 'mode': 'unsupervised', 'lr': 0.08, 'nb_epoch': 1, 'batch_size': 10, 'print_freq': 10}, 't2': {'blocks': [1], 'mode': 'unsupervised', 'lr': 0.005, 'nb_epoch': 1, 'batch_size': 10, 'print_freq': 10}, 't4': {'blocks': [2], 'mode': 'unsupervised', 'lr': 0.01, 'nb_epoch': 1, 'batch_size': 10, 'print_freq': 10}, 't6': {'blocks': [3], 'mode': 'unsupervised', 'lr': 0.01, 'nb_epoch': 1, 'batch_size': 10, 'print_freq': 10}, 't8': {'blocks': [4], 'mode': 'supervised', 'lr': 0.001, 'nb_epoch': 50, 'batch_size': 32, 'print_freq': 10}}}}
SEED:  0
block 0, size : 96 48 48
range = 2.886751345948129
block 1, size : 384 24 24
range = 0.8505172717997146
block 2, size : 1536 12 12
range = 0.4252586358998573
block 3, size : 6144 6 6
range = 0.21262931794992865
range = 0.036828478186799345
The device used will be: 
True
cuda:0
CONFIG: {'arch': 'CNN', 'nb_train': None, 'lr': 0.08, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 1.0, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 2, 'weight_init': 'normal', 'weight_init_range': 2.886751345948129, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.5, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 96, 'kernel_size': 5, 'in_channels': 3, 'lr_scheduler': {'lr': 0.08, 'adaptive': True, 'nb_epochs': 1, 'ratio': 0.00032, 'speed': 7, 'div': 96, 'decay': 'linear', 'power_lr': 0.5}}
CONFIG: {'arch': 'CNN', 'nb_train': None, 'lr': 0.005, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 0.65, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 1, 'weight_init': 'normal', 'weight_init_range': 0.8505172717997146, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.5, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 384, 'kernel_size': 3, 'in_channels': 96, 'lr_scheduler': {'lr': 0.005, 'adaptive': True, 'nb_epochs': 1, 'ratio': 0.00032, 'speed': 7, 'div': 96, 'decay': 'linear', 'power_lr': 0.5}}
CONFIG: {'arch': 'CNN', 'nb_train': None, 'lr': 0.01, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 0.45, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 1, 'weight_init': 'normal', 'weight_init_range': 0.4252586358998573, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.5, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 1536, 'kernel_size': 3, 'in_channels': 384, 'lr_scheduler': {'lr': 0.01, 'adaptive': True, 'nb_epochs': 1, 'ratio': 0.00032, 'speed': 7, 'div': 96, 'decay': 'linear', 'power_lr': 0.5}}
CONFIG: {'arch': 'CNN', 'nb_train': None, 'lr': 0.01, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 0.25, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 1, 'weight_init': 'normal', 'weight_init_range': 0.21262931794992865, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.5, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 6144, 'kernel_size': 3, 'in_channels': 1536, 'lr_scheduler': {'lr': 0.01, 'adaptive': True, 'nb_epochs': 1, 'ratio': 0.00032, 'speed': 7, 'div': 96, 'decay': 'linear', 'power_lr': 0.5}}
CONFIG: {'arch': 'MLP', 'lr': 0.05, 'adaptive': True, 'lr_sup': 0.001, 'speed': 0.4, 'lr_div': 100, 'lebesgue_p': 2, 't_invert': 10, 'beta': 0.01, 'power': 4.5, 'ranking_param': 3, 'delta': 0.1, 'hebbian': False, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'lr_bias': 600, 'softness': 'soft', 'soft_activation_fn': 'exp', 'plasticity': 'SoftHebb', 'metric_mode': 'unsupervised', 'weight_init': 'positive', 'weight_init_range': 0.036828478186799345, 'weight_init_offset': 0, 'weight_decay': 0, 'radius': 10, 'power_lr': 0.2, 'out_channels': 10, 'in_channels': 221184, 'old_channels': 6144, 'lr_scheduler': {'decay': 'cste', 'lr': 0.1}}

 Model STL10_ImageNette_CL loaded successfuly with best perf



 ----- Architecture Block BatchNorm2dSK3962(5, 5)1.0reflect, number 0 -----
- BatchNorm2d(3, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
- HebbSoftKrotovConv2d(3, 96, lebesgue_p=2, pruning=0, kernel_size=(5, 5), bias=False, padding_mode=reflect, t_invert=1.0, bias=False, lr_bias=0.1, ranking_param=3, delta=2, activation=exp)
- Triangle(power=0.7)
- AvgPool2d(kernel_size=4, stride=2, padding=1)

 ----- Architecture Block BatchNorm2dSK963842(3, 3)0.6499999761581421reflect, number 1 -----
- BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
- HebbSoftKrotovConv2d(96, 384, lebesgue_p=2, pruning=0, kernel_size=(3, 3), bias=False, padding_mode=reflect, t_invert=0.6499999761581421, bias=False, lr_bias=0.1538, ranking_param=3, delta=2, activation=exp)
- Triangle(power=0.7)
- MaxPool2d(kernel_size=4, stride=2, padding=1, dilation=1, ceil_mode=False)

 ----- Architecture Block BatchNorm2dSK38415362(3, 3)0.44999998807907104reflect, number 2 -----
- BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
- HebbSoftKrotovConv2d(384, 1536, lebesgue_p=2, pruning=0, kernel_size=(3, 3), bias=False, padding_mode=reflect, t_invert=0.44999998807907104, bias=False, lr_bias=0.2222, ranking_param=3, delta=2, activation=exp)
- Triangle(power=1.4)
- AvgPool2d(kernel_size=4, stride=2, padding=1)

 ----- Architecture Block BatchNorm2dSK153661442(3, 3)0.25reflect, number 3 -----
- BatchNorm2d(1536, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
- HebbSoftKrotovConv2d(1536, 6144, lebesgue_p=2, pruning=0, kernel_size=(3, 3), bias=False, padding_mode=reflect, t_invert=0.25, bias=False, lr_bias=0.4, ranking_param=3, delta=2, activation=exp)
- Triangle(power=1)
- AvgPool2d(kernel_size=2, stride=2, padding=0)

 ----- Architecture Block FlattenDropout(p=0.5, inplace=False)Linear(in_, number 4 -----
- Flatten(start_dim=1, end_dim=-1)
- Dropout(p=0.5, inplace=False)
- Linear(in_features=221184, out_features=10, bias=True)

 ********** Hebbian Unsupervised learning of blocks [0] **********
SEED:  0
BEFORE RESIZING
Files already downloaded and verified
AFTER RESIZING
Files already downloaded and verified
INDICES:  5000
IMAGE SIZE: torch.Size([32, 3, 96, 96])
SAVING FOLDER FOR UNSUP:  STL10_ImageNette_CL
INSIDE EVALUATE UNSUP
INSIDE EVALUATE UNSUP RETURNED 0,0
Epoch: [1/1]	lr: 1.24e-01	time: 00:00:27	Acc_train 0.00	Acc_test 0.00	convergence: 2.40e+01	R1: 0	Info MB:0.000e+00/SB:0.000e+00/MW:3.849e-03/SW:4.612e-01/MR:3.740e+00/SR:1.409e+00/MeD:1.072e+00/MaD:3.362e+00/MW:0.618/MAW:0.382
|       0 |        1 |       2 |       3 |      4 |       5 |       6 |       7 |      8 |       9 |        10 |      11 |      12 |      13 |      14 |     15 |         16 |      17 |      18 |      19 |      20 |        21 |       22 |      23 |     24 |         25 |      26 |       27 |        28 |      29 |
|---------+----------+---------+---------+--------+---------+---------+---------+--------+---------+-----------+---------+---------+---------+---------+--------+------------+---------+---------+---------+---------+-----------+----------+---------+--------+------------+---------+----------+-----------+---------|
|   0.102 |   0.0859 |   0.158 |   0.171 |   0.15 |   0.198 |   0.144 |   0.121 |   0.15 |   0.138 |   0.00134 |   0.149 |   0.186 |   0.157 |   0.108 |   0.12 |   9.16e-05 |   0.162 |   0.108 |   0.136 |   0.142 |   0.00174 |   0.0593 |   0.137 |   0.17 |   7.81e-05 |   0.163 |   0.0358 |   0.00189 |   0.172 |
|   2.62  |   2.15   |   4.89  |   5.59  |   4.54 |   7.1   |   4.25  |   3.28  |   4.52 |   3.96  |   1       |   4.46  |   6.43  |   4.83  |   2.82  |   3.25 |   1        |   5.09  |   2.81  |   3.9   |   4.17  |   1       |   1.55   |   3.92  |   5.53 |   1        |   5.14  |   1.2    |   1       |   5.61  |
|   0.37  |   0.42   |   0.36  |   0.41  |   0.47 |   0.4   |   0.33  |   0.4   |   0.33 |   0.49  |   3.2     |   0.45  |   0.35  |   0.43  |   0.43  |   0.44 |  24.73     |   0.37  |   0.41  |   0.43  |   0.48  |   1.11    |   0.43   |   0.47  |   0.38 |  28        |   0.33  |   0.32   |   1.14    |   0.38  |
| nan     | nan      | nan     | nan     | nan    | nan     | nan     | nan     | nan    | nan     | nan       | nan     | nan     | nan     | nan     | nan    | nan        | nan     | nan     | nan     | nan     | nan       | nan      | nan     | nan    | nan        | nan     | nan      | nan       | nan     |
| nan     | nan      | nan     | nan     | nan    | nan     | nan     | nan     | nan    | nan     | nan       | nan     | nan     | nan     | nan     | nan    | nan        | nan     | nan     | nan     | nan     | nan       | nan      | nan     | nan    | nan        | nan     | nan      | nan       | nan     |
| nan     | nan      | nan     | nan     | nan    | nan     | nan     | nan     | nan    | nan     | nan       | nan     | nan     | nan     | nan     | nan    | nan        | nan     | nan     | nan     | nan     | nan       | nan      | nan     | nan    | nan        | nan     | nan      | nan       | nan     |

STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/STL10_ImageNette_CL/models

 ********** Hebbian Unsupervised learning of blocks [1] **********
SEED:  0
BEFORE RESIZING
Files already downloaded and verified
AFTER RESIZING
Files already downloaded and verified
INDICES:  5000
IMAGE SIZE: torch.Size([32, 3, 96, 96])
SAVING FOLDER FOR UNSUP:  STL10_ImageNette_CL
INSIDE EVALUATE UNSUP
INSIDE EVALUATE UNSUP RETURNED 0,0
Epoch: [1/1]	lr: 1.24e-01	time: 00:00:56	Acc_train 0.00	Acc_test 0.00	convergence: 2.40e+01	R1: 0	Info MB:0.000e+00/SB:0.000e+00/MW:9.628e-03/SW:9.135e-02/MR:2.380e+00/SR:1.277e+00/MeD:1.069e+00/MaD:4.921e+00/MW:0.610/MAW:0.390
|          0 |         1 |         2 |        3 |         4 |         5 |        6 |          7 |         8 |         9 |       10 |        11 |        12 |        13 |        14 |       15 |         16 |        17 |       18 |        19 |        20 |        21 |        22 |       23 |         24 |        25 |        26 |         27 |        28 |         29 |
|------------+-----------+-----------+----------+-----------+-----------+----------+------------+-----------+-----------+----------+-----------+-----------+-----------+-----------+----------+------------+-----------+----------+-----------+-----------+-----------+-----------+----------+------------+-----------+-----------+------------+-----------+------------|
|   0.000328 |   0.00841 |   0.00778 |   0.0108 |   0.00214 |   0.00996 |   0.0022 |   7.69e-05 |   0.00565 |   0.00012 |   0.0067 |   0.00661 |   0.00208 |   0.00133 |   0.00707 |   0.0054 |   0.000889 |   0.00063 |   0.0105 |   0.00666 |   0.00715 |   0.00197 |   0.00757 |   0.0038 |   0.000429 |   0.00551 |   0.00961 |   0.000287 |   0.00442 |   0.000968 |
|   1        |   3.83    |   3.42    |   5.69   |   1.18    |   4.97    |   1.19   |   1        |   2.28    |   1       |   2.79   |   2.75    |   1.17    |   1.07    |   3       |   2.17   |   1.03     |   1.02    |   5.37   |   2.78    |   3.04    |   1.16    |   3.29    |   1.58   |   1.01     |   2.21    |   4.7     |   1        |   1.78    |   1.04     |
|   0.52     |   0.06    |   0.08    |   0.11   |   0.13    |   0.14    |   0.17   |   2.18     |   0.05    |   1.42    |   0.08   |   0.04    |   0.13    |   0.18    |   0.06    |   0.06   |   0.18     |   0.41    |   0.17   |   0.07    |   0.08    |   0.21    |   0.1     |   0.1    |   0.34     |   0.08    |   0.13    |   0.48     |   0.08    |   0.29     |
| nan        | nan       | nan       | nan      | nan       | nan       | nan      | nan        | nan       | nan       | nan      | nan       | nan       | nan       | nan       | nan      | nan        | nan       | nan      | nan       | nan       | nan       | nan       | nan      | nan        | nan       | nan       | nan        | nan       | nan        |
| nan        | nan       | nan       | nan      | nan       | nan       | nan      | nan        | nan       | nan       | nan      | nan       | nan       | nan       | nan       | nan      | nan        | nan       | nan      | nan       | nan       | nan       | nan       | nan      | nan        | nan       | nan       | nan        | nan       | nan        |
| nan        | nan       | nan       | nan      | nan       | nan       | nan      | nan        | nan       | nan       | nan      | nan       | nan       | nan       | nan       | nan      | nan        | nan       | nan      | nan       | nan       | nan       | nan       | nan      | nan        | nan       | nan       | nan        | nan       | nan        |

STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/STL10_ImageNette_CL/models

 ********** Hebbian Unsupervised learning of blocks [2] **********
SEED:  0
BEFORE RESIZING
Files already downloaded and verified
AFTER RESIZING
Files already downloaded and verified
INDICES:  5000
IMAGE SIZE: torch.Size([32, 3, 96, 96])
SAVING FOLDER FOR UNSUP:  STL10_ImageNette_CL
INSIDE EVALUATE UNSUP
INSIDE EVALUATE UNSUP RETURNED 0,0
Epoch: [1/1]	lr: 4.90e-02	time: 00:01:26	Acc_train 0.00	Acc_test 0.00	convergence: 2.40e+01	R1: 0	Info MB:0.000e+00/SB:0.000e+00/MW:4.357e-03/SW:1.130e-01/MR:5.990e+00/SR:2.884e+00/MeD:2.410e+00/MaD:7.737e+00/MW:0.635/MAW:0.365
|       0 |       1 |        2 |        3 |        4 |        5 |        6 |       7 |        8 |        9 |       10 |       11 |       12 |       13 |       14 |       15 |       16 |       17 |         18 |       19 |        20 |      21 |         22 |       23 |       24 |       25 |       26 |       27 |       28 |        29 |
|---------+---------+----------+----------+----------+----------+----------+---------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+------------+----------+-----------+---------+------------+----------+----------+----------+----------+----------+----------+-----------|
|   0.028 |   0.026 |   0.0256 |   0.0161 |   0.0115 |   0.0287 |   0.0258 |   0.026 |   0.0271 |   0.0284 |   0.0231 |   0.0021 |   0.0128 |   0.0278 |   0.0163 |   0.0241 |   0.0272 |   0.0226 |   0.000306 |   0.0291 |   0.00949 |   0.024 |   0.000319 |   0.0243 |   0.0271 |   0.0248 |   0.0188 |   0.0162 |   0.0257 |   0.00155 |
|   8.83  |   7.77  |   7.56   |   3.6    |   2.32   |   9.24   |   7.67   |   7.74  |   8.35   |   9.09   |   6.32   |   1.04   |   2.64   |   8.73   |   3.64   |   6.83   |   8.39   |   6.1    |   1        |   9.48   |   1.9     |   6.76  |   1        |   6.93   |   8.33   |   7.15   |   4.54   |   3.61   |   7.63   |   1.02    |
|   0.01  |   0.01  |   0.01   |   0      |   0      |   0.02   |   0.02   |   0.01  |   0.02   |   0.04   |   0.03   |   0.04   |   0.01   |   0.01   |   0      |   0.02   |   0.01   |   0.02   |   0.2      |   0.02   |   0.01    |   0     |   0.39     |   0.02   |   0.02   |   0.02   |   0      |   0.01   |   0.01   |   0.07    |
| nan     | nan     | nan      | nan      | nan      | nan      | nan      | nan     | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan        | nan      | nan       | nan     | nan        | nan      | nan      | nan      | nan      | nan      | nan      | nan       |
| nan     | nan     | nan      | nan      | nan      | nan      | nan      | nan     | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan        | nan      | nan       | nan     | nan        | nan      | nan      | nan      | nan      | nan      | nan      | nan       |
| nan     | nan     | nan      | nan      | nan      | nan      | nan      | nan     | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan        | nan      | nan       | nan     | nan        | nan      | nan      | nan      | nan      | nan      | nan      | nan       |

STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/STL10_ImageNette_CL/models

 ********** Hebbian Unsupervised learning of blocks [3] **********
SEED:  0
BEFORE RESIZING
Files already downloaded and verified
AFTER RESIZING
Files already downloaded and verified
INDICES:  5000
IMAGE SIZE: torch.Size([32, 3, 96, 96])
SAVING FOLDER FOR UNSUP:  STL10_ImageNette_CL
INSIDE EVALUATE UNSUP
INSIDE EVALUATE UNSUP RETURNED 0,0
Epoch: [1/1]	lr: 2.02e-02	time: 00:02:05	Acc_train 0.00	Acc_test 0.00	convergence: 1.17e+01	R1: 45	Info MB:0.000e+00/SB:0.000e+00/MW:4.330e-03/SW:1.132e-01/MR:1.269e+01/SR:4.050e+00/MeD:3.038e+00/MaD:1.169e+01/MW:0.535/MAW:0.465
|      0 |        1 |        2 |        3 |        4 |       5 |        6 |         7 |        8 |       9 |       10 |       11 |       12 |       13 |       14 |       15 |       16 |      17 |       18 |       19 |      20 |       21 |       22 |       23 |       24 |       25 |       26 |       27 |       28 |      29 |
|--------+----------+----------+----------+----------+---------+----------+-----------+----------+---------+----------+----------+----------+----------+----------+----------+----------+---------+----------+----------+---------+----------+----------+----------+----------+----------+----------+----------+----------+---------|
|   0.04 |   0.0376 |   0.0356 |   0.0336 |   0.0372 |   0.037 |   0.0377 |   0.00857 |   0.0408 |   0.038 |   0.0379 |   0.0393 |   0.0401 |   0.0347 |   0.0372 |   0.0354 |   0.0269 |   0.041 |   0.0297 |   0.0106 |   0.034 |   0.0366 |   0.0391 |   0.0233 |   0.0337 |   0.0359 |   0.0152 |   0.0376 |   0.0398 |   0.035 |
|  16.98 |  15.15   |  13.64   |  12.32   |  14.83   |  14.72  |  15.19   |   1.73    |  17.64   |  15.4   |  15.37   |  16.44   |  17.1    |  13.02   |  14.87   |  13.54   |   8.26   |  17.81  |   9.8    |   2.12   |  12.58  |  14.43   |  16.26   |   6.43   |  12.37   |  13.88   |   3.3    |  15.15   |  16.81   |  13.24  |
|   0.01 |   0.01   |   0.01   |   0.01   |   0.01   |   0.01  |   0.01   |   0.03    |   0.02   |   0.01  |   0.01   |   0.01   |   0.01   |   0.01   |   0.01   |   0      |   0      |   0.01  |   0.01   |   0.03   |   0.01  |   0.01   |   0.02   |   0.01   |   0.01   |   0      |   0.01   |   0.01   |   0.01   |   0.01  |
| nan    | nan      | nan      | nan      | nan      | nan     | nan      | nan       | nan      | nan     | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan     | nan      | nan      | nan     | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan     |
| nan    | nan      | nan      | nan      | nan      | nan     | nan      | nan       | nan      | nan     | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan     | nan      | nan      | nan     | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan     |
| nan    | nan      | nan      | nan      | nan      | nan     | nan      | nan       | nan      | nan     | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan     | nan      | nan      | nan     | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan     |

STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/STL10_ImageNette_CL/models
SEED:  0
BEFORE RESIZING
Files already downloaded and verified
AFTER RESIZING
Files already downloaded and verified
INDICES:  5000
IMAGE SIZE: torch.Size([64, 3, 96, 96])
Accuracy of the network on the 1st dataset: 15.087 %
Test loss on the 1st dataset: 20.323

