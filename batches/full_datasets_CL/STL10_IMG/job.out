BLOCKS:  {'b0': {'arch': 'CNN', 'preset': 'softkrotov-c96-k5-p2-s1-d1-b0-t1-lr0.08-lp0.5-e0', 'operation': 'batchnorm2d', 'num': 0, 'batch_norm': False, 'pool': {'type': 'avg', 'kernel_size': 4, 'stride': 2, 'padding': 1}, 'activation': {'function': 'triangle', 'param': 0.7}, 'resume': None, 'layer': {'arch': 'CNN', 'nb_train': None, 'lr': 0.08, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 1.0, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 2, 'weight_init': 'positive', 'weight_init_range': 2, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.5, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 96, 'kernel_size': 5}}, 'b1': {'arch': 'CNN', 'preset': 'softkrotov-c384-k3-p1-s1-d1-b0-t0.65-lr0.005-lp0.5-e0', 'operation': 'batchnorm2d', 'num': 1, 'batch_norm': False, 'pool': {'type': 'max', 'kernel_size': 4, 'stride': 2, 'padding': 1}, 'activation': {'function': 'triangle', 'param': 0.7}, 'resume': None, 'layer': {'arch': 'CNN', 'nb_train': None, 'lr': 0.005, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 0.65, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 1, 'weight_init': 'positive', 'weight_init_range': 2, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.5, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 384, 'kernel_size': 3}}, 'b2': {'arch': 'CNN', 'preset': 'softkrotov-c1536-k3-p1-s1-d1-b0-t0.45-lr0.01-lp0.5-e0', 'operation': 'batchnorm2d', 'num': 2, 'batch_norm': False, 'pool': {'type': 'avg', 'kernel_size': 4, 'stride': 2, 'padding': 1}, 'activation': {'function': 'triangle', 'param': 1.4}, 'resume': None, 'layer': {'arch': 'CNN', 'nb_train': None, 'lr': 0.01, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 0.45, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 1, 'weight_init': 'positive', 'weight_init_range': 2, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.5, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 1536, 'kernel_size': 3}}, 'b3': {'arch': 'CNN', 'preset': 'softkrotov-c6144-k3-p1-s1-d1-b0-t0.25-lr0.01-lp0.5-e0', 'operation': 'batchnorm2d', 'num': 3, 'batch_norm': False, 'pool': {'type': 'avg', 'kernel_size': 2, 'stride': 2, 'padding': 0}, 'activation': {'function': 'triangle', 'param': 1}, 'resume': None, 'layer': {'arch': 'CNN', 'nb_train': None, 'lr': 0.01, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 0.25, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 1, 'weight_init': 'positive', 'weight_init_range': 2, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.5, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 6144, 'kernel_size': 3}}, 'b4': {'arch': 'MLP', 'preset': 'BP-c10', 'operation': 'flatten', 'num': 4, 'att_dropout': None, 'dropout': 0.5, 'layer': {'arch': 'MLP', 'lr': 0.05, 'adaptive': True, 'lr_sup': 0.001, 'speed': 0.4, 'lr_div': 100, 'lebesgue_p': 2, 't_invert': 10, 'beta': 0.01, 'power': 4.5, 'ranking_param': 3, 'delta': 0.1, 'hebbian': False, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'lr_bias': 600, 'softness': 'soft', 'soft_activation_fn': 'exp', 'plasticity': 'SoftHebb', 'metric_mode': 'unsupervised', 'weight_init': 'positive', 'weight_init_range': 0.25, 'weight_init_offset': 0, 'weight_decay': 0, 'radius': 10, 'power_lr': 0.2, 'out_channels': 10}, 'pool': None, 'activation': None}}
CL:  True
{'name': 'STL10', 'noise_std': 0, 'channels': 3, 'width': 96, 'height': 96, 'validation_split': 0.2, 'training_sample': 5000, 'testing_sample': 10000, 'out_channels': 10, 'num_workers': 0, 'seed': 0, 'shuffle': True, 'batch_size': 64, 'augmentation': True, 'zca_whitened': False, 'training_class': 'all', 'split': 'train', 'nb_epoch': 100, 'print_freq': 10, 'validation': False, 'continual_learning': True}
CL:  False
{'name': 'STL10', 'noise_std': 0, 'channels': 3, 'width': 96, 'height': 96, 'validation_split': 0.2, 'training_sample': 5000, 'testing_sample': 10000, 'out_channels': 10, 'num_workers': 0, 'seed': 0, 'shuffle': True, 'batch_size': 64, 'augmentation': True, 'zca_whitened': False, 'training_class': 'all', 'split': 'train', 'nb_epoch': 100, 'print_freq': 10, 'validation': False, 'continual_learning': False}
CL:  False
{'name': 'STL10', 'noise_std': 0, 'channels': 3, 'width': 96, 'height': 96, 'validation_split': 0.2, 'training_sample': 100000, 'testing_sample': 10000, 'out_channels': 10, 'num_workers': 0, 'seed': 0, 'shuffle': True, 'batch_size': 32, 'augmentation': False, 'zca_whitened': False, 'training_class': 'all', 'split': 'unlabeled', 'nb_epoch': 1, 'print_freq': 25, 'validation': False, 'continual_learning': False}
SEED:  0
block 0, size : 96 48 48
range = 2.886751345948129
block 1, size : 384 24 24
range = 0.8505172717997146
block 2, size : 1536 12 12
range = 0.4252586358998573
block 3, size : 6144 6 6
range = 0.21262931794992865
range = 0.036828478186799345
The device used will be: 
True
cuda:0
CONFIG: {'arch': 'CNN', 'nb_train': None, 'lr': 0.08, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 1.0, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 2, 'weight_init': 'normal', 'weight_init_range': 2.886751345948129, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.5, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 96, 'kernel_size': 5, 'in_channels': 3, 'lr_scheduler': {'lr': 0.08, 'adaptive': True, 'nb_epochs': 1, 'ratio': 0.00032, 'speed': 7, 'div': 96, 'decay': 'linear', 'power_lr': 0.5}}
CONFIG: {'arch': 'CNN', 'nb_train': None, 'lr': 0.005, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 0.65, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 1, 'weight_init': 'normal', 'weight_init_range': 0.8505172717997146, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.5, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 384, 'kernel_size': 3, 'in_channels': 96, 'lr_scheduler': {'lr': 0.005, 'adaptive': True, 'nb_epochs': 1, 'ratio': 0.00032, 'speed': 7, 'div': 96, 'decay': 'linear', 'power_lr': 0.5}}
CONFIG: {'arch': 'CNN', 'nb_train': None, 'lr': 0.01, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 0.45, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 1, 'weight_init': 'normal', 'weight_init_range': 0.4252586358998573, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.5, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 1536, 'kernel_size': 3, 'in_channels': 384, 'lr_scheduler': {'lr': 0.01, 'adaptive': True, 'nb_epochs': 1, 'ratio': 0.00032, 'speed': 7, 'div': 96, 'decay': 'linear', 'power_lr': 0.5}}
CONFIG: {'arch': 'CNN', 'nb_train': None, 'lr': 0.01, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 0.25, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 1, 'weight_init': 'normal', 'weight_init_range': 0.21262931794992865, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.5, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 6144, 'kernel_size': 3, 'in_channels': 1536, 'lr_scheduler': {'lr': 0.01, 'adaptive': True, 'nb_epochs': 1, 'ratio': 0.00032, 'speed': 7, 'div': 96, 'decay': 'linear', 'power_lr': 0.5}}
CONFIG: {'arch': 'MLP', 'lr': 0.05, 'adaptive': True, 'lr_sup': 0.001, 'speed': 0.4, 'lr_div': 100, 'lebesgue_p': 2, 't_invert': 10, 'beta': 0.01, 'power': 4.5, 'ranking_param': 3, 'delta': 0.1, 'hebbian': False, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'lr_bias': 600, 'softness': 'soft', 'soft_activation_fn': 'exp', 'plasticity': 'SoftHebb', 'metric_mode': 'unsupervised', 'weight_init': 'positive', 'weight_init_range': 0.036828478186799345, 'weight_init_offset': 0, 'weight_decay': 0, 'radius': 10, 'power_lr': 0.2, 'out_channels': 10, 'in_channels': 221184, 'old_channels': 6144, 'lr_scheduler': {'decay': 'cste', 'lr': 0.1}}

 Model STL10_ImageNette_CL loaded successfuly with best perf



 ----- Architecture Block BatchNorm2dSK3962(5, 5)1.0reflect, number 0 -----
- BatchNorm2d(3, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
- HebbSoftKrotovConv2d(3, 96, lebesgue_p=2, pruning=0, kernel_size=(5, 5), bias=False, padding_mode=reflect, t_invert=1.0, bias=False, lr_bias=0.1, ranking_param=3, delta=2, activation=exp)
- Triangle(power=0.7)
- AvgPool2d(kernel_size=4, stride=2, padding=1)

 ----- Architecture Block BatchNorm2dSK963842(3, 3)0.6499999761581421reflect, number 1 -----
- BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
- HebbSoftKrotovConv2d(96, 384, lebesgue_p=2, pruning=0, kernel_size=(3, 3), bias=False, padding_mode=reflect, t_invert=0.6499999761581421, bias=False, lr_bias=0.1538, ranking_param=3, delta=2, activation=exp)
- Triangle(power=0.7)
- MaxPool2d(kernel_size=4, stride=2, padding=1, dilation=1, ceil_mode=False)

 ----- Architecture Block BatchNorm2dSK38415362(3, 3)0.44999998807907104reflect, number 2 -----
- BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
- HebbSoftKrotovConv2d(384, 1536, lebesgue_p=2, pruning=0, kernel_size=(3, 3), bias=False, padding_mode=reflect, t_invert=0.44999998807907104, bias=False, lr_bias=0.2222, ranking_param=3, delta=2, activation=exp)
- Triangle(power=1.4)
- AvgPool2d(kernel_size=4, stride=2, padding=1)

 ----- Architecture Block BatchNorm2dSK153661442(3, 3)0.25reflect, number 3 -----
- BatchNorm2d(1536, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
- HebbSoftKrotovConv2d(1536, 6144, lebesgue_p=2, pruning=0, kernel_size=(3, 3), bias=False, padding_mode=reflect, t_invert=0.25, bias=False, lr_bias=0.4, ranking_param=3, delta=2, activation=exp)
- Triangle(power=1)
- AvgPool2d(kernel_size=2, stride=2, padding=0)

 ----- Architecture Block FlattenDropout(p=0.5, inplace=False)Linear(in_, number 4 -----
- Flatten(start_dim=1, end_dim=-1)
- Dropout(p=0.5, inplace=False)
- Linear(in_features=221184, out_features=10, bias=True)

 ********** Hebbian Unsupervised learning of blocks [0] **********
SEED:  0
BEFORE RESIZING
Files already downloaded and verified
AFTER RESIZING
Files already downloaded and verified
INDICES:  5000
IMAGE SIZE: torch.Size([32, 3, 96, 96])
SAVING FOLDER FOR UNSUP:  STL10_ImageNette_CL
INSIDE EVALUATE UNSUP
INSIDE EVALUATE UNSUP RETURNED 0,0
Epoch: [1/1]	lr: 1.24e-01	time: 00:00:29	Acc_train 0.00	Acc_test 0.00	convergence: 2.40e+01	R1: 0	Info MB:0.000e+00/SB:0.000e+00/MW:3.976e-03/SW:4.612e-01/MR:3.744e+00/SR:1.398e+00/MeD:1.063e+00/MaD:3.387e+00/MW:0.617/MAW:0.383
|       0 |        1 |       2 |       3 |      4 |       5 |       6 |       7 |       8 |       9 |        10 |      11 |      12 |      13 |      14 |      15 |         16 |      17 |     18 |      19 |      20 |        21 |       22 |      23 |      24 |         25 |      26 |      27 |        28 |      29 |
|---------+----------+---------+---------+--------+---------+---------+---------+---------+---------+-----------+---------+---------+---------+---------+---------+------------+---------+--------+---------+---------+-----------+----------+---------+---------+------------+---------+---------+-----------+---------|
|   0.106 |   0.0876 |   0.154 |   0.173 |   0.15 |   0.198 |   0.144 |   0.122 |   0.148 |   0.139 |   0.00133 |   0.149 |   0.186 |   0.129 |   0.109 |   0.122 |   9.57e-05 |   0.163 |   0.11 |   0.136 |   0.142 |   0.00165 |   0.0607 |   0.138 |   0.176 |   7.81e-05 |   0.162 |   0.061 |   0.00189 |   0.172 |
|   2.74  |   2.2    |   4.72  |   5.68  |   4.52 |   7.13  |   4.24  |   3.31  |   4.42  |   4.02  |   1       |   4.46  |   6.43  |   3.6   |   2.84  |   3.32  |   1        |   5.14  |   2.9  |   3.89  |   4.17  |   1       |   1.58   |   3.97  |   5.82  |   1        |   5.09  |   1.58  |   1       |   5.64  |
|   0.36  |   0.42   |   0.36  |   0.41  |   0.46 |   0.4   |   0.33  |   0.4   |   0.32  |   0.49  |   3.09    |   0.45  |   0.34  |   0.45  |   0.43  |   0.45  |  24.67     |   0.38  |   0.41 |   0.43  |   0.48  |   1.1     |   0.42   |   0.47  |   0.45  |  27.94     |   0.33  |   0.47  |   1.11    |   0.38  |
| nan     | nan      | nan     | nan     | nan    | nan     | nan     | nan     | nan     | nan     | nan       | nan     | nan     | nan     | nan     | nan     | nan        | nan     | nan    | nan     | nan     | nan       | nan      | nan     | nan     | nan        | nan     | nan     | nan       | nan     |
| nan     | nan      | nan     | nan     | nan    | nan     | nan     | nan     | nan     | nan     | nan       | nan     | nan     | nan     | nan     | nan     | nan        | nan     | nan    | nan     | nan     | nan       | nan      | nan     | nan     | nan        | nan     | nan     | nan       | nan     |
| nan     | nan      | nan     | nan     | nan    | nan     | nan     | nan     | nan     | nan     | nan       | nan     | nan     | nan     | nan     | nan     | nan        | nan     | nan    | nan     | nan     | nan       | nan      | nan     | nan     | nan        | nan     | nan     | nan       | nan     |

STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/STL10_ImageNette_CL/models

 ********** Hebbian Unsupervised learning of blocks [1] **********
SEED:  0
BEFORE RESIZING
Files already downloaded and verified
AFTER RESIZING
Files already downloaded and verified
INDICES:  5000
IMAGE SIZE: torch.Size([32, 3, 96, 96])
SAVING FOLDER FOR UNSUP:  STL10_ImageNette_CL
INSIDE EVALUATE UNSUP
INSIDE EVALUATE UNSUP RETURNED 0,0
Epoch: [1/1]	lr: 1.24e-01	time: 00:00:58	Acc_train 0.00	Acc_test 0.00	convergence: 2.40e+01	R1: 0	Info MB:0.000e+00/SB:0.000e+00/MW:9.562e-03/SW:9.123e-02/MR:2.382e+00/SR:1.265e+00/MeD:1.062e+00/MaD:4.854e+00/MW:0.612/MAW:0.388
|          0 |         1 |         2 |        3 |         4 |        5 |         6 |         7 |         8 |          9 |        10 |        11 |       12 |        13 |        14 |        15 |         16 |        17 |       18 |       19 |        20 |        21 |       22 |        23 |         24 |        25 |        26 |         27 |        28 |        29 |
|------------+-----------+-----------+----------+-----------+----------+-----------+-----------+-----------+------------+-----------+-----------+----------+-----------+-----------+-----------+------------+-----------+----------+----------+-----------+-----------+----------+-----------+------------+-----------+-----------+------------+-----------+-----------|
|   0.000339 |   0.00816 |   0.00747 |   0.0106 |   0.00222 |   0.0101 |   0.00228 |   8.2e-05 |   0.00578 |   0.000131 |   0.00685 |   0.00651 |   0.0021 |   0.00138 |   0.00706 |   0.00533 |   0.000917 |   0.00065 |   0.0106 |   0.0066 |   0.00727 |   0.00203 |   0.0079 |   0.00373 |   0.000436 |   0.00574 |   0.00957 |   0.000295 |   0.00452 |   0.00101 |
|   1        |   3.67    |   3.23    |   5.46   |   1.2     |   5.09   |   1.21    |   1       |   2.34    |   1        |   2.88    |   2.7     |   1.18   |   1.08    |   2.99    |   2.14    |   1.03     |   1.02    |   5.46   |   2.74   |   3.12    |   1.16    |   3.49   |   1.56    |   1.01     |   2.32    |   4.66    |   1        |   1.82    |   1.04    |
|   0.52     |   0.06    |   0.08    |   0.1    |   0.12    |   0.13   |   0.18    |   2.18    |   0.05    |   1.38     |   0.09    |   0.04    |   0.13   |   0.17    |   0.07    |   0.07    |   0.2      |   0.42    |   0.18   |   0.07   |   0.08    |   0.21    |   0.11   |   0.1     |   0.24     |   0.09    |   0.12    |   0.51     |   0.08    |   0.28    |
| nan        | nan       | nan       | nan      | nan       | nan      | nan       | nan       | nan       | nan        | nan       | nan       | nan      | nan       | nan       | nan       | nan        | nan       | nan      | nan      | nan       | nan       | nan      | nan       | nan        | nan       | nan       | nan        | nan       | nan       |
| nan        | nan       | nan       | nan      | nan       | nan      | nan       | nan       | nan       | nan        | nan       | nan       | nan      | nan       | nan       | nan       | nan        | nan       | nan      | nan      | nan       | nan       | nan      | nan       | nan        | nan       | nan       | nan        | nan       | nan       |
| nan        | nan       | nan       | nan      | nan       | nan      | nan       | nan       | nan       | nan        | nan       | nan       | nan      | nan       | nan       | nan       | nan        | nan       | nan      | nan      | nan       | nan       | nan      | nan       | nan        | nan       | nan       | nan        | nan       | nan       |

STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/STL10_ImageNette_CL/models

 ********** Hebbian Unsupervised learning of blocks [2] **********
SEED:  0
BEFORE RESIZING
Files already downloaded and verified
AFTER RESIZING
Files already downloaded and verified
INDICES:  5000
IMAGE SIZE: torch.Size([32, 3, 96, 96])
SAVING FOLDER FOR UNSUP:  STL10_ImageNette_CL
INSIDE EVALUATE UNSUP
INSIDE EVALUATE UNSUP RETURNED 0,0
Epoch: [1/1]	lr: 4.90e-02	time: 00:01:28	Acc_train 0.00	Acc_test 0.00	convergence: 2.40e+01	R1: 0	Info MB:0.000e+00/SB:0.000e+00/MW:4.324e-03/SW:1.136e-01/MR:6.019e+00/SR:2.899e+00/MeD:2.416e+00/MaD:7.211e+00/MW:0.633/MAW:0.367
|        0 |        1 |        2 |        3 |        4 |        5 |        6 |        7 |        8 |        9 |       10 |       11 |       12 |       13 |       14 |       15 |       16 |      17 |        18 |       19 |        20 |       21 |         22 |       23 |       24 |       25 |       26 |       27 |       28 |        29 |
|----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+---------+-----------+----------+-----------+----------+------------+----------+----------+----------+----------+----------+----------+-----------|
|   0.0274 |   0.0254 |   0.0237 |   0.0163 |   0.0115 |   0.0284 |   0.0259 |   0.0256 |   0.0279 |   0.0278 |   0.0237 |   0.0021 |   0.0129 |   0.0262 |   0.0163 |   0.0251 |   0.0275 |   0.023 |   0.00032 |   0.0298 |   0.00992 |   0.0244 |   0.000391 |   0.0255 |   0.0278 |   0.0247 |   0.0186 |   0.0161 |   0.0258 |   0.00161 |
|   8.48   |   7.43   |   6.61   |   3.64   |   2.32   |   9.06   |   7.71   |   7.53   |   8.81   |   8.7    |   6.64   |   1.04   |   2.66   |   7.88   |   3.64   |   7.32   |   8.58   |   6.29  |   1       |   9.9    |   1.98    |   6.96   |   1        |   7.48   |   8.71   |   7.1    |   4.46   |   3.61   |   7.66   |   1.03    |
|   0.01   |   0.01   |   0.01   |   0      |   0      |   0.02   |   0.02   |   0.01   |   0.02   |   0.04   |   0.03   |   0.04   |   0.01   |   0.01   |   0      |   0.02   |   0.01   |   0.02  |   0.21    |   0.02   |   0.01    |   0      |   0.38     |   0.03   |   0.02   |   0.01   |   0      |   0.01   |   0.01   |   0.07    |
| nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan     | nan       | nan      | nan       | nan      | nan        | nan      | nan      | nan      | nan      | nan      | nan      | nan       |
| nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan     | nan       | nan      | nan       | nan      | nan        | nan      | nan      | nan      | nan      | nan      | nan      | nan       |
| nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan     | nan       | nan      | nan       | nan      | nan        | nan      | nan      | nan      | nan      | nan      | nan      | nan       |

STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/STL10_ImageNette_CL/models

 ********** Hebbian Unsupervised learning of blocks [3] **********
SEED:  0
BEFORE RESIZING
Files already downloaded and verified
AFTER RESIZING
Files already downloaded and verified
INDICES:  5000
IMAGE SIZE: torch.Size([32, 3, 96, 96])
SAVING FOLDER FOR UNSUP:  STL10_ImageNette_CL
INSIDE EVALUATE UNSUP
INSIDE EVALUATE UNSUP RETURNED 0,0
Epoch: [1/1]	lr: 2.03e-02	time: 00:02:09	Acc_train 0.00	Acc_test 0.00	convergence: 1.20e+01	R1: 44	Info MB:0.000e+00/SB:0.000e+00/MW:4.254e-03/SW:1.157e-01/MR:1.298e+01/SR:4.097e+00/MeD:3.060e+00/MaD:1.198e+01/MW:0.527/MAW:0.473
|        0 |       1 |        2 |        3 |        4 |        5 |       6 |         7 |        8 |        9 |       10 |       11 |       12 |       13 |       14 |       15 |       16 |       17 |       18 |      19 |       20 |       21 |       22 |       23 |       24 |       25 |       26 |       27 |       28 |       29 |
|----------+---------+----------+----------+----------+----------+---------+-----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+---------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------|
|   0.0424 |   0.038 |   0.0367 |   0.0326 |   0.0376 |   0.0387 |   0.038 |   0.00881 |   0.0423 |   0.0384 |   0.0375 |   0.0382 |   0.0403 |   0.0345 |   0.0374 |   0.0365 |   0.0274 |   0.0413 |   0.0309 |   0.012 |   0.0342 |   0.0369 |   0.0399 |   0.0273 |   0.0338 |   0.0396 |   0.0163 |   0.0375 |   0.0403 |   0.0357 |
|  18.97   |  15.46  |  14.47   |  11.64   |  15.11   |  15.95   |  15.43  |   1.78    |  18.86   |  15.73   |  15.06   |  15.6    |  17.2    |  12.93   |  14.95   |  14.34   |   8.51   |  18.06   |  10.55   |   2.45  |  12.7    |  14.61   |  16.92   |   8.45   |  12.44   |  16.68   |   3.66   |  15.04   |  17.22   |  13.78   |
|   0.01   |   0.01  |   0.01   |   0.02   |   0.01   |   0.01   |   0.01  |   0.03    |   0.01   |   0.01   |   0.01   |   0.01   |   0.01   |   0.01   |   0.01   |   0.01   |   0      |   0.01   |   0.01   |   0.02  |   0.01   |   0.01   |   0.02   |   0.01   |   0.01   |   0.01   |   0.01   |   0.01   |   0      |   0.01   |
| nan      | nan     | nan      | nan      | nan      | nan      | nan     | nan       | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan     | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      |
| nan      | nan     | nan      | nan      | nan      | nan      | nan     | nan       | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan     | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      |
| nan      | nan     | nan      | nan      | nan      | nan      | nan     | nan       | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan     | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      |

STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/STL10_ImageNette_CL/models
SEED:  0
BEFORE RESIZING
Files already downloaded and verified
AFTER RESIZING
Files already downloaded and verified
INDICES:  5000
IMAGE SIZE: torch.Size([64, 3, 96, 96])
Accuracy of the network on the 1st dataset: 15.863 %
Test loss on the 1st dataset: 20.548
CL:  True
{'name': 'ImageNette', 'noise_std': 0, 'channels': 3, 'width': 160, 'height': 160, 'validation_split': 0.2, 'training_sample': 9469, 'testing_sample': 10000, 'out_channels': 10, 'num_workers': 0, 'seed': 0, 'shuffle': True, 'batch_size': 32, 'augmentation': False, 'zca_whitened': False, 'training_class': 'all', 'split': 'train', 'px': 160, 'nb_epoch': 50, 'print_freq': 10, 'validation': False, 'continual_learning': True}
CL:  True
{'name': 'ImageNette', 'noise_std': 0, 'channels': 3, 'width': 160, 'height': 160, 'validation_split': 0.2, 'training_sample': 9469, 'testing_sample': 10000, 'out_channels': 10, 'num_workers': 0, 'seed': 0, 'shuffle': True, 'batch_size': 10, 'augmentation': False, 'zca_whitened': False, 'training_class': 'all', 'split': 'train', 'px': 160, 'nb_epoch': 1, 'print_freq': 10, 'validation': False, 'continual_learning': True}
SEED:  0
block 0, size : 96 80 80
range = 2.886751345948129
block 1, size : 384 40 40
range = 0.8505172717997146
block 2, size : 1536 20 20
range = 0.4252586358998573
block 3, size : 6144 10 10
range = 0.21262931794992865
range = 0.02209708691207961
The device used will be: 
True
cuda:0
CONFIG: {'arch': 'CNN', 'nb_train': None, 'lr': 0.08, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 1.0, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 2, 'weight_init': 'normal', 'weight_init_range': 2.886751345948129, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.5, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 96, 'kernel_size': 5, 'in_channels': 3, 'lr_scheduler': {'lr': 0.08, 'adaptive': True, 'nb_epochs': 1, 'ratio': 0.00032, 'speed': 7, 'div': 96, 'decay': 'linear', 'power_lr': 0.5}}
CONFIG: {'arch': 'CNN', 'nb_train': None, 'lr': 0.005, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 0.65, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 1, 'weight_init': 'normal', 'weight_init_range': 0.8505172717997146, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.5, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 384, 'kernel_size': 3, 'in_channels': 96, 'lr_scheduler': {'lr': 0.005, 'adaptive': True, 'nb_epochs': 1, 'ratio': 0.00032, 'speed': 7, 'div': 96, 'decay': 'linear', 'power_lr': 0.5}}
CONFIG: {'arch': 'CNN', 'nb_train': None, 'lr': 0.01, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 0.45, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 1, 'weight_init': 'normal', 'weight_init_range': 0.4252586358998573, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.5, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 1536, 'kernel_size': 3, 'in_channels': 384, 'lr_scheduler': {'lr': 0.01, 'adaptive': True, 'nb_epochs': 1, 'ratio': 0.00032, 'speed': 7, 'div': 96, 'decay': 'linear', 'power_lr': 0.5}}
CONFIG: {'arch': 'CNN', 'nb_train': None, 'lr': 0.01, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 0.25, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 1, 'weight_init': 'normal', 'weight_init_range': 0.21262931794992865, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.5, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 6144, 'kernel_size': 3, 'in_channels': 1536, 'lr_scheduler': {'lr': 0.01, 'adaptive': True, 'nb_epochs': 1, 'ratio': 0.00032, 'speed': 7, 'div': 96, 'decay': 'linear', 'power_lr': 0.5}}
CONFIG: {'arch': 'MLP', 'lr': 0.05, 'adaptive': True, 'lr_sup': 0.001, 'speed': 0.4, 'lr_div': 100, 'lebesgue_p': 2, 't_invert': 10, 'beta': 0.01, 'power': 4.5, 'ranking_param': 3, 'delta': 0.1, 'hebbian': False, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'lr_bias': 600, 'softness': 'soft', 'soft_activation_fn': 'exp', 'plasticity': 'SoftHebb', 'metric_mode': 'unsupervised', 'weight_init': 'positive', 'weight_init_range': 0.036828478186799345, 'weight_init_offset': 0, 'weight_decay': 0, 'radius': 10, 'power_lr': 0.2, 'out_channels': 10, 'in_channels': 221184, 'old_channels': 6144, 'lr_scheduler': {'decay': 'cste', 'lr': 0.1}}

 Model STL10_ImageNette_CL loaded successfuly with best perf



 ----- Architecture Block BatchNorm2dSK3962(5, 5)1.0reflect, number 0 -----
- BatchNorm2d(3, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
- HebbSoftKrotovConv2d(3, 96, lebesgue_p=2, pruning=0, kernel_size=(5, 5), bias=False, padding_mode=reflect, t_invert=1.0, bias=False, lr_bias=0.1, ranking_param=3, delta=2, activation=exp)
- Triangle(power=0.7)
- AvgPool2d(kernel_size=4, stride=2, padding=1)

 ----- Architecture Block BatchNorm2dSK963842(3, 3)0.6499999761581421reflect, number 1 -----
- BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
- HebbSoftKrotovConv2d(96, 384, lebesgue_p=2, pruning=0, kernel_size=(3, 3), bias=False, padding_mode=reflect, t_invert=0.6499999761581421, bias=False, lr_bias=0.1538, ranking_param=3, delta=2, activation=exp)
- Triangle(power=0.7)
- MaxPool2d(kernel_size=4, stride=2, padding=1, dilation=1, ceil_mode=False)

 ----- Architecture Block BatchNorm2dSK38415362(3, 3)0.44999998807907104reflect, number 2 -----
- BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
- HebbSoftKrotovConv2d(384, 1536, lebesgue_p=2, pruning=0, kernel_size=(3, 3), bias=False, padding_mode=reflect, t_invert=0.44999998807907104, bias=False, lr_bias=0.2222, ranking_param=3, delta=2, activation=exp)
- Triangle(power=1.4)
- AvgPool2d(kernel_size=4, stride=2, padding=1)

 ----- Architecture Block BatchNorm2dSK153661442(3, 3)0.25reflect, number 3 -----
- BatchNorm2d(1536, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
- HebbSoftKrotovConv2d(1536, 6144, lebesgue_p=2, pruning=0, kernel_size=(3, 3), bias=False, padding_mode=reflect, t_invert=0.25, bias=False, lr_bias=0.4, ranking_param=3, delta=2, activation=exp)
- Triangle(power=1)
- AvgPool2d(kernel_size=2, stride=2, padding=0)

 ----- Architecture Block FlattenDropout(p=0.5, inplace=False)Linear(in_, number 4 -----
- Flatten(start_dim=1, end_dim=-1)
- Dropout(p=0.5, inplace=False)
- Linear(in_features=221184, out_features=10, bias=True)

 ********** Hebbian Unsupervised learning of blocks [0] **********
SEED:  0
BEFORE RESIZING
AFTER RESIZING
INDICES:  9469
IMAGE SIZE: torch.Size([10, 3, 96, 96])
SAVING FOLDER FOR UNSUP:  STL10_ImageNette_CL
INSIDE EVALUATE UNSUP
INSIDE EVALUATE UNSUP RETURNED 0,0
Epoch: [1/1]	lr: 1.34e-01	time: 00:00:55	Acc_train 0.00	Acc_test 0.00	convergence: 2.40e+01	R1: 0	Info MB:0.000e+00/SB:0.000e+00/MW:7.534e-03/SW:5.632e-01/MR:4.350e+00/SR:2.220e+00/MeD:1.679e+00/MaD:5.816e+00/MW:0.651/MAW:0.349
|        0 |        1 |       2 |       3 |       4 |      5 |       6 |       7 |       8 |       9 |        10 |      11 |      12 |      13 |     14 |      15 |         16 |      17 |       18 |     19 |      20 |         21 |       22 |      23 |      24 |         25 |      26 |       27 |         28 |      29 |
|----------+----------+---------+---------+---------+--------+---------+---------+---------+---------+-----------+---------+---------+---------+--------+---------+------------+---------+----------+--------+---------+------------+----------+---------+---------+------------+---------+----------+------------+---------|
|   0.0956 |   0.0915 |   0.208 |   0.198 |   0.157 |   0.24 |   0.191 |   0.103 |   0.164 |   0.147 |   0.00117 |   0.158 |   0.234 |   0.178 |   0.1  |   0.106 |   0.000254 |   0.199 |   0.0882 |   0.14 |   0.147 |   0.000562 |   0.0632 |   0.143 |   0.203 |   0.000165 |   0.217 |   0.0433 |   0.000585 |   0.195 |
|   2.43   |   2.31   |   7.77  |   7.1   |   4.87  |   9.99 |   6.7   |   2.67  |   5.19  |   4.38  |   1       |   4.92  |   9.57  |   5.95  |   2.58 |   2.74  |   1        |   7.21  |   2.22   |   4.06 |   4.38  |   1        |   1.62   |   4.21  |   7.42  |   1        |   8.38  |   1.29   |   1        |   6.94  |
|   0.37   |   0.36   |   0.34  |   0.38  |   0.43  |   0.35 |   0.3   |   0.38  |   0.32  |   0.44  |   3.08    |   0.41  |   0.31  |   0.44  |   0.41 |   0.43  |  23.93     |   0.34  |   0.4    |   0.39 |   0.43  |   1.27     |   0.38   |   0.43  |   0.39  |  31.02     |   0.3   |   0.49   |   1.27     |   0.34  |
| nan      | nan      | nan     | nan     | nan     | nan    | nan     | nan     | nan     | nan     | nan       | nan     | nan     | nan     | nan    | nan     | nan        | nan     | nan      | nan    | nan     | nan        | nan      | nan     | nan     | nan        | nan     | nan      | nan        | nan     |
| nan      | nan      | nan     | nan     | nan     | nan    | nan     | nan     | nan     | nan     | nan       | nan     | nan     | nan     | nan    | nan     | nan        | nan     | nan      | nan    | nan     | nan        | nan      | nan     | nan     | nan        | nan     | nan      | nan        | nan     |
| nan      | nan      | nan     | nan     | nan     | nan    | nan     | nan     | nan     | nan     | nan       | nan     | nan     | nan     | nan    | nan     | nan        | nan     | nan      | nan    | nan     | nan        | nan      | nan     | nan     | nan        | nan     | nan      | nan        | nan     |

STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/STL10_ImageNette_CL/models

 ********** Hebbian Unsupervised learning of blocks [1] **********
SEED:  0
BEFORE RESIZING
AFTER RESIZING
INDICES:  9469
IMAGE SIZE: torch.Size([10, 3, 96, 96])
SAVING FOLDER FOR UNSUP:  STL10_ImageNette_CL
INSIDE EVALUATE UNSUP
INSIDE EVALUATE UNSUP RETURNED 0,0
Epoch: [1/1]	lr: 1.34e-01	time: 00:01:46	Acc_train 0.00	Acc_test 0.00	convergence: 2.40e+01	R1: 0	Info MB:0.000e+00/SB:0.000e+00/MW:9.494e-03/SW:9.264e-02/MR:2.400e+00/SR:1.318e+00/MeD:1.105e+00/MaD:4.319e+00/MW:0.662/MAW:0.338
|         0 |         1 |        2 |        3 |         4 |        5 |         6 |          7 |         8 |          9 |       10 |        11 |        12 |        13 |        14 |        15 |         16 |         17 |       18 |        19 |        20 |        21 |        22 |        23 |         24 |        25 |        26 |         27 |        28 |         29 |
|-----------+-----------+----------+----------+-----------+----------+-----------+------------+-----------+------------+----------+-----------+-----------+-----------+-----------+-----------+------------+------------+----------+-----------+-----------+-----------+-----------+-----------+------------+-----------+-----------+------------+-----------+------------|
|   0.00031 |   0.00849 |   0.0078 |   0.0109 |   0.00208 |   0.0102 |   0.00204 |   6.59e-05 |   0.00557 |   9.29e-05 |   0.0062 |   0.00685 |   0.00208 |   0.00112 |   0.00762 |   0.00573 |   0.000764 |   0.000583 |   0.0104 |   0.00692 |   0.00698 |   0.00168 |   0.00727 |   0.00348 |   0.000445 |   0.00602 |   0.00928 |   0.000264 |   0.00432 |   0.000782 |
|   1       |   3.88    |   3.43   |   5.76   |   1.17    |   5.17   |   1.17    |   1        |   2.24    |   1        |   2.54   |   2.88    |   1.17    |   1.05    |   3.32    |   2.31    |   1.02     |   1.01     |   5.3    |   2.92    |   2.95    |   1.11    |   3.11    |   1.49    |   1.01     |   2.45    |   4.44    |   1        |   1.75    |   1.02     |
|   0.38    |   0.05    |   0.09   |   0.09   |   0.1     |   0.11   |   0.16    |   2.05     |   0.04    |   1.86     |   0.08   |   0.02    |   0.11    |   0.22    |   0.04    |   0.04    |   0.24     |   0.34     |   0.1    |   0.05    |   0.07    |   0.21    |   0.12    |   0.08    |   0.1      |   0.08    |   0.08    |   0.48     |   0.09    |   0.33     |
| nan       | nan       | nan      | nan      | nan       | nan      | nan       | nan        | nan       | nan        | nan      | nan       | nan       | nan       | nan       | nan       | nan        | nan        | nan      | nan       | nan       | nan       | nan       | nan       | nan        | nan       | nan       | nan        | nan       | nan        |
| nan       | nan       | nan      | nan      | nan       | nan      | nan       | nan        | nan       | nan        | nan      | nan       | nan       | nan       | nan       | nan       | nan        | nan        | nan      | nan       | nan       | nan       | nan       | nan       | nan        | nan       | nan       | nan        | nan       | nan        |
| nan       | nan       | nan      | nan      | nan       | nan      | nan       | nan        | nan       | nan        | nan      | nan       | nan       | nan       | nan       | nan       | nan        | nan        | nan      | nan       | nan       | nan       | nan       | nan       | nan        | nan       | nan       | nan        | nan       | nan        |

STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/STL10_ImageNette_CL/models

 ********** Hebbian Unsupervised learning of blocks [2] **********
SEED:  0
BEFORE RESIZING
AFTER RESIZING
INDICES:  9469
IMAGE SIZE: torch.Size([10, 3, 96, 96])
SAVING FOLDER FOR UNSUP:  STL10_ImageNette_CL
INSIDE EVALUATE UNSUP
INSIDE EVALUATE UNSUP RETURNED 0,0
Epoch: [1/1]	lr: 4.90e-02	time: 00:02:36	Acc_train 0.00	Acc_test 0.00	convergence: 2.40e+01	R1: 0	Info MB:0.000e+00/SB:0.000e+00/MW:4.269e-03/SW:1.136e-01/MR:5.985e+00/SR:2.978e+00/MeD:2.520e+00/MaD:6.846e+00/MW:0.652/MAW:0.348
|        0 |        1 |        2 |        3 |        4 |        5 |        6 |        7 |        8 |        9 |       10 |        11 |       12 |       13 |       14 |       15 |       16 |       17 |         18 |       19 |        20 |       21 |         22 |      23 |       24 |      25 |       26 |       27 |       28 |        29 |
|----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+-----------+----------+----------+----------+----------+----------+----------+------------+----------+-----------+----------+------------+---------+----------+---------+----------+----------+----------+-----------|
|   0.0308 |   0.0266 |   0.0242 |   0.0162 |   0.0117 |   0.0287 |   0.0267 |   0.0263 |   0.0282 |   0.0296 |   0.0228 |   0.00127 |   0.0115 |   0.0277 |   0.0166 |   0.0231 |   0.0288 |   0.0254 |   0.000286 |   0.0279 |   0.00972 |   0.0275 |   0.000323 |   0.025 |   0.0283 |   0.025 |   0.0192 |   0.0166 |   0.0244 |   0.00128 |
|  10.46   |   8.08   |   6.84   |   3.63   |   2.36   |   9.24   |   8.14   |   7.89   |   8.92   |   9.79   |   6.19   |   1.02    |   2.32   |   8.67   |   3.76   |   6.34   |   9.3    |   7.45   |   1        |   8.78   |   1.94    |   8.54   |   1        |   7.26  |   8.98   |   7.24  |   4.68   |   3.77   |   6.93   |   1.02    |
|   0      |   0.01   |   0.01   |   0.01   |   0      |   0.01   |   0.02   |   0.01   |   0.02   |   0.01   |   0.02   |   0.11    |   0.01   |   0.01   |   0      |   0.02   |   0.01   |   0.01   |   0.24     |   0.02   |   0.01    |   0.01   |   0.41     |   0.02  |   0.02   |   0.01  |   0      |   0.01   |   0.01   |   0.09    |
| nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan       | nan      | nan      | nan      | nan      | nan      | nan      | nan        | nan      | nan       | nan      | nan        | nan     | nan      | nan     | nan      | nan      | nan      | nan       |
| nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan       | nan      | nan      | nan      | nan      | nan      | nan      | nan        | nan      | nan       | nan      | nan        | nan     | nan      | nan     | nan      | nan      | nan      | nan       |
| nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan       | nan      | nan      | nan      | nan      | nan      | nan      | nan        | nan      | nan       | nan      | nan        | nan     | nan      | nan     | nan      | nan      | nan      | nan       |

STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/STL10_ImageNette_CL/models

 ********** Hebbian Unsupervised learning of blocks [3] **********
SEED:  0
BEFORE RESIZING
AFTER RESIZING
INDICES:  9469
IMAGE SIZE: torch.Size([10, 3, 96, 96])
SAVING FOLDER FOR UNSUP:  STL10_ImageNette_CL
INSIDE EVALUATE UNSUP
INSIDE EVALUATE UNSUP RETURNED 0,0
Epoch: [1/1]	lr: 2.01e-02	time: 00:03:56	Acc_train 0.00	Acc_test 0.00	convergence: 1.12e+01	R1: 46	Info MB:0.000e+00/SB:0.000e+00/MW:4.422e-03/SW:1.089e-01/MR:1.217e+01/SR:4.025e+00/MeD:3.057e+00/MaD:1.117e+01/MW:0.539/MAW:0.461
|        0 |       1 |       2 |        3 |        4 |        5 |        6 |         7 |        8 |        9 |       10 |       11 |       12 |       13 |       14 |       15 |       16 |       17 |       18 |       19 |       20 |       21 |       22 |       23 |       24 |       25 |      26 |       27 |       28 |       29 |
|----------+---------+---------+----------+----------+----------+----------+-----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+---------+----------+----------+----------|
|   0.0391 |   0.038 |   0.034 |   0.0339 |   0.0357 |   0.0341 |   0.0405 |   0.00925 |   0.0417 |   0.0355 |   0.0353 |   0.0398 |   0.0378 |   0.0315 |   0.0386 |   0.0355 |   0.0276 |   0.0391 |   0.0306 |   0.0113 |   0.0329 |   0.0324 |   0.0391 |   0.0221 |   0.0339 |   0.0314 |   0.017 |   0.0377 |   0.0375 |   0.0331 |
|  16.32   |  15.47  |  12.59  |  12.51   |  13.78   |  12.63   |  17.44   |   1.86    |  18.37   |  13.59   |  13.45   |  16.88   |  15.29   |  10.95   |  15.94   |  13.6    |   8.59   |  16.29   |  10.33   |   2.28   |  11.81   |  11.52   |  16.29   |   5.9    |  12.5    |  10.83   |   3.9   |  15.24   |  15.08   |  11.92   |
|   0.02   |   0.01  |   0.01  |   0      |   0.01   |   0.02   |   0.01   |   0.01    |   0.02   |   0.01   |   0.01   |   0.01   |   0.01   |   0.01   |   0.01   |   0.01   |   0.01   |   0.01   |   0      |   0.03   |   0.01   |   0.01   |   0.01   |   0.01   |   0      |   0.02   |   0     |   0.01   |   0.01   |   0.01   |
| nan      | nan     | nan     | nan      | nan      | nan      | nan      | nan       | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan     | nan      | nan      | nan      |
| nan      | nan     | nan     | nan      | nan      | nan      | nan      | nan       | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan     | nan      | nan      | nan      |
| nan      | nan     | nan     | nan      | nan      | nan      | nan      | nan       | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan     | nan      | nan      | nan      |

STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/STL10_ImageNette_CL/models

 ********** Supervised learning of blocks [4] **********
SAVING FOLDER FOR SUP:  STL10_ImageNette_CL
SEED:  0
BEFORE RESIZING
AFTER RESIZING
INDICES:  9469
IMAGE SIZE: torch.Size([32, 3, 96, 96])
Epoch: [1/50]	lr: 1.00e-03	time: 00:04:40	Loss_train 0.77494	Acc_train 94.27	/	Loss_test 8.88546	Acc_test 72.89
STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/STL10_ImageNette_CL/models
Epoch: [10/50]	lr: 1.00e-03	time: 00:08:58	Loss_train 0.95495	Acc_train 94.27	/	Loss_test 10.84000	Acc_test 74.14
STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/STL10_ImageNette_CL/models
Epoch: [20/50]	lr: 2.50e-04	time: 00:13:38	Loss_train 0.15581	Acc_train 98.59	/	Loss_test 9.21055	Acc_test 76.43
STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/STL10_ImageNette_CL/models
Epoch: [30/50]	lr: 1.25e-04	time: 00:18:17	Loss_train 0.03924	Acc_train 99.49	/	Loss_test 8.49065	Acc_test 78.04
STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/STL10_ImageNette_CL/models
Epoch: [40/50]	lr: 3.13e-05	time: 00:23:00	Loss_train 0.00894	Acc_train 99.84	/	Loss_test 8.19678	Acc_test 78.65
STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/STL10_ImageNette_CL/models
Epoch: [50/50]	lr: 7.81e-06	time: 00:27:46	Loss_train 0.00509	Acc_train 99.90	/	Loss_test 8.17704	Acc_test 78.32
STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/STL10_ImageNette_CL/models
RESULT:  {'train_loss': 0.005089603830128908, 'train_acc': 99.90283846855164, 'test_loss': 8.177038192749023, 'test_acc': 78.31847381591797, 'convergence': 11.165390014648438, 'R1': 46, 'dataset_sup': {'name': 'ImageNette', 'noise_std': 0, 'channels': 3, 'width': 160, 'height': 160, 'validation_split': 0.2, 'training_sample': 9469, 'testing_sample': 10000, 'out_channels': 10, 'num_workers': 0, 'seed': 0, 'shuffle': True, 'batch_size': 32, 'augmentation': False, 'zca_whitened': False, 'training_class': 'all', 'split': 'train', 'px': 160, 'nb_epoch': 50, 'print_freq': 10, 'validation': False, 'continual_learning': True, 'old_dataset_size': 96}, 'dataset_unsup': {'name': 'ImageNette', 'noise_std': 0, 'channels': 3, 'width': 160, 'height': 160, 'validation_split': 0.2, 'training_sample': 9469, 'testing_sample': 10000, 'out_channels': 10, 'num_workers': 0, 'seed': 0, 'shuffle': True, 'batch_size': 10, 'augmentation': False, 'zca_whitened': False, 'training_class': 'all', 'split': 'train', 'px': 160, 'nb_epoch': 1, 'print_freq': 10, 'validation': False, 'continual_learning': True, 'old_dataset_size': 96}, 'train_config': {'t0': {'blocks': [0], 'mode': 'unsupervised', 'lr': 0.08, 'nb_epoch': 1, 'batch_size': 10, 'print_freq': 10}, 't2': {'blocks': [1], 'mode': 'unsupervised', 'lr': 0.005, 'nb_epoch': 1, 'batch_size': 10, 'print_freq': 10}, 't4': {'blocks': [2], 'mode': 'unsupervised', 'lr': 0.01, 'nb_epoch': 1, 'batch_size': 10, 'print_freq': 10}, 't6': {'blocks': [3], 'mode': 'unsupervised', 'lr': 0.01, 'nb_epoch': 1, 'batch_size': 10, 'print_freq': 10}, 't8': {'blocks': [4], 'mode': 'supervised', 'lr': 0.001, 'nb_epoch': 50, 'batch_size': 32, 'print_freq': 10}}}
IN R1:  {'eval_1': {'test_loss': 20.548364639282227, 'test_acc': 15.862500190734863, 'convergence': 11.983084678649902, 'R1': 44, 'dataset_sup': {'name': 'STL10', 'noise_std': 0, 'channels': 3, 'width': 96, 'height': 96, 'validation_split': 0.2, 'training_sample': 5000, 'testing_sample': 10000, 'out_channels': 10, 'num_workers': 4, 'seed': 0, 'shuffle': True, 'batch_size': 64, 'augmentation': True, 'zca_whitened': False, 'training_class': 'all', 'split': 'train', 'nb_epoch': 100, 'print_freq': 10, 'validation': False, 'continual_learning': False}, 'dataset_unsup': {'name': 'STL10', 'noise_std': 0, 'channels': 3, 'width': 96, 'height': 96, 'validation_split': 0.2, 'training_sample': 100000, 'testing_sample': 10000, 'out_channels': 10, 'num_workers': 0, 'seed': 0, 'shuffle': True, 'batch_size': 32, 'augmentation': False, 'zca_whitened': False, 'training_class': 'all', 'split': 'unlabeled', 'nb_epoch': 1, 'print_freq': 25, 'validation': False, 'continual_learning': False}}, 'R1': {'train_loss': 0.005089603830128908, 'train_acc': 99.90283846855164, 'test_loss': 8.177038192749023, 'test_acc': 78.31847381591797, 'convergence': 11.165390014648438, 'R1': 46, 'dataset_sup': {'name': 'ImageNette', 'noise_std': 0, 'channels': 3, 'width': 160, 'height': 160, 'validation_split': 0.2, 'training_sample': 9469, 'testing_sample': 10000, 'out_channels': 10, 'num_workers': 0, 'seed': 0, 'shuffle': True, 'batch_size': 32, 'augmentation': False, 'zca_whitened': False, 'training_class': 'all', 'split': 'train', 'px': 160, 'nb_epoch': 50, 'print_freq': 10, 'validation': False, 'continual_learning': True, 'old_dataset_size': 96}, 'dataset_unsup': {'name': 'ImageNette', 'noise_std': 0, 'channels': 3, 'width': 160, 'height': 160, 'validation_split': 0.2, 'training_sample': 9469, 'testing_sample': 10000, 'out_channels': 10, 'num_workers': 0, 'seed': 0, 'shuffle': True, 'batch_size': 10, 'augmentation': False, 'zca_whitened': False, 'training_class': 'all', 'split': 'train', 'px': 160, 'nb_epoch': 1, 'print_freq': 10, 'validation': False, 'continual_learning': True, 'old_dataset_size': 96}, 'train_config': {'t0': {'blocks': [0], 'mode': 'unsupervised', 'lr': 0.08, 'nb_epoch': 1, 'batch_size': 10, 'print_freq': 10}, 't2': {'blocks': [1], 'mode': 'unsupervised', 'lr': 0.005, 'nb_epoch': 1, 'batch_size': 10, 'print_freq': 10}, 't4': {'blocks': [2], 'mode': 'unsupervised', 'lr': 0.01, 'nb_epoch': 1, 'batch_size': 10, 'print_freq': 10}, 't6': {'blocks': [3], 'mode': 'unsupervised', 'lr': 0.01, 'nb_epoch': 1, 'batch_size': 10, 'print_freq': 10}, 't8': {'blocks': [4], 'mode': 'supervised', 'lr': 0.001, 'nb_epoch': 50, 'batch_size': 32, 'print_freq': 10}}}}
SEED:  0
block 0, size : 96 48 48
range = 2.886751345948129
block 1, size : 384 24 24
range = 0.8505172717997146
block 2, size : 1536 12 12
range = 0.4252586358998573
block 3, size : 6144 6 6
range = 0.21262931794992865
range = 0.036828478186799345
The device used will be: 
True
cuda:0
CONFIG: {'arch': 'CNN', 'nb_train': None, 'lr': 0.08, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 1.0, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 2, 'weight_init': 'normal', 'weight_init_range': 2.886751345948129, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.5, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 96, 'kernel_size': 5, 'in_channels': 3, 'lr_scheduler': {'lr': 0.08, 'adaptive': True, 'nb_epochs': 1, 'ratio': 0.00032, 'speed': 7, 'div': 96, 'decay': 'linear', 'power_lr': 0.5}}
CONFIG: {'arch': 'CNN', 'nb_train': None, 'lr': 0.005, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 0.65, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 1, 'weight_init': 'normal', 'weight_init_range': 0.8505172717997146, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.5, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 384, 'kernel_size': 3, 'in_channels': 96, 'lr_scheduler': {'lr': 0.005, 'adaptive': True, 'nb_epochs': 1, 'ratio': 0.00032, 'speed': 7, 'div': 96, 'decay': 'linear', 'power_lr': 0.5}}
CONFIG: {'arch': 'CNN', 'nb_train': None, 'lr': 0.01, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 0.45, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 1, 'weight_init': 'normal', 'weight_init_range': 0.4252586358998573, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.5, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 1536, 'kernel_size': 3, 'in_channels': 384, 'lr_scheduler': {'lr': 0.01, 'adaptive': True, 'nb_epochs': 1, 'ratio': 0.00032, 'speed': 7, 'div': 96, 'decay': 'linear', 'power_lr': 0.5}}
CONFIG: {'arch': 'CNN', 'nb_train': None, 'lr': 0.01, 'adaptive': True, 'lr_sup': 0.001, 'speed': 7, 'lr_div': 96, 'lebesgue_p': 2, 'padding_mode': 'reflect', 'pre_triangle': False, 'ranking_param': 3, 'delta': 2, 't_invert': 0.25, 'groups': 1, 'stride': 1, 'dilation': 1, 'beta': 1, 'power': 4.5, 'padding': 1, 'weight_init': 'normal', 'weight_init_range': 0.21262931794992865, 'weight_init_offset': 0, 'mask_thsd': 0, 'radius': 25, 'power_lr': 0.5, 'weight_decay': 0, 'soft_activation_fn': 'exp', 'hebbian': True, 'resume': None, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'softness': 'softkrotov', 'out_channels': 6144, 'kernel_size': 3, 'in_channels': 1536, 'lr_scheduler': {'lr': 0.01, 'adaptive': True, 'nb_epochs': 1, 'ratio': 0.00032, 'speed': 7, 'div': 96, 'decay': 'linear', 'power_lr': 0.5}}
CONFIG: {'arch': 'MLP', 'lr': 0.05, 'adaptive': True, 'lr_sup': 0.001, 'speed': 0.4, 'lr_div': 100, 'lebesgue_p': 2, 't_invert': 10, 'beta': 0.01, 'power': 4.5, 'ranking_param': 3, 'delta': 0.1, 'hebbian': False, 'add_bias': False, 'normalize_inp': False, 'lr_decay': 'linear', 'seed': 0, 'lr_bias': 600, 'softness': 'soft', 'soft_activation_fn': 'exp', 'plasticity': 'SoftHebb', 'metric_mode': 'unsupervised', 'weight_init': 'positive', 'weight_init_range': 0.036828478186799345, 'weight_init_offset': 0, 'weight_decay': 0, 'radius': 10, 'power_lr': 0.2, 'out_channels': 10, 'in_channels': 221184, 'old_channels': 6144, 'lr_scheduler': {'decay': 'cste', 'lr': 0.1}}

 Model STL10_ImageNette_CL loaded successfuly with best perf



 ----- Architecture Block BatchNorm2dSK3962(5, 5)1.0reflect, number 0 -----
- BatchNorm2d(3, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
- HebbSoftKrotovConv2d(3, 96, lebesgue_p=2, pruning=0, kernel_size=(5, 5), bias=False, padding_mode=reflect, t_invert=1.0, bias=False, lr_bias=0.1, ranking_param=3, delta=2, activation=exp)
- Triangle(power=0.7)
- AvgPool2d(kernel_size=4, stride=2, padding=1)

 ----- Architecture Block BatchNorm2dSK963842(3, 3)0.6499999761581421reflect, number 1 -----
- BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
- HebbSoftKrotovConv2d(96, 384, lebesgue_p=2, pruning=0, kernel_size=(3, 3), bias=False, padding_mode=reflect, t_invert=0.6499999761581421, bias=False, lr_bias=0.1538, ranking_param=3, delta=2, activation=exp)
- Triangle(power=0.7)
- MaxPool2d(kernel_size=4, stride=2, padding=1, dilation=1, ceil_mode=False)

 ----- Architecture Block BatchNorm2dSK38415362(3, 3)0.44999998807907104reflect, number 2 -----
- BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
- HebbSoftKrotovConv2d(384, 1536, lebesgue_p=2, pruning=0, kernel_size=(3, 3), bias=False, padding_mode=reflect, t_invert=0.44999998807907104, bias=False, lr_bias=0.2222, ranking_param=3, delta=2, activation=exp)
- Triangle(power=1.4)
- AvgPool2d(kernel_size=4, stride=2, padding=1)

 ----- Architecture Block BatchNorm2dSK153661442(3, 3)0.25reflect, number 3 -----
- BatchNorm2d(1536, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
- HebbSoftKrotovConv2d(1536, 6144, lebesgue_p=2, pruning=0, kernel_size=(3, 3), bias=False, padding_mode=reflect, t_invert=0.25, bias=False, lr_bias=0.4, ranking_param=3, delta=2, activation=exp)
- Triangle(power=1)
- AvgPool2d(kernel_size=2, stride=2, padding=0)

 ----- Architecture Block FlattenDropout(p=0.5, inplace=False)Linear(in_, number 4 -----
- Flatten(start_dim=1, end_dim=-1)
- Dropout(p=0.5, inplace=False)
- Linear(in_features=221184, out_features=10, bias=True)

 ********** Hebbian Unsupervised learning of blocks [0] **********
SEED:  0
BEFORE RESIZING
Files already downloaded and verified
AFTER RESIZING
Files already downloaded and verified
INDICES:  5000
IMAGE SIZE: torch.Size([32, 3, 96, 96])
SAVING FOLDER FOR UNSUP:  STL10_ImageNette_CL
INSIDE EVALUATE UNSUP
INSIDE EVALUATE UNSUP RETURNED 0,0
Epoch: [1/1]	lr: 1.24e-01	time: 00:00:28	Acc_train 0.00	Acc_test 0.00	convergence: 2.40e+01	R1: 0	Info MB:0.000e+00/SB:0.000e+00/MW:3.933e-03/SW:4.662e-01/MR:3.775e+00/SR:1.438e+00/MeD:1.099e+00/MaD:3.452e+00/MW:0.618/MAW:0.382
|       0 |        1 |       2 |       3 |       4 |      5 |       6 |       7 |       8 |       9 |        10 |      11 |      12 |      13 |      14 |     15 |         16 |     17 |      18 |      19 |      20 |        21 |       22 |      23 |     24 |         25 |      26 |       27 |        28 |      29 |
|---------+----------+---------+---------+---------+--------+---------+---------+---------+---------+-----------+---------+---------+---------+---------+--------+------------+--------+---------+---------+---------+-----------+----------+---------+--------+------------+---------+----------+-----------+---------|
|   0.105 |   0.0849 |   0.157 |   0.168 |   0.151 |   0.2  |   0.151 |   0.118 |   0.151 |   0.137 |   0.00134 |   0.152 |   0.186 |   0.158 |   0.109 |   0.12 |   9.57e-05 |   0.16 |   0.108 |   0.137 |   0.143 |   0.00182 |   0.0636 |   0.137 |   0.17 |   7.31e-05 |   0.169 |   0.0592 |   0.00195 |   0.172 |
|   2.72  |   2.13   |   4.85  |   5.42  |   4.55  |   7.23 |   4.54  |   3.19  |   4.58  |   3.92  |   1       |   4.62  |   6.42  |   4.89  |   2.85  |   3.26 |   1        |   5    |   2.81  |   3.94  |   4.18  |   1       |   1.63   |   3.93  |   5.5  |   1        |   5.45  |   1.55   |   1       |   5.61  |
|   0.36  |   0.42   |   0.36  |   0.4   |   0.47  |   0.4  |   0.33  |   0.4   |   0.33  |   0.49  |   3.1     |   0.45  |   0.34  |   0.35  |   0.43  |   0.44 |  24.77     |   0.36 |   0.4   |   0.43  |   0.48  |   1.12    |   0.43   |   0.47  |   0.37 |  27.96     |   0.33  |   0.47   |   1.15    |   0.38  |
| nan     | nan      | nan     | nan     | nan     | nan    | nan     | nan     | nan     | nan     | nan       | nan     | nan     | nan     | nan     | nan    | nan        | nan    | nan     | nan     | nan     | nan       | nan      | nan     | nan    | nan        | nan     | nan      | nan       | nan     |
| nan     | nan      | nan     | nan     | nan     | nan    | nan     | nan     | nan     | nan     | nan       | nan     | nan     | nan     | nan     | nan    | nan        | nan    | nan     | nan     | nan     | nan       | nan      | nan     | nan    | nan        | nan     | nan      | nan       | nan     |
| nan     | nan      | nan     | nan     | nan     | nan    | nan     | nan     | nan     | nan     | nan       | nan     | nan     | nan     | nan     | nan    | nan        | nan    | nan     | nan     | nan     | nan       | nan      | nan     | nan    | nan        | nan     | nan      | nan       | nan     |

STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/STL10_ImageNette_CL/models

 ********** Hebbian Unsupervised learning of blocks [1] **********
SEED:  0
BEFORE RESIZING
Files already downloaded and verified
AFTER RESIZING
Files already downloaded and verified
INDICES:  5000
IMAGE SIZE: torch.Size([32, 3, 96, 96])
SAVING FOLDER FOR UNSUP:  STL10_ImageNette_CL
INSIDE EVALUATE UNSUP
INSIDE EVALUATE UNSUP RETURNED 0,0
Epoch: [1/1]	lr: 1.24e-01	time: 00:00:56	Acc_train 0.00	Acc_test 0.00	convergence: 2.40e+01	R1: 0	Info MB:0.000e+00/SB:0.000e+00/MW:9.520e-03/SW:9.170e-02/MR:2.387e+00/SR:1.284e+00/MeD:1.094e+00/MaD:4.425e+00/MW:0.611/MAW:0.389
|          0 |         1 |         2 |        3 |         4 |         5 |         6 |          7 |         8 |          9 |        10 |      11 |        12 |        13 |        14 |        15 |        16 |         17 |     18 |        19 |        20 |        21 |        22 |        23 |         24 |        25 |        26 |         27 |        28 |         29 |
|------------+-----------+-----------+----------+-----------+-----------+-----------+------------+-----------+------------+-----------+---------+-----------+-----------+-----------+-----------+-----------+------------+--------+-----------+-----------+-----------+-----------+-----------+------------+-----------+-----------+------------+-----------+------------|
|   0.000296 |   0.00866 |   0.00799 |   0.0102 |   0.00205 |   0.00954 |   0.00197 |   8.19e-05 |   0.00547 |   9.19e-05 |   0.00603 |   0.007 |   0.00207 |   0.00107 |   0.00782 |   0.00588 |   0.00072 |   0.000564 |   0.01 |   0.00697 |   0.00699 |   0.00159 |   0.00713 |   0.00348 |   0.000448 |   0.00609 |   0.00893 |   0.000255 |   0.00428 |   0.000748 |
|   1        |   4       |   3.55    |   5.19   |   1.17    |   4.64    |   1.15    |   1        |   2.2     |   1        |   2.45    |   2.96  |   1.17    |   1.05    |   3.44    |   2.38    |   1.02    |   1.01     |   5.03 |   2.94    |   2.95    |   1.1     |   3.03    |   1.49    |   1.01     |   2.48    |   4.19    |   1        |   1.73    |   1.02     |
|   0.55     |   0.07    |   0.08    |   0.14   |   0.12    |   0.15    |   0.17    |   2.28     |   0.05    |   1.49     |   0.08    |   0.03  |   0.11    |   0.19    |   0.05    |   0.05    |   0.21    |   0.39     |   0.16 |   0.06    |   0.07    |   0.24    |   0.09    |   0.09    |   0.21     |   0.07    |   0.1     |   0.47     |   0.07    |   0.33     |
| nan        | nan       | nan       | nan      | nan       | nan       | nan       | nan        | nan       | nan        | nan       | nan     | nan       | nan       | nan       | nan       | nan       | nan        | nan    | nan       | nan       | nan       | nan       | nan       | nan        | nan       | nan       | nan        | nan       | nan        |
| nan        | nan       | nan       | nan      | nan       | nan       | nan       | nan        | nan       | nan        | nan       | nan     | nan       | nan       | nan       | nan       | nan       | nan        | nan    | nan       | nan       | nan       | nan       | nan       | nan        | nan       | nan       | nan        | nan       | nan        |
| nan        | nan       | nan       | nan      | nan       | nan       | nan       | nan        | nan       | nan        | nan       | nan     | nan       | nan       | nan       | nan       | nan       | nan        | nan    | nan       | nan       | nan       | nan       | nan       | nan        | nan       | nan       | nan        | nan       | nan        |

STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/STL10_ImageNette_CL/models

 ********** Hebbian Unsupervised learning of blocks [2] **********
SEED:  0
BEFORE RESIZING
Files already downloaded and verified
AFTER RESIZING
Files already downloaded and verified
INDICES:  5000
IMAGE SIZE: torch.Size([32, 3, 96, 96])
SAVING FOLDER FOR UNSUP:  STL10_ImageNette_CL
INSIDE EVALUATE UNSUP
INSIDE EVALUATE UNSUP RETURNED 0,0
Epoch: [1/1]	lr: 4.90e-02	time: 00:01:27	Acc_train 0.00	Acc_test 0.00	convergence: 2.40e+01	R1: 0	Info MB:0.000e+00/SB:0.000e+00/MW:4.292e-03/SW:1.105e-01/MR:5.845e+00/SR:2.840e+00/MeD:2.404e+00/MaD:7.573e+00/MW:0.636/MAW:0.364
|        0 |       1 |        2 |        3 |        4 |        5 |        6 |        7 |        8 |        9 |       10 |        11 |       12 |       13 |       14 |       15 |       16 |       17 |         18 |       19 |        20 |       21 |         22 |       23 |       24 |       25 |       26 |       27 |       28 |        29 |
|----------+---------+----------+----------+----------+----------+----------+----------+----------+----------+----------+-----------+----------+----------+----------+----------+----------+----------+------------+----------+-----------+----------+------------+----------+----------+----------+----------+----------+----------+-----------|
|   0.0311 |   0.026 |   0.0245 |   0.0163 |   0.0117 |   0.0279 |   0.0256 |   0.0267 |   0.0278 |   0.0269 |   0.0221 |   0.00127 |   0.0114 |   0.0274 |   0.0168 |   0.0233 |   0.0282 |   0.0238 |   0.000282 |   0.0277 |   0.00947 |   0.0284 |   0.000325 |   0.0242 |   0.0274 |   0.0249 |   0.0194 |   0.0169 |   0.0253 |   0.00125 |
|  10.65   |   7.77  |   7      |   3.65   |   2.38   |   8.76   |   7.57   |   8.1    |   8.73   |   8.26   |   5.88   |   1.02    |   2.3    |   8.52   |   3.84   |   6.44   |   8.93   |   6.68   |   1        |   8.69   |   1.9     |   9.08   |   1        |   6.87   |   8.49   |   7.19   |   4.75   |   3.86   |   7.41   |   1.02    |
|   0.01   |   0.02  |   0.01   |   0      |   0      |   0.02   |   0.02   |   0.01   |   0.02   |   0.03   |   0.03   |   0.04    |   0.01   |   0.01   |   0      |   0.01   |   0.02   |   0.02   |   0.2      |   0.01   |   0.01    |   0.01   |   0.39     |   0.02   |   0.02   |   0.01   |   0      |   0      |   0.01   |   0.07    |
| nan      | nan     | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan       | nan      | nan      | nan      | nan      | nan      | nan      | nan        | nan      | nan       | nan      | nan        | nan      | nan      | nan      | nan      | nan      | nan      | nan       |
| nan      | nan     | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan       | nan      | nan      | nan      | nan      | nan      | nan      | nan        | nan      | nan       | nan      | nan        | nan      | nan      | nan      | nan      | nan      | nan      | nan       |
| nan      | nan     | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan       | nan      | nan      | nan      | nan      | nan      | nan      | nan        | nan      | nan       | nan      | nan        | nan      | nan      | nan      | nan      | nan      | nan      | nan       |

STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/STL10_ImageNette_CL/models

 ********** Hebbian Unsupervised learning of blocks [3] **********
SEED:  0
BEFORE RESIZING
Files already downloaded and verified
AFTER RESIZING
Files already downloaded and verified
INDICES:  5000
IMAGE SIZE: torch.Size([32, 3, 96, 96])
SAVING FOLDER FOR UNSUP:  STL10_ImageNette_CL
INSIDE EVALUATE UNSUP
INSIDE EVALUATE UNSUP RETURNED 0,0
Epoch: [1/1]	lr: 1.99e-02	time: 00:02:06	Acc_train 0.00	Acc_test 0.00	convergence: 1.08e+01	R1: 47	Info MB:0.000e+00/SB:0.000e+00/MW:4.470e-03/SW:1.060e-01/MR:1.185e+01/SR:3.910e+00/MeD:2.958e+00/MaD:1.085e+01/MW:0.535/MAW:0.465
|        0 |        1 |        2 |       3 |        4 |        5 |        6 |         7 |        8 |        9 |       10 |       11 |       12 |      13 |      14 |       15 |      16 |       17 |       18 |       19 |       20 |       21 |       22 |       23 |       24 |       25 |       26 |       27 |       28 |       29 |
|----------+----------+----------+---------+----------+----------+----------+-----------+----------+----------+----------+----------+----------+---------+---------+----------+---------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------|
|   0.0401 |   0.0377 |   0.0343 |   0.033 |   0.0358 |   0.0352 |   0.0384 |   0.00922 |   0.0419 |   0.0352 |   0.0347 |   0.0406 |   0.0382 |   0.032 |   0.036 |   0.0364 |   0.027 |   0.0399 |   0.0291 |   0.0111 |   0.0334 |   0.0332 |   0.0363 |   0.0215 |   0.0335 |   0.0318 |   0.0172 |   0.0374 |   0.0381 |   0.0326 |
|  17.07   |  15.22   |  12.73   |  11.92  |  13.84   |  13.4    |  15.74   |   1.85    |  18.56   |  13.36   |  13.01   |  17.49   |  15.61   |  11.27  |  13.95  |  14.22   |   8.28  |  16.91   |   9.46   |   2.22   |  12.13   |  12.03   |  14.16   |   5.62   |  12.2    |  11.13   |   3.96   |  15.02   |  15.5    |  11.62   |
|   0.01   |   0.01   |   0.01   |   0.01  |   0.01   |   0.01   |   0.01   |   0.01    |   0.01   |   0.01   |   0.01   |   0.01   |   0.01   |   0.01  |   0.01  |   0.01   |   0     |   0.01   |   0.01   |   0.02   |   0      |   0      |   0.02   |   0.01   |   0.01   |   0      |   0.01   |   0.01   |   0.01   |   0.01   |
| nan      | nan      | nan      | nan     | nan      | nan      | nan      | nan       | nan      | nan      | nan      | nan      | nan      | nan     | nan     | nan      | nan     | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      |
| nan      | nan      | nan      | nan     | nan      | nan      | nan      | nan       | nan      | nan      | nan      | nan      | nan      | nan     | nan     | nan      | nan     | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      |
| nan      | nan      | nan      | nan     | nan      | nan      | nan      | nan       | nan      | nan      | nan      | nan      | nan      | nan     | nan     | nan      | nan     | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      | nan      |

STORING PATH IS NONEEEEEE
SAVING THE MODEL
/g100_work/EIRI_E_POLIMI/rcasciot/neuromodAI/SoftHebb-main/Training/results/hebb/result/network/STL10_ImageNette_CL/models
SEED:  0
BEFORE RESIZING
Files already downloaded and verified
AFTER RESIZING
Files already downloaded and verified
INDICES:  5000
IMAGE SIZE: torch.Size([64, 3, 96, 96])
Accuracy of the network on the 1st dataset: 11.762 %
Test loss on the 1st dataset: 32.502

